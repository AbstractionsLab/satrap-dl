<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.3"/>
    <title>satrap.etl.transform.stix_to_typedb_mapper API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../transform.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;satrap.etl.transform</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#STIXtoTypeDBMapper">STIXtoTypeDBMapper</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#STIXtoTypeDBMapper.classes">classes</a>
                        </li>
                        <li>
                                <a class="variable" href="#STIXtoTypeDBMapper.stix_objects">stix_objects</a>
                        </li>
                        <li>
                                <a class="variable" href="#STIXtoTypeDBMapper.composites_mapping">composites_mapping</a>
                        </li>
                        <li>
                                <a class="variable" href="#STIXtoTypeDBMapper.common_attributes">common_attributes</a>
                        </li>
                        <li>
                                <a class="variable" href="#STIXtoTypeDBMapper.sros_role_info">sros_role_info</a>
                        </li>
                        <li>
                                <a class="variable" href="#STIXtoTypeDBMapper.key_value_pairs">key_value_pairs</a>
                        </li>
                        <li>
                                <a class="variable" href="#STIXtoTypeDBMapper.dictionary_data">dictionary_data</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.split_type">split_type</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.join_type">join_type</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.validate">validate</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_data">get_data</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_class">get_class</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_typeql_thing_name">get_typeql_thing_name</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_typedb_supertype">get_typedb_supertype</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_default_value_implementation">get_default_value_implementation</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO">get_roleplayers_for_SRO</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_object_attribute_info">get_object_attribute_info</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_composite_name">get_composite_name</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_composite_attribute_info">get_composite_attribute_info</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_composite_type_relation">get_composite_type_relation</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_composite_relation_roles">get_composite_relation_roles</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_sro_role">get_sro_role</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_embedded_relation_roles">get_embedded_relation_roles</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation">get_key_value_pair_key_translation</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_key_value_pair_custom">get_key_value_pair_custom</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_pairs_value_and_type">get_pairs_value_and_type</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_pair_relation">get_pair_relation</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_dictionary_item_data">get_dictionary_item_data</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_dictionary_relation_data">get_dictionary_relation_data</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_dictionary_property_attribute">get_dictionary_property_attribute</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.get_extension_attribute_info">get_extension_attribute_info</a>
                        </li>
                        <li>
                                <a class="function" href="#STIXtoTypeDBMapper.is_defined_extension">is_defined_extension</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../../satrap.html">satrap</a><wbr>.<a href="./../../etl.html">etl</a><wbr>.<a href="./../transform.html">transform</a><wbr>.stix_to_typedb_mapper    </h1>

                
                        <input id="mod-stix_to_typedb_mapper-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-stix_to_typedb_mapper-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">jsonschema</span><span class="w"> </span><span class="kn">import</span> <span class="n">validate</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">satrap.commons</span><span class="w"> </span><span class="kn">import</span> <span class="n">file_utils</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">satrap.etl.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">MappingException</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">satrap.etl.stix_constants</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">satrap.etl.transform.stix_typeql_constants</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">constants</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">satrap.datamanagement.typedb</span><span class="w"> </span><span class="kn">import</span> <span class="n">typedb_constants</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="k">class</span><span class="w"> </span><span class="nc">STIXtoTypeDBMapper</span><span class="p">:</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Handles the mapping file that describes how to translate </span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="sd">    STIX 2.1 to the TypeDB schema.</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>    <span class="n">classes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>    <span class="n">stix_objects</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>    <span class="n">composites_mapping</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>    <span class="n">common_attributes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>    <span class="n">sros_role_info</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>    <span class="n">key_value_pairs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>    <span class="n">dictionary_data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">split_type</span><span class="p">(</span><span class="n">value_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Splits a compound value type to its ingredients according </span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">        to the mapping.</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">        If it is indeed a NonPrimitive Type, then the first value is </span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">        the abstract and the second the subtype. Otherwise, the first</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">        value is the value type and the second is empty.</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">        :param value_type: The type of a value</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">        :type value_type: str</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">        :return: The abstract and subtype of the type</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>        <span class="n">splitted</span> <span class="o">=</span> <span class="n">value_type</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_TYPE_SEPARATOR</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>        <span class="n">abstract</span> <span class="o">=</span> <span class="n">splitted</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">splitted</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>            <span class="n">subtype</span> <span class="o">=</span> <span class="n">splitted</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>            <span class="n">subtype</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>        <span class="k">return</span> <span class="n">abstract</span><span class="p">,</span> <span class="n">subtype</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">join_type</span><span class="p">(</span><span class="n">tl_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subtype</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Join an abstract and specific type together according </span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">        to the mapping.</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">        :param tl_type: The top-level-/ abstract  type</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">        :type tl_type: str</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">        :param subtype: The sub-/ specific type</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">        :type subtype: str</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">        :return: The two types joined together</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">        :rtype: str</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>        <span class="k">return</span> <span class="n">tl_type</span> <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_TYPE_SEPARATOR</span> <span class="o">+</span> <span class="n">subtype</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">():</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validates STIX to TypeDB JSON mappings against predefined schema files.</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">        This function reads various schema files in JSON format and validates</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">        the corresponding mappings in the STIXtoTypeDBMapper class against these</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">        schemas. The schemas include classes, STIX objects, composites, SRO roles,</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">        key-value pairs, a dictionary type, and common attributes.</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">        :raises ValidationError: If a mapping file does not match the schema</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">        :raises SchemaError: If a JSON schema file is invalid</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>        <span class="n">schema_classes</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_CLASSES</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>        <span class="p">)</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>        <span class="n">schema_stix_objects</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_STIX_OBJECTS</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>        <span class="p">)</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>        <span class="n">schema_composites</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_COMPOSITES</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>        <span class="p">)</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>        <span class="n">schema_sro_roles</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_SRO_ROLES</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>        <span class="p">)</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>        <span class="n">schema_key_value_pairs</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_KV_PAIRS</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>        <span class="p">)</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>        <span class="n">schema_dictionary</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_DICT</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>        <span class="p">)</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>        <span class="n">schema_common_attributes</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_COMMON_ATTRIBUTES</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>        <span class="p">)</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">classes</span><span class="p">,</span> <span class="n">schema_classes</span><span class="p">)</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="p">,</span> <span class="n">schema_stix_objects</span><span class="p">)</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span><span class="p">,</span> <span class="n">schema_composites</span><span class="p">)</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">common_attributes</span><span class="p">,</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>                 <span class="n">schema_common_attributes</span><span class="p">)</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">sros_role_info</span><span class="p">,</span> <span class="n">schema_sro_roles</span><span class="p">)</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span><span class="p">,</span> <span class="n">schema_key_value_pairs</span><span class="p">)</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">dictionary_data</span><span class="p">,</span> <span class="n">schema_dictionary</span><span class="p">)</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_data</span><span class="p">(</span><span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads the data of the JSON map.</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">        Note that though every function calls this function here, </span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="sd">        the data is loaded only once. Therefore, the first call to </span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">        this method decides which mappings to load.</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">        :param validate: Whether the data should be validated, too</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">        :type validate: bool, optional</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">        :raises SchemaError: If the schema is invalid </span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">            and validate = True</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="sd">        :raises ValidationError: If the mapping is invalid</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="sd">            and validate = True</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_COMPOSITES</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>            <span class="p">)</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SDO</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>            <span class="p">)</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>                <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">FILE_SRO</span><span class="p">)</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>            <span class="p">)</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>                <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCO</span><span class="p">)</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>            <span class="p">)</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>                <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">FILE_SMO</span><span class="p">)</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>            <span class="p">)</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">classes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_CLASSES</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>            <span class="p">)</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">common_attributes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">common_attributes</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_COMMON_ATTRIBUTES</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>            <span class="p">)</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">sros_role_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">sros_role_info</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SRO_ROLES_INFO</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>            <span class="p">)</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_KEY_VALUE_PAIRS</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>            <span class="p">)</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">dictionary_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">dictionary_data</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_DICTIONARY_DATA</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>            <span class="p">)</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>        <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_class</span><span class="p">(</span><span class="n">stix_object_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the class used to build this STIX type.</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">        :param stix_object_type: The type of the STIX object, </span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="sd">            e.g. attack-pattern</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a><span class="sd">        :type stix_object_type: str</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a><span class="sd">        :return: The class used for the building, None if the type </span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a><span class="sd">            is a custom type</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a><span class="sd">        :rtype: str</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>        <span class="n">class_type</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>        <span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">stix_object_types</span> <span class="ow">in</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>            <span class="k">if</span> <span class="n">stix_object_type</span> <span class="ow">in</span> <span class="n">stix_object_types</span><span class="p">:</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>                <span class="n">class_type</span> <span class="o">=</span> <span class="n">category</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>                <span class="k">break</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>        <span class="k">return</span> <span class="n">class_type</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_typeql_thing_name</span><span class="p">(</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>        <span class="n">stix_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>        <span class="n">stix_properties</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>        <span class="n">stix_extensions</span><span class="p">:</span> <span class="nb">dict</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of the TypeQL thing for a certain </span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a><span class="sd">        STIX Object. E.g. &quot;attack-pattern&quot; -&gt; &quot;attack-pattern&quot;.</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a><span class="sd">        :param stix_type: The type of the STIX object</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a><span class="sd">        :type stix_type: str</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a><span class="sd">        :param stix_properties: The properties of the STIX Object</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a><span class="sd">        :type stix_properties: dict </span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a><span class="sd">        :param stix_extensions: The extensions of the STIX Object</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a><span class="sd">        :type stix_extensions: dict </span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a><span class="sd">        :raises MappingException: If the Type cannot be determined</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a><span class="sd">        :return: The name of the object in TypeDB, None if the type </span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a><span class="sd">            is a custom type</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a><span class="sd">        :rtype: str</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>        <span class="n">object_info</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span> \
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_type</span><span class="p">)</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>        <span class="c1"># Custom type</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">object_info</span><span class="p">:</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>        <span class="n">assigned_type</span> <span class="o">=</span> <span class="n">object_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_TYPEDB_TYPE</span><span class="p">)</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>        <span class="n">subtypes</span> <span class="o">=</span> <span class="n">object_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_SUBTYPES</span><span class="p">)</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>        <span class="n">typedb_type</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">assigned_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No TypeDB type specified for </span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>        <span class="n">typedb_type</span> <span class="o">=</span> <span class="n">assigned_type</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>        <span class="k">if</span> <span class="n">subtypes</span><span class="p">:</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>            <span class="n">attribute</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">subtypes</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>            <span class="n">value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">stix_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>                <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>                    <span class="sa">f</span><span class="s2">&quot;The property &#39;</span><span class="si">{</span><span class="n">attribute</span><span class="si">}</span><span class="s2">&#39; is required for STIX objects of type &#39;</span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>            <span class="n">typedb_type</span> <span class="o">=</span> <span class="n">subtypes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>            <span class="k">if</span> <span class="n">typedb_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>                <span class="n">typedb_type</span> <span class="o">=</span> <span class="n">subtypes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span> \
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>                    <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DEFAULT_KEY</span><span class="p">)</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">typedb_type</span><span class="p">:</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>                <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>                    <span class="c1"># f&quot;{stix_properties.get(&#39;id&#39;)}: subtyping for &#39;{stix_type}&#39; is not exhaustive&quot;)</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>                    <span class="sa">f</span><span class="s2">&quot;In &#39;</span><span class="si">{</span><span class="n">stix_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;: the value &#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39; &quot;</span>\
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>                    <span class="sa">f</span><span class="s2">&quot;is not defined for &#39;</span><span class="si">{</span><span class="n">attribute</span><span class="si">}</span><span class="s2">&#39; in the mapping of &#39;</span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>        <span class="c1"># update the type if the given object has a predefined extension</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>        <span class="k">if</span> <span class="n">stix_extensions</span><span class="p">:</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>            <span class="n">obj_extensions</span> <span class="o">=</span> <span class="n">stix_extensions</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>            <span class="n">predefined_extensions</span> <span class="o">=</span> <span class="n">object_info</span> \
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>                <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_EXTENSIONS</span><span class="p">)</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">predefined_extensions</span><span class="p">:</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>                <span class="k">return</span> <span class="n">typedb_type</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>            <span class="n">predefined_extensions</span> <span class="o">=</span> <span class="n">predefined_extensions</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>            <span class="n">final_extension</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>            <span class="k">for</span> <span class="n">extension</span> <span class="ow">in</span> <span class="n">obj_extensions</span><span class="p">:</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>                <span class="k">if</span> <span class="n">extension</span> <span class="ow">in</span> <span class="n">predefined_extensions</span><span class="p">:</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>                    <span class="k">if</span> <span class="n">final_extension</span><span class="p">:</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>                        <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>                            <span class="sa">f</span><span class="s2">&quot;Two predefined extensions given for &#39;</span><span class="si">{</span><span class="n">stix_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>                            <span class="sa">f</span><span class="s2">&quot;The extensions are mutually exclusive, a &#39;</span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&#39; must have &quot;</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>                            <span class="s2">&quot;at most one extension.&quot;</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>                        <span class="p">)</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>                    <span class="n">final_extension</span> <span class="o">=</span> <span class="n">extension</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>            <span class="k">if</span> <span class="n">final_extension</span><span class="p">:</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>                <span class="n">typedb_type</span> <span class="o">=</span> <span class="n">object_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_EXTENSIONS</span><span class="p">)</span> \
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>                    <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">final_extension</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_TYPEDB_TYPE</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>        <span class="k">return</span> <span class="n">typedb_type</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_typedb_supertype</span><span class="p">(</span><span class="n">stix_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the least abstract supertype in TypeDB for a STIX </span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a><span class="sd">        object type.</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="sd">        :param stix_type: The STIX Object type, e.g. attack-pattern</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a><span class="sd">        :type stix_type: str</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a><span class="sd">        :raises MappingException: If the stix type is not defined or the</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a><span class="sd">            mapping is invalid</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a><span class="sd">        :return: The least abstract supertype in TypeDB for a STIX Object </span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="sd">            type</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a><span class="sd">        :rtype: str</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>        <span class="n">object_map</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_type</span><span class="p">)</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">object_map</span><span class="p">:</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;STIX type &#39;</span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&#39; not defined&quot;</span><span class="p">)</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>        <span class="n">sup_type</span> <span class="o">=</span> <span class="n">object_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_TYPEDB_TYPE</span><span class="p">)</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">sup_type</span><span class="p">:</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>                <span class="sa">f</span><span class="s2">&quot;No TypeDB type defined for &#39;</span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>        <span class="k">return</span> <span class="n">sup_type</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_default_value_implementation</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the default value type for a value of unknown type.</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a><span class="sd">        :param value: The value whose type is unknown</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="sd">        :type value: Any</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a><span class="sd">        :return: The name of the value type, None if no value type</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="sd">            is defined</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="sd">        :rtype: str</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>        <span class="k">match</span> <span class="n">value</span><span class="p">:</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>            <span class="k">case</span> <span class="nb">int</span><span class="p">():</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">typedb_constants</span><span class="o">.</span><span class="n">LONG</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">satrap</span><span class="o">.</span><span class="n">etl</span><span class="o">.</span><span class="n">stix_constants</span><span class="o">.</span><span class="n">STIX_TIMESTAMP_REGEX</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>                    <span class="n">res</span> <span class="o">=</span> <span class="n">typedb_constants</span><span class="o">.</span><span class="n">DATETIME</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>                    <span class="n">res</span> <span class="o">=</span> <span class="n">typedb_constants</span><span class="o">.</span><span class="n">STRING</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>            <span class="k">case</span> <span class="nb">float</span><span class="p">():</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">typedb_constants</span><span class="o">.</span><span class="n">DOUBLE</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>            <span class="k">case</span> <span class="nb">bool</span><span class="p">():</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">typedb_constants</span><span class="o">.</span><span class="n">BOOLEAN</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>            <span class="k">case</span> <span class="nb">list</span><span class="p">():</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>                <span class="n">list_type</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">TYPEQL_LIST_PREFIX</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>                    <span class="n">subtype</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span> \
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>                        <span class="o">.</span><span class="n">get_default_value_implementation</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>                    <span class="n">subtype</span> <span class="o">=</span> <span class="n">typedb_constants</span><span class="o">.</span><span class="n">STRING</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">join_type</span><span class="p">(</span><span class="n">list_type</span><span class="p">,</span> <span class="n">subtype</span><span class="p">)</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>            <span class="k">case</span> <span class="nb">dict</span><span class="p">():</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>                <span class="c1"># maybe check for predefined composite types</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">TYPEQL_DICTIONARY_KEYWORD</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>                <span class="kc">None</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_roleplayers_for_SRO</span><span class="p">(</span><span class="n">stix_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Gives the properties that are implemented as roleplayers in</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a><span class="sd">        a STIX relationship object.</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a><span class="sd">        :param stix_type: The type of the STIX object</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a><span class="sd">        :type stix_type: str</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a><span class="sd">        :raises MappingException: If the STIX type does not exist</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a><span class="sd">        :return: The properties that specify roleplayers</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a><span class="sd">        :rtype: str</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>        <span class="n">object_info</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_type</span><span class="p">)</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">object_info</span><span class="p">:</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>                <span class="sa">f</span><span class="s2">&quot;STIX Object </span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2"> not defined&quot;</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>            <span class="p">)</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>        <span class="n">attributes</span> <span class="o">=</span> <span class="n">object_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTES</span><span class="p">)</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attributes</span><span class="p">:</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>                <span class="sa">f</span><span class="s2">&quot;No attributes defined for STIX Object </span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>            <span class="p">)</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>        <span class="n">roleplayers</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>        <span class="k">for</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">attribute_info</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>            <span class="n">value_type</span> <span class="o">=</span> <span class="n">attribute_info</span> \
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>                <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_VALUE_TYPE</span><span class="p">)</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>            <span class="k">if</span> <span class="n">value_type</span> <span class="o">==</span> <span class="n">constants</span><span class="o">.</span><span class="n">TYPEQL_ROLEPLAYER</span><span class="p">:</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>                <span class="n">roleplayers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>        <span class="k">return</span> <span class="n">roleplayers</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_object_attribute_info</span><span class="p">(</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>        <span class="n">stix_object</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>        <span class="n">stix_attribute</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name and value of an attribute in the </span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a><span class="sd">        TypeDB Schema.</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a><span class="sd">        :param stix_object: The type of the STIX object, </span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a><span class="sd">            e.g. attack-pattern</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a><span class="sd">        :type stix_object: str</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a><span class="sd">        :param stix_attribute: The attribute of the STIX Object</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a><span class="sd">        :type stix_attribute: str</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="sd">        :raises MappingException: If the stix type is not defined</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a><span class="sd">            or the mapping is not valid/ complete</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a><span class="sd">        :return: The TypeDB name and value, None if the attribute</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a><span class="sd">            is a custom attribute</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>        <span class="n">common_attributes</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">common_attributes</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>        <span class="k">if</span> <span class="n">stix_attribute</span> <span class="ow">in</span> <span class="n">common_attributes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>            <span class="n">attr_info</span> <span class="o">=</span> <span class="n">common_attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_attribute</span><span class="p">)</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">attr_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_NAME</span><span class="p">)</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>            <span class="n">value</span> <span class="o">=</span> <span class="n">attr_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_VALUE_TYPE</span><span class="p">)</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>                <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>                    <span class="sa">f</span><span class="s2">&quot;No name or no value given for &#39;</span><span class="si">{</span><span class="n">stix_attribute</span><span class="si">}</span><span class="s2">&#39; in common attributes&quot;</span><span class="p">)</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>            <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>        <span class="n">stix_obj</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_object</span><span class="p">)</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">stix_object</span><span class="p">:</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>                <span class="s2">&quot;The specified STIX Object does not exist&quot;</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>            <span class="p">)</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>        <span class="n">specific_attributes</span> <span class="o">=</span> <span class="n">stix_obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTES</span><span class="p">)</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">specific_attributes</span><span class="p">:</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>                <span class="s2">&quot;No attributes are defined for </span><span class="si">{stix_object}</span><span class="s2">&quot;</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>            <span class="p">)</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>        <span class="n">attr_info</span> <span class="o">=</span> <span class="n">specific_attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_attribute</span><span class="p">)</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attr_info</span><span class="p">:</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>            <span class="c1"># Custom property</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">attr_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_NAME</span><span class="p">)</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">attr_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_VALUE_TYPE</span><span class="p">)</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>                <span class="sa">f</span><span class="s2">&quot;No name or no value given for attribute </span><span class="si">{</span><span class="n">stix_attribute</span><span class="si">}</span><span class="s2"> of stix type </span><span class="si">{</span><span class="n">stix_object</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>            <span class="p">)</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>        <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_composite_name</span><span class="p">(</span><span class="n">composite_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the TypeDB name used for the composite type.</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a><span class="sd">        :param composite_type: The STIX name of the composite type</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a><span class="sd">        :type composite_type: str</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a><span class="sd">        :raises MappingException: If the composite type does not exist,</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a><span class="sd">            i.e. the mapping is invalid or incomplete</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a><span class="sd">        :return: The TypeDB name used for the composite type</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a><span class="sd">        :rtype: str</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>        <span class="n">composite</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span> \
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">composite_type</span><span class="p">)</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">composite</span><span class="p">:</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>                <span class="sa">f</span><span class="s2">&quot;Composite type </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>            <span class="p">)</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">composite</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_COMPOSITE_NAME</span><span class="p">)</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>                <span class="sa">f</span><span class="s2">&quot;No TypeDB name specified for composite </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>            <span class="p">)</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>        <span class="k">return</span> <span class="n">name</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_composite_attribute_info</span><span class="p">(</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>        <span class="n">composite_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>        <span class="n">stix_property</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the TypeDB name of a specified attribute of a </span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a><span class="sd">        specified composite type.</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a><span class="sd">        :param composite_type: The name of the composite type</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a><span class="sd">        :type composite_type: str</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a><span class="sd">        :param stix_property: The name of the STIX attribute</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a><span class="sd">        :type stix_property: str</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a><span class="sd">        :raises MappingException: If the composite type or attribute</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a><span class="sd">            is not defined in the mapping</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a><span class="sd">        :return: The TypeDB name and value type for the attribute</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>        <span class="n">composite</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span> \
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">composite_type</span><span class="p">)</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">composite</span><span class="p">:</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>                <span class="sa">f</span><span class="s2">&quot;Composite type </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>            <span class="p">)</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>        <span class="n">typedb_attribute</span> <span class="o">=</span> <span class="n">composite</span> \
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTES</span><span class="p">)</span> \
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_property</span><span class="p">)</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">typedb_attribute</span><span class="p">:</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>                <span class="sa">f</span><span class="s2">&quot;Attribute </span><span class="si">{</span><span class="n">stix_property</span><span class="si">}</span><span class="s2"> does not exist for composite type </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>            <span class="p">)</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>        <span class="n">attribute_name</span> <span class="o">=</span> <span class="n">typedb_attribute</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_NAME</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>        <span class="p">)</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>        <span class="n">attribute_type</span> <span class="o">=</span> <span class="n">typedb_attribute</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_VALUE_TYPE</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>        <span class="p">)</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attribute_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">attribute_type</span><span class="p">:</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>                <span class="sa">f</span><span class="s2">&quot;Attribute name or value type for attribute </span><span class="si">{</span><span class="n">stix_property</span><span class="si">}</span><span class="s2"> of composite &quot;</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2"> not specified&quot;</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>            <span class="p">)</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>        <span class="k">return</span> <span class="n">attribute_name</span><span class="p">,</span> <span class="n">attribute_type</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_composite_type_relation</span><span class="p">(</span><span class="n">composite_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of the helper relation for the composite </span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a><span class="sd">        type.</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a><span class="sd">        :param composite_type: The name of the composite type</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a><span class="sd">        :type composite_type: str</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a><span class="sd">        :raises MappingException: If the composite type does not exist</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a><span class="sd">            or no relation is specified</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a><span class="sd">        :return: The name of the helper relation of the composite type</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a><span class="sd">        :rtype: str</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>        <span class="n">composite</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span> \
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">composite_type</span><span class="p">)</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">composite</span><span class="p">:</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>                <span class="sa">f</span><span class="s2">&quot;Composite type </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>            <span class="p">)</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>        <span class="n">relation</span> <span class="o">=</span> <span class="n">composite</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_COMPOSITE_RELATION</span><span class="p">)</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation</span><span class="p">:</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>                <span class="sa">f</span><span class="s2">&quot;No relation specified for composite </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>            <span class="p">)</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>        <span class="n">relation_name</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">RELATION_NAME</span><span class="p">)</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation_name</span><span class="p">:</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>                <span class="sa">f</span><span class="s2">&quot;No relation name specified for composite </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>            <span class="p">)</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>        <span class="k">return</span> <span class="n">relation_name</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_composite_relation_roles</span><span class="p">(</span><span class="n">composite_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the names of the roles of the helper relation of a </span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a><span class="sd">        composite type, i.e. the name of the object&#39;s role and the name</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a><span class="sd">        of the values&#39; role.</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a><span class="sd">        :param composite_type: The name of the composite value type </span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a><span class="sd">        :type composite_type: str</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a><span class="sd">        :raises MappingException: If the composite type does not exist</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a><span class="sd">            or its definition is incomplete</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a><span class="sd">        :return: The name of the object&#39;s and values&#39; role</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>        <span class="n">composite</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span> \
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">composite_type</span><span class="p">)</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">composite</span><span class="p">:</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>                <span class="sa">f</span><span class="s2">&quot;Composite type </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>            <span class="p">)</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>        <span class="n">relation</span> <span class="o">=</span> <span class="n">composite</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_COMPOSITE_RELATION</span><span class="p">)</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation</span><span class="p">:</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>                <span class="sa">f</span><span class="s2">&quot;No relation specified for composite </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>            <span class="p">)</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>        <span class="n">object_role</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_COMPOSITE_RELATION_OBJECT_ROLE</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>        <span class="p">)</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>        <span class="n">value_role</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_COMPOSITE_RELATION_VALUE_ROLE</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>        <span class="p">)</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">object_role</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">value_role</span><span class="p">:</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>                <span class="sa">f</span><span class="s2">&quot;No object or value role defined for helper relation of &quot;</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>                <span class="sa">f</span><span class="s2">&quot;composite type </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>            <span class="p">)</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>        <span class="k">return</span> <span class="n">object_role</span><span class="p">,</span> <span class="n">value_role</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sro_role</span><span class="p">(</span><span class="n">relation_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">attribute</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of the role for an SRO attribute.</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a><span class="sd">        :param relation_name: The name of the SRO</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a><span class="sd">        :type relation_name: str</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a><span class="sd">        :param role: The name of the attribute </span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a><span class="sd">        :type role: str</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a><span class="sd">        :raises MappingException: If the relation is not defined or the </span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a><span class="sd">            attribute is not implemented as a roleplayer</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a><span class="sd">        :return: The name of the role and TypeDB object type that </span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a><span class="sd">            plays the role</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a><span class="sd">        :rtype: str</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>        <span class="n">relation</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">sros_role_info</span> \
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">relation_name</span><span class="p">)</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation</span><span class="p">:</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a>                <span class="sa">f</span><span class="s2">&quot;Relation </span><span class="si">{</span><span class="n">relation_name</span><span class="si">}</span><span class="s2"> is not defined&quot;</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a>            <span class="p">)</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a>        <span class="n">role_name</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">role_name</span><span class="p">:</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>                <span class="sa">f</span><span class="s2">&quot;Role information for role </span><span class="si">{</span><span class="n">attribute</span><span class="si">}</span><span class="s2"> missing for relation </span><span class="si">{</span><span class="n">relation_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a>            <span class="p">)</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a>        <span class="k">return</span> <span class="n">role_name</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_embedded_relation_roles</span><span class="p">(</span><span class="n">attribute_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the object&#39;s and value&#39;s role using the name of the</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a><span class="sd">        attribute specified for the TypeDB translation of a STIX </span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a><span class="sd">        property.</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a><span class="sd">        :param attribute_name: The specified attribute name for the</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a><span class="sd">            TypeDB translation</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a><span class="sd">        :type attribute_name: str</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a><span class="sd">        :raises MappingException: If the attribute name does not </span>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a><span class="sd">            fulfill the required format</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a><span class="sd">        :return: The name of the object&#39;s and value&#39;s role</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a>        <span class="n">roles</span> <span class="o">=</span> <span class="n">attribute_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ROLE_SEPARATION</span><span class="p">)</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">roles</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a>                <span class="sa">f</span><span class="s2">&quot;Roles are not properly specified: </span><span class="si">{</span><span class="n">attribute_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a>            <span class="p">)</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a>        <span class="k">return</span> <span class="n">roles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">roles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_key_value_pair_key_translation</span><span class="p">(</span><span class="n">pair_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the entity type of the key. Returns None if the key</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a><span class="sd">        is not defined.</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a>
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a><span class="sd">        :param pair_type: The name of the Pair Type</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a><span class="sd">        :type pair_type: str</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a><span class="sd">        :param key: The name of the key</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a><span class="sd">        :type key: str</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a><span class="sd">        :raises MappingException: If the Mapping is invalid or </span>
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a><span class="sd">            incomplete or the pair type does not exist</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a><span class="sd">        :return: The name of the TypeDB Entity</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a><span class="sd">        :rtype: str</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a>        <span class="n">pair_type</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span> \
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pair_type</span><span class="p">)</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">pair_type</span><span class="p">:</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a>                <span class="sa">f</span><span class="s2">&quot;Pair type </span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a>            <span class="p">)</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a>        <span class="n">keys</span> <span class="o">=</span> <span class="n">pair_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIRS_KEYS</span><span class="p">)</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">keys</span><span class="p">:</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a>                <span class="sa">f</span><span class="s2">&quot;No keys defined for pair type </span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a>            <span class="p">)</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a>        <span class="n">key</span> <span class="o">=</span> <span class="n">keys</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a>
</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a>        <span class="k">return</span> <span class="n">key</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a>
</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_key_value_pair_custom</span><span class="p">(</span><span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of the custom entity and the attribute </span>
</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a><span class="sd">        name for the key.</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a>
</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a><span class="sd">        :param pair_type: The name of the pair type</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a><span class="sd">        :type pair_type: str</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a>
</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a><span class="sd">        :raises MappingException: If the Mapping is invalid or incomplete</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a><span class="sd">            or the pair type does not exist</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a>
</span><span id="L-667"><a href="#L-667"><span class="linenos">667</span></a><span class="sd">        :return: The name of the entity and key attribute</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos">668</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos">669</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos">670</span></a>        <span class="n">pair_type</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span> \
</span><span id="L-671"><a href="#L-671"><span class="linenos">671</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos">672</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">pair_type</span><span class="p">:</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos">673</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos">674</span></a>                <span class="sa">f</span><span class="s2">&quot;A mapping for the key-value type &#39;</span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2">&#39; is not defined&quot;</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos">675</span></a>            <span class="p">)</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos">676</span></a>
</span><span id="L-677"><a href="#L-677"><span class="linenos">677</span></a>        <span class="n">mapping</span> <span class="o">=</span> <span class="n">pair_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIR_CUSTOM</span><span class="p">)</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos">678</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">mapping</span><span class="p">:</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos">679</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos">680</span></a>                <span class="sa">f</span><span class="s2">&quot;Custom keys are not supported in the STIX key-value type &#39;</span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos">681</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Valid keys: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">pair_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIRS_KEYS</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos">682</span></a>            <span class="p">)</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos">683</span></a>
</span><span id="L-684"><a href="#L-684"><span class="linenos">684</span></a>        <span class="n">entity</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIR_CUSTOM_ENTITY</span><span class="p">)</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos">685</span></a>        <span class="n">attribute</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIR_CUSTOM_ATTRIBUTE</span><span class="p">)</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos">686</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">entity</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">attribute</span><span class="p">:</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos">687</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos">688</span></a>                <span class="sa">f</span><span class="s2">&quot;No entity type or attribute name specified for custom keys &quot;</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos">689</span></a>                <span class="sa">f</span><span class="s2">&quot;in key-value type &#39;</span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos">690</span></a>
</span><span id="L-691"><a href="#L-691"><span class="linenos">691</span></a>        <span class="k">return</span> <span class="n">entity</span><span class="p">,</span> <span class="n">attribute</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos">692</span></a>
</span><span id="L-693"><a href="#L-693"><span class="linenos">693</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos">694</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_pairs_value_and_type</span><span class="p">(</span><span class="n">pair_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos">695</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the attribute name and value type of the pair type.</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos">696</span></a>
</span><span id="L-697"><a href="#L-697"><span class="linenos">697</span></a><span class="sd">        :param pair_type: The name of the pair type</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos">698</span></a><span class="sd">        :type pair_type: str</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos">699</span></a>
</span><span id="L-700"><a href="#L-700"><span class="linenos">700</span></a><span class="sd">        :raises MappingException: If the Mapping is invalid or incomplete</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos">701</span></a><span class="sd">            or the pair type does not exist</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos">702</span></a>
</span><span id="L-703"><a href="#L-703"><span class="linenos">703</span></a><span class="sd">        :return: The attribute name and value type for the values</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos">704</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos">705</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos">706</span></a>        <span class="n">pair_type</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span> \
</span><span id="L-707"><a href="#L-707"><span class="linenos">707</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pair_type</span><span class="p">)</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos">708</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">pair_type</span><span class="p">:</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos">709</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos">710</span></a>                <span class="sa">f</span><span class="s2">&quot;Pair Type </span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos">711</span></a>            <span class="p">)</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos">712</span></a>
</span><span id="L-713"><a href="#L-713"><span class="linenos">713</span></a>        <span class="n">attribute_name</span> <span class="o">=</span> <span class="n">pair_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIRS_ATTRIBUTE_NAME</span><span class="p">)</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos">714</span></a>        <span class="n">value_type</span> <span class="o">=</span> <span class="n">pair_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIRS_VALUE_TYPE</span><span class="p">)</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos">715</span></a>
</span><span id="L-716"><a href="#L-716"><span class="linenos">716</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attribute_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">value_type</span><span class="p">:</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos">717</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos">718</span></a>                <span class="sa">f</span><span class="s2">&quot;Attribute name or value type not specified for pair type </span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos">719</span></a>            <span class="p">)</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos">720</span></a>
</span><span id="L-721"><a href="#L-721"><span class="linenos">721</span></a>        <span class="k">return</span> <span class="n">attribute_name</span><span class="p">,</span> <span class="n">value_type</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos">722</span></a>
</span><span id="L-723"><a href="#L-723"><span class="linenos">723</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos">724</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_pair_relation</span><span class="p">(</span><span class="n">pair_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos">725</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the relation name of the helper relation for the </span>
</span><span id="L-726"><a href="#L-726"><span class="linenos">726</span></a><span class="sd">        pair type and the roles for the object and pair item.</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos">727</span></a>
</span><span id="L-728"><a href="#L-728"><span class="linenos">728</span></a><span class="sd">        :param pair_type: The name of the pair type</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos">729</span></a><span class="sd">        :type pair_type: str</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos">730</span></a>
</span><span id="L-731"><a href="#L-731"><span class="linenos">731</span></a><span class="sd">        :raises MappingException: If the pair type does not exist or </span>
</span><span id="L-732"><a href="#L-732"><span class="linenos">732</span></a><span class="sd">            the mapping is invalid/ incomplete</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos">733</span></a>
</span><span id="L-734"><a href="#L-734"><span class="linenos">734</span></a><span class="sd">        :return: The name of the relation, object role and item role</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos">735</span></a><span class="sd">        :rtype: tuple[str, str, str]</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos">736</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos">737</span></a>        <span class="n">pair_type</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span> \
</span><span id="L-738"><a href="#L-738"><span class="linenos">738</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pair_type</span><span class="p">)</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos">739</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">pair_type</span><span class="p">:</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos">740</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos">741</span></a>                <span class="sa">f</span><span class="s2">&quot;Pair Type </span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos">742</span></a>            <span class="p">)</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos">743</span></a>
</span><span id="L-744"><a href="#L-744"><span class="linenos">744</span></a>        <span class="n">relation</span> <span class="o">=</span> <span class="n">pair_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIRS_RELATION</span><span class="p">)</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos">745</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation</span><span class="p">:</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos">746</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos">747</span></a>                <span class="sa">f</span><span class="s2">&quot;Relation is not specified for pair type </span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos">748</span></a>            <span class="p">)</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos">749</span></a>        <span class="n">relation_name</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">RELATION_NAME</span><span class="p">)</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos">750</span></a>        <span class="n">item_role</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ROLE_ITEM</span><span class="p">)</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos">751</span></a>        <span class="n">object_role</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ROLE_OBJECT</span><span class="p">)</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos">752</span></a>
</span><span id="L-753"><a href="#L-753"><span class="linenos">753</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">item_role</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">object_role</span><span class="p">:</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos">754</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span><span class="s2">&quot;Relation info is not fully specified&quot;</span><span class="p">)</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos">755</span></a>
</span><span id="L-756"><a href="#L-756"><span class="linenos">756</span></a>        <span class="k">return</span> <span class="n">relation_name</span><span class="p">,</span> <span class="n">object_role</span><span class="p">,</span> <span class="n">item_role</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos">757</span></a>
</span><span id="L-758"><a href="#L-758"><span class="linenos">758</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos">759</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_dictionary_item_data</span><span class="p">(</span><span class="n">value_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos">760</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of the item entity, the name of the key </span>
</span><span id="L-761"><a href="#L-761"><span class="linenos">761</span></a><span class="sd">        attribute name of the value attribute.</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos">762</span></a>
</span><span id="L-763"><a href="#L-763"><span class="linenos">763</span></a><span class="sd">        :param value_type: The type of the value of the item</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos">764</span></a><span class="sd">        :type value_type: str</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos">765</span></a>
</span><span id="L-766"><a href="#L-766"><span class="linenos">766</span></a><span class="sd">        :raises MappingException: If the mapping is invalid/incomplete</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos">767</span></a>
</span><span id="L-768"><a href="#L-768"><span class="linenos">768</span></a><span class="sd">        :return: The name of the item entity, key attribute and value </span>
</span><span id="L-769"><a href="#L-769"><span class="linenos">769</span></a><span class="sd">            attribute</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos">770</span></a><span class="sd">        :rtype: tuple[str, str, str]</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos">771</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos">772</span></a>        <span class="n">abstract</span><span class="p">,</span> <span class="n">specific</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">split_type</span><span class="p">(</span><span class="n">value_type</span><span class="p">)</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos">773</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">specific</span><span class="p">:</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos">774</span></a>            <span class="n">value_type</span> <span class="o">=</span> <span class="n">abstract</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos">775</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos">776</span></a>            <span class="n">value_type</span> <span class="o">=</span> <span class="n">specific</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos">777</span></a>
</span><span id="L-778"><a href="#L-778"><span class="linenos">778</span></a>        <span class="n">dict_data</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">dictionary_data</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos">779</span></a>        <span class="n">key_name</span> <span class="o">=</span> <span class="n">dict_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DICTIONARY_KEY</span><span class="p">)</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos">780</span></a>        <span class="n">items_data</span> <span class="o">=</span> <span class="n">dict_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DICTIONARY_SUBITEMS</span><span class="p">)</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos">781</span></a>
</span><span id="L-782"><a href="#L-782"><span class="linenos">782</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">key_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">items_data</span><span class="p">:</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos">783</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos">784</span></a>                <span class="s2">&quot;Dictionary data incomplete&quot;</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos">785</span></a>            <span class="p">)</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos">786</span></a>
</span><span id="L-787"><a href="#L-787"><span class="linenos">787</span></a>        <span class="n">item_data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">items_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">value_type</span><span class="p">)</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos">788</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">item_data</span><span class="p">:</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos">789</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos">790</span></a>                <span class="sa">f</span><span class="s2">&quot;Value type &#39;</span><span class="si">{</span><span class="n">value_type</span><span class="si">}</span><span class="s2">&#39; not supported in items of STIX properties &quot;</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos">791</span></a>                <span class="s2">&quot;of type &#39;dictionary&#39; (e.g. exif_tags, additional_header_fields). &quot;</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos">792</span></a>                <span class="sa">f</span><span class="s2">&quot;Valid types: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">items_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos">793</span></a>            <span class="p">)</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos">794</span></a>
</span><span id="L-795"><a href="#L-795"><span class="linenos">795</span></a>        <span class="n">item_name</span> <span class="o">=</span> <span class="n">item_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos">796</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DICTIONARY_ITEM_ENTITY</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos">797</span></a>        <span class="p">)</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos">798</span></a>        <span class="n">attr_name</span> <span class="o">=</span> <span class="n">item_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos">799</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DICTIONARY_VALUE_ATTRIBUTE</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos">800</span></a>        <span class="p">)</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos">801</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">item_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">attr_name</span><span class="p">:</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos">802</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos">803</span></a>                <span class="s2">&quot;No item entity name of value attribute given for dictionary&quot;</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos">804</span></a>            <span class="p">)</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos">805</span></a>        <span class="k">return</span> <span class="n">item_name</span><span class="p">,</span> <span class="n">key_name</span><span class="p">,</span> <span class="n">attr_name</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos">806</span></a>
</span><span id="L-807"><a href="#L-807"><span class="linenos">807</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos">808</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_dictionary_relation_data</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos">809</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of the relation and roles used for building </span>
</span><span id="L-810"><a href="#L-810"><span class="linenos">810</span></a><span class="sd">        the dictionary, i.e. connecting the object to the items.</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos">811</span></a>
</span><span id="L-812"><a href="#L-812"><span class="linenos">812</span></a><span class="sd">        :raises MappingException: If there is no relation specified</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos">813</span></a>
</span><span id="L-814"><a href="#L-814"><span class="linenos">814</span></a><span class="sd">        :return: The name of the relation, role of the item and role</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos">815</span></a><span class="sd">            of the object</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos">816</span></a><span class="sd">        :rtype: str</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos">817</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos">818</span></a>        <span class="n">dict_data</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">dictionary_data</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos">819</span></a>        <span class="n">relation</span> <span class="o">=</span> <span class="n">dict_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DICTIONARY_RELATION</span><span class="p">)</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos">820</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation</span><span class="p">:</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos">821</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos">822</span></a>                <span class="s2">&quot;No relation specified for dictionaries&quot;</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos">823</span></a>            <span class="p">)</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos">824</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">RELATION_NAME</span><span class="p">)</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos">825</span></a>        <span class="n">item_role</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ROLE_ITEM</span><span class="p">)</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos">826</span></a>        <span class="n">object_role</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ROLE_OBJECT</span><span class="p">)</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos">827</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">item_role</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">object_role</span><span class="p">:</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos">828</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos">829</span></a>                <span class="s2">&quot;Dictionary Data incomplete, relation name or roles missing&quot;</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos">830</span></a>            <span class="p">)</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos">831</span></a>        <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">item_role</span><span class="p">,</span> <span class="n">object_role</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos">832</span></a>
</span><span id="L-833"><a href="#L-833"><span class="linenos">833</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos">834</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_dictionary_property_attribute</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos">835</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Gives the name of the attribute used for the name of the </span>
</span><span id="L-836"><a href="#L-836"><span class="linenos">836</span></a><span class="sd">        STIX property that is implemented as a dictionary.</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos">837</span></a>
</span><span id="L-838"><a href="#L-838"><span class="linenos">838</span></a><span class="sd">        :raises MappingException: If the mapping is invalid or </span>
</span><span id="L-839"><a href="#L-839"><span class="linenos">839</span></a><span class="sd">            incomplete</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos">840</span></a>
</span><span id="L-841"><a href="#L-841"><span class="linenos">841</span></a><span class="sd">        :return: The name of the attribute for the name of the STIX </span>
</span><span id="L-842"><a href="#L-842"><span class="linenos">842</span></a><span class="sd">            property</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos">843</span></a><span class="sd">        :rtype: str</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos">844</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos">845</span></a>        <span class="n">dict_data</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">dictionary_data</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos">846</span></a>        <span class="n">attribute_name</span> <span class="o">=</span> <span class="n">dict_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos">847</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DICTIONARY_ATTRIBUTE_NAME</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos">848</span></a>        <span class="p">)</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos">849</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attribute_name</span><span class="p">:</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos">850</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos">851</span></a>                <span class="s2">&quot;No attribute specified for name of the property&quot;</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos">852</span></a>            <span class="p">)</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos">853</span></a>        <span class="k">return</span> <span class="n">attribute_name</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos">854</span></a>
</span><span id="L-855"><a href="#L-855"><span class="linenos">855</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos">856</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_extension_attribute_info</span><span class="p">(</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos">857</span></a>        <span class="n">stix_object</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos">858</span></a>        <span class="n">stix_extension</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos">859</span></a>        <span class="n">stix_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos">860</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos">861</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the attribute info of an extension.</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos">862</span></a>
</span><span id="L-863"><a href="#L-863"><span class="linenos">863</span></a><span class="sd">        :param stix_object: The name of the STIX type, e.g. malware</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos">864</span></a><span class="sd">        :type stix_object: str</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos">865</span></a><span class="sd">        :param stix_extension: The name of the extension</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos">866</span></a><span class="sd">        :type stix_extension: str</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos">867</span></a><span class="sd">        :param stix_name: The name of the attribute</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos">868</span></a><span class="sd">        :type stix_name: str</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos">869</span></a>
</span><span id="L-870"><a href="#L-870"><span class="linenos">870</span></a><span class="sd">        :raises MappingException: If the stix type or extension is not </span>
</span><span id="L-871"><a href="#L-871"><span class="linenos">871</span></a><span class="sd">            defined in the mapping</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos">872</span></a>
</span><span id="L-873"><a href="#L-873"><span class="linenos">873</span></a><span class="sd">        :return: The name and type of the attribute in TypeDB,</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos">874</span></a><span class="sd">            (None, None) if it a custom attribute</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos">875</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos">876</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos">877</span></a>        <span class="n">object_extensions</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span> \
</span><span id="L-878"><a href="#L-878"><span class="linenos">878</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_object</span><span class="p">)</span> \
</span><span id="L-879"><a href="#L-879"><span class="linenos">879</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_EXTENSIONS</span><span class="p">)</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos">880</span></a>
</span><span id="L-881"><a href="#L-881"><span class="linenos">881</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">object_extensions</span><span class="p">:</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos">882</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos">883</span></a>                <span class="sa">f</span><span class="s2">&quot;No extension specified for type </span><span class="si">{</span><span class="n">stix_object</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos">884</span></a>            <span class="p">)</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos">885</span></a>        <span class="n">extension</span> <span class="o">=</span> <span class="n">object_extensions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_extension</span><span class="p">)</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos">886</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">extension</span><span class="p">:</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos">887</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos">888</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stix_extension</span><span class="si">}</span><span class="s2"> is not a predefined extension for type </span><span class="si">{</span><span class="n">stix_object</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos">889</span></a>            <span class="p">)</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos">890</span></a>        <span class="n">attributes</span> <span class="o">=</span> <span class="n">extension</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTES</span><span class="p">)</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos">891</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attributes</span><span class="p">:</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos">892</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos">893</span></a>                <span class="sa">f</span><span class="s2">&quot;No attributes defined for extension </span><span class="si">{</span><span class="n">stix_extension</span><span class="si">}</span><span class="s2"> of stix type </span><span class="si">{</span><span class="n">stix_object</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos">894</span></a>            <span class="p">)</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos">895</span></a>        <span class="n">attribute_data</span> <span class="o">=</span> <span class="n">attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_name</span><span class="p">)</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos">896</span></a>
</span><span id="L-897"><a href="#L-897"><span class="linenos">897</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attribute_data</span><span class="p">:</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos">898</span></a>            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos">899</span></a>
</span><span id="L-900"><a href="#L-900"><span class="linenos">900</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">attribute_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_NAME</span><span class="p">)</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos">901</span></a>        <span class="n">value_type</span> <span class="o">=</span> <span class="n">attribute_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos">902</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_VALUE_TYPE</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos">903</span></a>        <span class="p">)</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos">904</span></a>
</span><span id="L-905"><a href="#L-905"><span class="linenos">905</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">value_type</span><span class="p">:</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos">906</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos">907</span></a>                <span class="sa">f</span><span class="s2">&quot;No name or no value type specified for attribute </span><span class="si">{</span><span class="n">stix_name</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos">908</span></a>                <span class="sa">f</span><span class="s2">&quot;of extension </span><span class="si">{</span><span class="n">stix_extension</span><span class="si">}</span><span class="s2"> of stix type </span><span class="si">{</span><span class="n">stix_object</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos">909</span></a>            <span class="p">)</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos">910</span></a>
</span><span id="L-911"><a href="#L-911"><span class="linenos">911</span></a>        <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">value_type</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos">912</span></a>
</span><span id="L-913"><a href="#L-913"><span class="linenos">913</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos">914</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_defined_extension</span><span class="p">(</span><span class="n">stix_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">extension_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos">915</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;States whether an extension name is defined according to</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos">916</span></a><span class="sd">        STIX 2.1 or not, that means it is a custom extension.</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos">917</span></a>
</span><span id="L-918"><a href="#L-918"><span class="linenos">918</span></a><span class="sd">        :param stix_type: The type of the STIX object</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos">919</span></a><span class="sd">        :type stix_type: str</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos">920</span></a><span class="sd">        :param extension_name: The name of the extension</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos">921</span></a><span class="sd">        :type extension_name: str</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos">922</span></a>
</span><span id="L-923"><a href="#L-923"><span class="linenos">923</span></a><span class="sd">        :raises MappingException: If the stix type is not defined</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos">924</span></a>
</span><span id="L-925"><a href="#L-925"><span class="linenos">925</span></a><span class="sd">        :return: Whether the extension is a predefined extension</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos">926</span></a><span class="sd">        :rtype: bool</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos">927</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos">928</span></a>        <span class="n">stix_object_data</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span> \
</span><span id="L-929"><a href="#L-929"><span class="linenos">929</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_type</span><span class="p">)</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos">930</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">stix_object_data</span><span class="p">:</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos">931</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos">932</span></a>                <span class="sa">f</span><span class="s2">&quot;Stix type </span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2"> is not defined&quot;</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos">933</span></a>            <span class="p">)</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos">934</span></a>        <span class="n">extensions</span> <span class="o">=</span> <span class="n">stix_object_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_EXTENSIONS</span><span class="p">)</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos">935</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">extensions</span><span class="p">:</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos">936</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos">937</span></a>
</span><span id="L-938"><a href="#L-938"><span class="linenos">938</span></a>        <span class="k">return</span> <span class="n">extension_name</span> <span class="ow">in</span> <span class="n">extensions</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span></pre></div>


            </section>
                <section id="STIXtoTypeDBMapper">
                            <input id="STIXtoTypeDBMapper-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">STIXtoTypeDBMapper</span>:

                <label class="view-source-button" for="STIXtoTypeDBMapper-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper-14"><a href="#STIXtoTypeDBMapper-14"><span class="linenos"> 14</span></a><span class="k">class</span><span class="w"> </span><span class="nc">STIXtoTypeDBMapper</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-15"><a href="#STIXtoTypeDBMapper-15"><span class="linenos"> 15</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Handles the mapping file that describes how to translate </span>
</span><span id="STIXtoTypeDBMapper-16"><a href="#STIXtoTypeDBMapper-16"><span class="linenos"> 16</span></a><span class="sd">    STIX 2.1 to the TypeDB schema.</span>
</span><span id="STIXtoTypeDBMapper-17"><a href="#STIXtoTypeDBMapper-17"><span class="linenos"> 17</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-18"><a href="#STIXtoTypeDBMapper-18"><span class="linenos"> 18</span></a>
</span><span id="STIXtoTypeDBMapper-19"><a href="#STIXtoTypeDBMapper-19"><span class="linenos"> 19</span></a>    <span class="n">classes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="STIXtoTypeDBMapper-20"><a href="#STIXtoTypeDBMapper-20"><span class="linenos"> 20</span></a>    <span class="n">stix_objects</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="STIXtoTypeDBMapper-21"><a href="#STIXtoTypeDBMapper-21"><span class="linenos"> 21</span></a>    <span class="n">composites_mapping</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="STIXtoTypeDBMapper-22"><a href="#STIXtoTypeDBMapper-22"><span class="linenos"> 22</span></a>    <span class="n">common_attributes</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="STIXtoTypeDBMapper-23"><a href="#STIXtoTypeDBMapper-23"><span class="linenos"> 23</span></a>    <span class="n">sros_role_info</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="STIXtoTypeDBMapper-24"><a href="#STIXtoTypeDBMapper-24"><span class="linenos"> 24</span></a>    <span class="n">key_value_pairs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="STIXtoTypeDBMapper-25"><a href="#STIXtoTypeDBMapper-25"><span class="linenos"> 25</span></a>    <span class="n">dictionary_data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="STIXtoTypeDBMapper-26"><a href="#STIXtoTypeDBMapper-26"><span class="linenos"> 26</span></a>
</span><span id="STIXtoTypeDBMapper-27"><a href="#STIXtoTypeDBMapper-27"><span class="linenos"> 27</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-28"><a href="#STIXtoTypeDBMapper-28"><span class="linenos"> 28</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">split_type</span><span class="p">(</span><span class="n">value_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper-29"><a href="#STIXtoTypeDBMapper-29"><span class="linenos"> 29</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Splits a compound value type to its ingredients according </span>
</span><span id="STIXtoTypeDBMapper-30"><a href="#STIXtoTypeDBMapper-30"><span class="linenos"> 30</span></a><span class="sd">        to the mapping.</span>
</span><span id="STIXtoTypeDBMapper-31"><a href="#STIXtoTypeDBMapper-31"><span class="linenos"> 31</span></a><span class="sd">        If it is indeed a NonPrimitive Type, then the first value is </span>
</span><span id="STIXtoTypeDBMapper-32"><a href="#STIXtoTypeDBMapper-32"><span class="linenos"> 32</span></a><span class="sd">        the abstract and the second the subtype. Otherwise, the first</span>
</span><span id="STIXtoTypeDBMapper-33"><a href="#STIXtoTypeDBMapper-33"><span class="linenos"> 33</span></a><span class="sd">        value is the value type and the second is empty.</span>
</span><span id="STIXtoTypeDBMapper-34"><a href="#STIXtoTypeDBMapper-34"><span class="linenos"> 34</span></a>
</span><span id="STIXtoTypeDBMapper-35"><a href="#STIXtoTypeDBMapper-35"><span class="linenos"> 35</span></a><span class="sd">        :param value_type: The type of a value</span>
</span><span id="STIXtoTypeDBMapper-36"><a href="#STIXtoTypeDBMapper-36"><span class="linenos"> 36</span></a><span class="sd">        :type value_type: str</span>
</span><span id="STIXtoTypeDBMapper-37"><a href="#STIXtoTypeDBMapper-37"><span class="linenos"> 37</span></a>
</span><span id="STIXtoTypeDBMapper-38"><a href="#STIXtoTypeDBMapper-38"><span class="linenos"> 38</span></a><span class="sd">        :return: The abstract and subtype of the type</span>
</span><span id="STIXtoTypeDBMapper-39"><a href="#STIXtoTypeDBMapper-39"><span class="linenos"> 39</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="STIXtoTypeDBMapper-40"><a href="#STIXtoTypeDBMapper-40"><span class="linenos"> 40</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-41"><a href="#STIXtoTypeDBMapper-41"><span class="linenos"> 41</span></a>        <span class="n">splitted</span> <span class="o">=</span> <span class="n">value_type</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_TYPE_SEPARATOR</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-42"><a href="#STIXtoTypeDBMapper-42"><span class="linenos"> 42</span></a>        <span class="n">abstract</span> <span class="o">=</span> <span class="n">splitted</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="STIXtoTypeDBMapper-43"><a href="#STIXtoTypeDBMapper-43"><span class="linenos"> 43</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">splitted</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-44"><a href="#STIXtoTypeDBMapper-44"><span class="linenos"> 44</span></a>            <span class="n">subtype</span> <span class="o">=</span> <span class="n">splitted</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="STIXtoTypeDBMapper-45"><a href="#STIXtoTypeDBMapper-45"><span class="linenos"> 45</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-46"><a href="#STIXtoTypeDBMapper-46"><span class="linenos"> 46</span></a>            <span class="n">subtype</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-47"><a href="#STIXtoTypeDBMapper-47"><span class="linenos"> 47</span></a>        <span class="k">return</span> <span class="n">abstract</span><span class="p">,</span> <span class="n">subtype</span>
</span><span id="STIXtoTypeDBMapper-48"><a href="#STIXtoTypeDBMapper-48"><span class="linenos"> 48</span></a>
</span><span id="STIXtoTypeDBMapper-49"><a href="#STIXtoTypeDBMapper-49"><span class="linenos"> 49</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-50"><a href="#STIXtoTypeDBMapper-50"><span class="linenos"> 50</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">join_type</span><span class="p">(</span><span class="n">tl_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subtype</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-51"><a href="#STIXtoTypeDBMapper-51"><span class="linenos"> 51</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Join an abstract and specific type together according </span>
</span><span id="STIXtoTypeDBMapper-52"><a href="#STIXtoTypeDBMapper-52"><span class="linenos"> 52</span></a><span class="sd">        to the mapping.</span>
</span><span id="STIXtoTypeDBMapper-53"><a href="#STIXtoTypeDBMapper-53"><span class="linenos"> 53</span></a>
</span><span id="STIXtoTypeDBMapper-54"><a href="#STIXtoTypeDBMapper-54"><span class="linenos"> 54</span></a><span class="sd">        :param tl_type: The top-level-/ abstract  type</span>
</span><span id="STIXtoTypeDBMapper-55"><a href="#STIXtoTypeDBMapper-55"><span class="linenos"> 55</span></a><span class="sd">        :type tl_type: str</span>
</span><span id="STIXtoTypeDBMapper-56"><a href="#STIXtoTypeDBMapper-56"><span class="linenos"> 56</span></a><span class="sd">        :param subtype: The sub-/ specific type</span>
</span><span id="STIXtoTypeDBMapper-57"><a href="#STIXtoTypeDBMapper-57"><span class="linenos"> 57</span></a><span class="sd">        :type subtype: str</span>
</span><span id="STIXtoTypeDBMapper-58"><a href="#STIXtoTypeDBMapper-58"><span class="linenos"> 58</span></a>
</span><span id="STIXtoTypeDBMapper-59"><a href="#STIXtoTypeDBMapper-59"><span class="linenos"> 59</span></a><span class="sd">        :return: The two types joined together</span>
</span><span id="STIXtoTypeDBMapper-60"><a href="#STIXtoTypeDBMapper-60"><span class="linenos"> 60</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper-61"><a href="#STIXtoTypeDBMapper-61"><span class="linenos"> 61</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-62"><a href="#STIXtoTypeDBMapper-62"><span class="linenos"> 62</span></a>        <span class="k">return</span> <span class="n">tl_type</span> <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_TYPE_SEPARATOR</span> <span class="o">+</span> <span class="n">subtype</span>
</span><span id="STIXtoTypeDBMapper-63"><a href="#STIXtoTypeDBMapper-63"><span class="linenos"> 63</span></a>
</span><span id="STIXtoTypeDBMapper-64"><a href="#STIXtoTypeDBMapper-64"><span class="linenos"> 64</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-65"><a href="#STIXtoTypeDBMapper-65"><span class="linenos"> 65</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper-66"><a href="#STIXtoTypeDBMapper-66"><span class="linenos"> 66</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validates STIX to TypeDB JSON mappings against predefined schema files.</span>
</span><span id="STIXtoTypeDBMapper-67"><a href="#STIXtoTypeDBMapper-67"><span class="linenos"> 67</span></a>
</span><span id="STIXtoTypeDBMapper-68"><a href="#STIXtoTypeDBMapper-68"><span class="linenos"> 68</span></a><span class="sd">        This function reads various schema files in JSON format and validates</span>
</span><span id="STIXtoTypeDBMapper-69"><a href="#STIXtoTypeDBMapper-69"><span class="linenos"> 69</span></a><span class="sd">        the corresponding mappings in the STIXtoTypeDBMapper class against these</span>
</span><span id="STIXtoTypeDBMapper-70"><a href="#STIXtoTypeDBMapper-70"><span class="linenos"> 70</span></a><span class="sd">        schemas. The schemas include classes, STIX objects, composites, SRO roles,</span>
</span><span id="STIXtoTypeDBMapper-71"><a href="#STIXtoTypeDBMapper-71"><span class="linenos"> 71</span></a><span class="sd">        key-value pairs, a dictionary type, and common attributes.</span>
</span><span id="STIXtoTypeDBMapper-72"><a href="#STIXtoTypeDBMapper-72"><span class="linenos"> 72</span></a>
</span><span id="STIXtoTypeDBMapper-73"><a href="#STIXtoTypeDBMapper-73"><span class="linenos"> 73</span></a><span class="sd">        :raises ValidationError: If a mapping file does not match the schema</span>
</span><span id="STIXtoTypeDBMapper-74"><a href="#STIXtoTypeDBMapper-74"><span class="linenos"> 74</span></a><span class="sd">        :raises SchemaError: If a JSON schema file is invalid</span>
</span><span id="STIXtoTypeDBMapper-75"><a href="#STIXtoTypeDBMapper-75"><span class="linenos"> 75</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-76"><a href="#STIXtoTypeDBMapper-76"><span class="linenos"> 76</span></a>        <span class="n">schema_classes</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-77"><a href="#STIXtoTypeDBMapper-77"><span class="linenos"> 77</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_CLASSES</span>
</span><span id="STIXtoTypeDBMapper-78"><a href="#STIXtoTypeDBMapper-78"><span class="linenos"> 78</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-79"><a href="#STIXtoTypeDBMapper-79"><span class="linenos"> 79</span></a>        <span class="n">schema_stix_objects</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-80"><a href="#STIXtoTypeDBMapper-80"><span class="linenos"> 80</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_STIX_OBJECTS</span>
</span><span id="STIXtoTypeDBMapper-81"><a href="#STIXtoTypeDBMapper-81"><span class="linenos"> 81</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-82"><a href="#STIXtoTypeDBMapper-82"><span class="linenos"> 82</span></a>        <span class="n">schema_composites</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-83"><a href="#STIXtoTypeDBMapper-83"><span class="linenos"> 83</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_COMPOSITES</span>
</span><span id="STIXtoTypeDBMapper-84"><a href="#STIXtoTypeDBMapper-84"><span class="linenos"> 84</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-85"><a href="#STIXtoTypeDBMapper-85"><span class="linenos"> 85</span></a>        <span class="n">schema_sro_roles</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-86"><a href="#STIXtoTypeDBMapper-86"><span class="linenos"> 86</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_SRO_ROLES</span>
</span><span id="STIXtoTypeDBMapper-87"><a href="#STIXtoTypeDBMapper-87"><span class="linenos"> 87</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-88"><a href="#STIXtoTypeDBMapper-88"><span class="linenos"> 88</span></a>        <span class="n">schema_key_value_pairs</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-89"><a href="#STIXtoTypeDBMapper-89"><span class="linenos"> 89</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_KV_PAIRS</span>
</span><span id="STIXtoTypeDBMapper-90"><a href="#STIXtoTypeDBMapper-90"><span class="linenos"> 90</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-91"><a href="#STIXtoTypeDBMapper-91"><span class="linenos"> 91</span></a>        <span class="n">schema_dictionary</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-92"><a href="#STIXtoTypeDBMapper-92"><span class="linenos"> 92</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_DICT</span>
</span><span id="STIXtoTypeDBMapper-93"><a href="#STIXtoTypeDBMapper-93"><span class="linenos"> 93</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-94"><a href="#STIXtoTypeDBMapper-94"><span class="linenos"> 94</span></a>        <span class="n">schema_common_attributes</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-95"><a href="#STIXtoTypeDBMapper-95"><span class="linenos"> 95</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_COMMON_ATTRIBUTES</span>
</span><span id="STIXtoTypeDBMapper-96"><a href="#STIXtoTypeDBMapper-96"><span class="linenos"> 96</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-97"><a href="#STIXtoTypeDBMapper-97"><span class="linenos"> 97</span></a>
</span><span id="STIXtoTypeDBMapper-98"><a href="#STIXtoTypeDBMapper-98"><span class="linenos"> 98</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">classes</span><span class="p">,</span> <span class="n">schema_classes</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-99"><a href="#STIXtoTypeDBMapper-99"><span class="linenos"> 99</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="p">,</span> <span class="n">schema_stix_objects</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-100"><a href="#STIXtoTypeDBMapper-100"><span class="linenos">100</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span><span class="p">,</span> <span class="n">schema_composites</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-101"><a href="#STIXtoTypeDBMapper-101"><span class="linenos">101</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">common_attributes</span><span class="p">,</span>
</span><span id="STIXtoTypeDBMapper-102"><a href="#STIXtoTypeDBMapper-102"><span class="linenos">102</span></a>                 <span class="n">schema_common_attributes</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-103"><a href="#STIXtoTypeDBMapper-103"><span class="linenos">103</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">sros_role_info</span><span class="p">,</span> <span class="n">schema_sro_roles</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-104"><a href="#STIXtoTypeDBMapper-104"><span class="linenos">104</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span><span class="p">,</span> <span class="n">schema_key_value_pairs</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-105"><a href="#STIXtoTypeDBMapper-105"><span class="linenos">105</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">dictionary_data</span><span class="p">,</span> <span class="n">schema_dictionary</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-106"><a href="#STIXtoTypeDBMapper-106"><span class="linenos">106</span></a>
</span><span id="STIXtoTypeDBMapper-107"><a href="#STIXtoTypeDBMapper-107"><span class="linenos">107</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-108"><a href="#STIXtoTypeDBMapper-108"><span class="linenos">108</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_data</span><span class="p">(</span><span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-109"><a href="#STIXtoTypeDBMapper-109"><span class="linenos">109</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads the data of the JSON map.</span>
</span><span id="STIXtoTypeDBMapper-110"><a href="#STIXtoTypeDBMapper-110"><span class="linenos">110</span></a>
</span><span id="STIXtoTypeDBMapper-111"><a href="#STIXtoTypeDBMapper-111"><span class="linenos">111</span></a><span class="sd">        Note that though every function calls this function here, </span>
</span><span id="STIXtoTypeDBMapper-112"><a href="#STIXtoTypeDBMapper-112"><span class="linenos">112</span></a><span class="sd">        the data is loaded only once. Therefore, the first call to </span>
</span><span id="STIXtoTypeDBMapper-113"><a href="#STIXtoTypeDBMapper-113"><span class="linenos">113</span></a><span class="sd">        this method decides which mappings to load.</span>
</span><span id="STIXtoTypeDBMapper-114"><a href="#STIXtoTypeDBMapper-114"><span class="linenos">114</span></a>
</span><span id="STIXtoTypeDBMapper-115"><a href="#STIXtoTypeDBMapper-115"><span class="linenos">115</span></a><span class="sd">        :param validate: Whether the data should be validated, too</span>
</span><span id="STIXtoTypeDBMapper-116"><a href="#STIXtoTypeDBMapper-116"><span class="linenos">116</span></a><span class="sd">        :type validate: bool, optional</span>
</span><span id="STIXtoTypeDBMapper-117"><a href="#STIXtoTypeDBMapper-117"><span class="linenos">117</span></a>
</span><span id="STIXtoTypeDBMapper-118"><a href="#STIXtoTypeDBMapper-118"><span class="linenos">118</span></a><span class="sd">        :raises SchemaError: If the schema is invalid </span>
</span><span id="STIXtoTypeDBMapper-119"><a href="#STIXtoTypeDBMapper-119"><span class="linenos">119</span></a><span class="sd">            and validate = True</span>
</span><span id="STIXtoTypeDBMapper-120"><a href="#STIXtoTypeDBMapper-120"><span class="linenos">120</span></a><span class="sd">        :raises ValidationError: If the mapping is invalid</span>
</span><span id="STIXtoTypeDBMapper-121"><a href="#STIXtoTypeDBMapper-121"><span class="linenos">121</span></a><span class="sd">            and validate = True</span>
</span><span id="STIXtoTypeDBMapper-122"><a href="#STIXtoTypeDBMapper-122"><span class="linenos">122</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-123"><a href="#STIXtoTypeDBMapper-123"><span class="linenos">123</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-124"><a href="#STIXtoTypeDBMapper-124"><span class="linenos">124</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-125"><a href="#STIXtoTypeDBMapper-125"><span class="linenos">125</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_COMPOSITES</span>
</span><span id="STIXtoTypeDBMapper-126"><a href="#STIXtoTypeDBMapper-126"><span class="linenos">126</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-127"><a href="#STIXtoTypeDBMapper-127"><span class="linenos">127</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-128"><a href="#STIXtoTypeDBMapper-128"><span class="linenos">128</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-129"><a href="#STIXtoTypeDBMapper-129"><span class="linenos">129</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SDO</span>
</span><span id="STIXtoTypeDBMapper-130"><a href="#STIXtoTypeDBMapper-130"><span class="linenos">130</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-131"><a href="#STIXtoTypeDBMapper-131"><span class="linenos">131</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-132"><a href="#STIXtoTypeDBMapper-132"><span class="linenos">132</span></a>                <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">FILE_SRO</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-133"><a href="#STIXtoTypeDBMapper-133"><span class="linenos">133</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-134"><a href="#STIXtoTypeDBMapper-134"><span class="linenos">134</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-135"><a href="#STIXtoTypeDBMapper-135"><span class="linenos">135</span></a>                <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCO</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-136"><a href="#STIXtoTypeDBMapper-136"><span class="linenos">136</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-137"><a href="#STIXtoTypeDBMapper-137"><span class="linenos">137</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-138"><a href="#STIXtoTypeDBMapper-138"><span class="linenos">138</span></a>                <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">FILE_SMO</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-139"><a href="#STIXtoTypeDBMapper-139"><span class="linenos">139</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-140"><a href="#STIXtoTypeDBMapper-140"><span class="linenos">140</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">classes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-141"><a href="#STIXtoTypeDBMapper-141"><span class="linenos">141</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-142"><a href="#STIXtoTypeDBMapper-142"><span class="linenos">142</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_CLASSES</span>
</span><span id="STIXtoTypeDBMapper-143"><a href="#STIXtoTypeDBMapper-143"><span class="linenos">143</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-144"><a href="#STIXtoTypeDBMapper-144"><span class="linenos">144</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">common_attributes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-145"><a href="#STIXtoTypeDBMapper-145"><span class="linenos">145</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">common_attributes</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-146"><a href="#STIXtoTypeDBMapper-146"><span class="linenos">146</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_COMMON_ATTRIBUTES</span>
</span><span id="STIXtoTypeDBMapper-147"><a href="#STIXtoTypeDBMapper-147"><span class="linenos">147</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-148"><a href="#STIXtoTypeDBMapper-148"><span class="linenos">148</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">sros_role_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-149"><a href="#STIXtoTypeDBMapper-149"><span class="linenos">149</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">sros_role_info</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-150"><a href="#STIXtoTypeDBMapper-150"><span class="linenos">150</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SRO_ROLES_INFO</span>
</span><span id="STIXtoTypeDBMapper-151"><a href="#STIXtoTypeDBMapper-151"><span class="linenos">151</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-152"><a href="#STIXtoTypeDBMapper-152"><span class="linenos">152</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-153"><a href="#STIXtoTypeDBMapper-153"><span class="linenos">153</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-154"><a href="#STIXtoTypeDBMapper-154"><span class="linenos">154</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_KEY_VALUE_PAIRS</span>
</span><span id="STIXtoTypeDBMapper-155"><a href="#STIXtoTypeDBMapper-155"><span class="linenos">155</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-156"><a href="#STIXtoTypeDBMapper-156"><span class="linenos">156</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">dictionary_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-157"><a href="#STIXtoTypeDBMapper-157"><span class="linenos">157</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">dictionary_data</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-158"><a href="#STIXtoTypeDBMapper-158"><span class="linenos">158</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_DICTIONARY_DATA</span>
</span><span id="STIXtoTypeDBMapper-159"><a href="#STIXtoTypeDBMapper-159"><span class="linenos">159</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-160"><a href="#STIXtoTypeDBMapper-160"><span class="linenos">160</span></a>        <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-161"><a href="#STIXtoTypeDBMapper-161"><span class="linenos">161</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
</span><span id="STIXtoTypeDBMapper-162"><a href="#STIXtoTypeDBMapper-162"><span class="linenos">162</span></a>
</span><span id="STIXtoTypeDBMapper-163"><a href="#STIXtoTypeDBMapper-163"><span class="linenos">163</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-164"><a href="#STIXtoTypeDBMapper-164"><span class="linenos">164</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_class</span><span class="p">(</span><span class="n">stix_object_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-165"><a href="#STIXtoTypeDBMapper-165"><span class="linenos">165</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the class used to build this STIX type.</span>
</span><span id="STIXtoTypeDBMapper-166"><a href="#STIXtoTypeDBMapper-166"><span class="linenos">166</span></a>
</span><span id="STIXtoTypeDBMapper-167"><a href="#STIXtoTypeDBMapper-167"><span class="linenos">167</span></a><span class="sd">        :param stix_object_type: The type of the STIX object, </span>
</span><span id="STIXtoTypeDBMapper-168"><a href="#STIXtoTypeDBMapper-168"><span class="linenos">168</span></a><span class="sd">            e.g. attack-pattern</span>
</span><span id="STIXtoTypeDBMapper-169"><a href="#STIXtoTypeDBMapper-169"><span class="linenos">169</span></a><span class="sd">        :type stix_object_type: str</span>
</span><span id="STIXtoTypeDBMapper-170"><a href="#STIXtoTypeDBMapper-170"><span class="linenos">170</span></a>
</span><span id="STIXtoTypeDBMapper-171"><a href="#STIXtoTypeDBMapper-171"><span class="linenos">171</span></a><span class="sd">        :return: The class used for the building, None if the type </span>
</span><span id="STIXtoTypeDBMapper-172"><a href="#STIXtoTypeDBMapper-172"><span class="linenos">172</span></a><span class="sd">            is a custom type</span>
</span><span id="STIXtoTypeDBMapper-173"><a href="#STIXtoTypeDBMapper-173"><span class="linenos">173</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper-174"><a href="#STIXtoTypeDBMapper-174"><span class="linenos">174</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-175"><a href="#STIXtoTypeDBMapper-175"><span class="linenos">175</span></a>        <span class="n">class_type</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="STIXtoTypeDBMapper-176"><a href="#STIXtoTypeDBMapper-176"><span class="linenos">176</span></a>        <span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">stix_object_types</span> <span class="ow">in</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper-177"><a href="#STIXtoTypeDBMapper-177"><span class="linenos">177</span></a>            <span class="k">if</span> <span class="n">stix_object_type</span> <span class="ow">in</span> <span class="n">stix_object_types</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-178"><a href="#STIXtoTypeDBMapper-178"><span class="linenos">178</span></a>                <span class="n">class_type</span> <span class="o">=</span> <span class="n">category</span>
</span><span id="STIXtoTypeDBMapper-179"><a href="#STIXtoTypeDBMapper-179"><span class="linenos">179</span></a>                <span class="k">break</span>
</span><span id="STIXtoTypeDBMapper-180"><a href="#STIXtoTypeDBMapper-180"><span class="linenos">180</span></a>        <span class="k">return</span> <span class="n">class_type</span>
</span><span id="STIXtoTypeDBMapper-181"><a href="#STIXtoTypeDBMapper-181"><span class="linenos">181</span></a>
</span><span id="STIXtoTypeDBMapper-182"><a href="#STIXtoTypeDBMapper-182"><span class="linenos">182</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-183"><a href="#STIXtoTypeDBMapper-183"><span class="linenos">183</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_typeql_thing_name</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-184"><a href="#STIXtoTypeDBMapper-184"><span class="linenos">184</span></a>        <span class="n">stix_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="STIXtoTypeDBMapper-185"><a href="#STIXtoTypeDBMapper-185"><span class="linenos">185</span></a>        <span class="n">stix_properties</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="STIXtoTypeDBMapper-186"><a href="#STIXtoTypeDBMapper-186"><span class="linenos">186</span></a>        <span class="n">stix_extensions</span><span class="p">:</span> <span class="nb">dict</span>
</span><span id="STIXtoTypeDBMapper-187"><a href="#STIXtoTypeDBMapper-187"><span class="linenos">187</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-188"><a href="#STIXtoTypeDBMapper-188"><span class="linenos">188</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of the TypeQL thing for a certain </span>
</span><span id="STIXtoTypeDBMapper-189"><a href="#STIXtoTypeDBMapper-189"><span class="linenos">189</span></a><span class="sd">        STIX Object. E.g. &quot;attack-pattern&quot; -&gt; &quot;attack-pattern&quot;.</span>
</span><span id="STIXtoTypeDBMapper-190"><a href="#STIXtoTypeDBMapper-190"><span class="linenos">190</span></a>
</span><span id="STIXtoTypeDBMapper-191"><a href="#STIXtoTypeDBMapper-191"><span class="linenos">191</span></a><span class="sd">        :param stix_type: The type of the STIX object</span>
</span><span id="STIXtoTypeDBMapper-192"><a href="#STIXtoTypeDBMapper-192"><span class="linenos">192</span></a><span class="sd">        :type stix_type: str</span>
</span><span id="STIXtoTypeDBMapper-193"><a href="#STIXtoTypeDBMapper-193"><span class="linenos">193</span></a><span class="sd">        :param stix_properties: The properties of the STIX Object</span>
</span><span id="STIXtoTypeDBMapper-194"><a href="#STIXtoTypeDBMapper-194"><span class="linenos">194</span></a><span class="sd">        :type stix_properties: dict </span>
</span><span id="STIXtoTypeDBMapper-195"><a href="#STIXtoTypeDBMapper-195"><span class="linenos">195</span></a><span class="sd">        :param stix_extensions: The extensions of the STIX Object</span>
</span><span id="STIXtoTypeDBMapper-196"><a href="#STIXtoTypeDBMapper-196"><span class="linenos">196</span></a><span class="sd">        :type stix_extensions: dict </span>
</span><span id="STIXtoTypeDBMapper-197"><a href="#STIXtoTypeDBMapper-197"><span class="linenos">197</span></a>
</span><span id="STIXtoTypeDBMapper-198"><a href="#STIXtoTypeDBMapper-198"><span class="linenos">198</span></a><span class="sd">        :raises MappingException: If the Type cannot be determined</span>
</span><span id="STIXtoTypeDBMapper-199"><a href="#STIXtoTypeDBMapper-199"><span class="linenos">199</span></a>
</span><span id="STIXtoTypeDBMapper-200"><a href="#STIXtoTypeDBMapper-200"><span class="linenos">200</span></a><span class="sd">        :return: The name of the object in TypeDB, None if the type </span>
</span><span id="STIXtoTypeDBMapper-201"><a href="#STIXtoTypeDBMapper-201"><span class="linenos">201</span></a><span class="sd">            is a custom type</span>
</span><span id="STIXtoTypeDBMapper-202"><a href="#STIXtoTypeDBMapper-202"><span class="linenos">202</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper-203"><a href="#STIXtoTypeDBMapper-203"><span class="linenos">203</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-204"><a href="#STIXtoTypeDBMapper-204"><span class="linenos">204</span></a>        <span class="n">object_info</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span> \
</span><span id="STIXtoTypeDBMapper-205"><a href="#STIXtoTypeDBMapper-205"><span class="linenos">205</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-206"><a href="#STIXtoTypeDBMapper-206"><span class="linenos">206</span></a>
</span><span id="STIXtoTypeDBMapper-207"><a href="#STIXtoTypeDBMapper-207"><span class="linenos">207</span></a>        <span class="c1"># Custom type</span>
</span><span id="STIXtoTypeDBMapper-208"><a href="#STIXtoTypeDBMapper-208"><span class="linenos">208</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">object_info</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-209"><a href="#STIXtoTypeDBMapper-209"><span class="linenos">209</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="STIXtoTypeDBMapper-210"><a href="#STIXtoTypeDBMapper-210"><span class="linenos">210</span></a>
</span><span id="STIXtoTypeDBMapper-211"><a href="#STIXtoTypeDBMapper-211"><span class="linenos">211</span></a>        <span class="n">assigned_type</span> <span class="o">=</span> <span class="n">object_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_TYPEDB_TYPE</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-212"><a href="#STIXtoTypeDBMapper-212"><span class="linenos">212</span></a>        <span class="n">subtypes</span> <span class="o">=</span> <span class="n">object_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_SUBTYPES</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-213"><a href="#STIXtoTypeDBMapper-213"><span class="linenos">213</span></a>
</span><span id="STIXtoTypeDBMapper-214"><a href="#STIXtoTypeDBMapper-214"><span class="linenos">214</span></a>        <span class="n">typedb_type</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-215"><a href="#STIXtoTypeDBMapper-215"><span class="linenos">215</span></a>
</span><span id="STIXtoTypeDBMapper-216"><a href="#STIXtoTypeDBMapper-216"><span class="linenos">216</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">assigned_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="STIXtoTypeDBMapper-217"><a href="#STIXtoTypeDBMapper-217"><span class="linenos">217</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No TypeDB type specified for </span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-218"><a href="#STIXtoTypeDBMapper-218"><span class="linenos">218</span></a>        <span class="n">typedb_type</span> <span class="o">=</span> <span class="n">assigned_type</span>
</span><span id="STIXtoTypeDBMapper-219"><a href="#STIXtoTypeDBMapper-219"><span class="linenos">219</span></a>
</span><span id="STIXtoTypeDBMapper-220"><a href="#STIXtoTypeDBMapper-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="n">subtypes</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-221"><a href="#STIXtoTypeDBMapper-221"><span class="linenos">221</span></a>            <span class="n">attribute</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">subtypes</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span id="STIXtoTypeDBMapper-222"><a href="#STIXtoTypeDBMapper-222"><span class="linenos">222</span></a>            <span class="n">value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">stix_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-223"><a href="#STIXtoTypeDBMapper-223"><span class="linenos">223</span></a>            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-224"><a href="#STIXtoTypeDBMapper-224"><span class="linenos">224</span></a>                <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-225"><a href="#STIXtoTypeDBMapper-225"><span class="linenos">225</span></a>                    <span class="sa">f</span><span class="s2">&quot;The property &#39;</span><span class="si">{</span><span class="n">attribute</span><span class="si">}</span><span class="s2">&#39; is required for STIX objects of type &#39;</span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-226"><a href="#STIXtoTypeDBMapper-226"><span class="linenos">226</span></a>            <span class="n">typedb_type</span> <span class="o">=</span> <span class="n">subtypes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="STIXtoTypeDBMapper-227"><a href="#STIXtoTypeDBMapper-227"><span class="linenos">227</span></a>            <span class="k">if</span> <span class="n">typedb_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-228"><a href="#STIXtoTypeDBMapper-228"><span class="linenos">228</span></a>                <span class="n">typedb_type</span> <span class="o">=</span> <span class="n">subtypes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span> \
</span><span id="STIXtoTypeDBMapper-229"><a href="#STIXtoTypeDBMapper-229"><span class="linenos">229</span></a>                    <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DEFAULT_KEY</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-230"><a href="#STIXtoTypeDBMapper-230"><span class="linenos">230</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">typedb_type</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-231"><a href="#STIXtoTypeDBMapper-231"><span class="linenos">231</span></a>                <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-232"><a href="#STIXtoTypeDBMapper-232"><span class="linenos">232</span></a>                    <span class="c1"># f&quot;{stix_properties.get(&#39;id&#39;)}: subtyping for &#39;{stix_type}&#39; is not exhaustive&quot;)</span>
</span><span id="STIXtoTypeDBMapper-233"><a href="#STIXtoTypeDBMapper-233"><span class="linenos">233</span></a>                    <span class="sa">f</span><span class="s2">&quot;In &#39;</span><span class="si">{</span><span class="n">stix_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;: the value &#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39; &quot;</span>\
</span><span id="STIXtoTypeDBMapper-234"><a href="#STIXtoTypeDBMapper-234"><span class="linenos">234</span></a>                    <span class="sa">f</span><span class="s2">&quot;is not defined for &#39;</span><span class="si">{</span><span class="n">attribute</span><span class="si">}</span><span class="s2">&#39; in the mapping of &#39;</span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-235"><a href="#STIXtoTypeDBMapper-235"><span class="linenos">235</span></a>
</span><span id="STIXtoTypeDBMapper-236"><a href="#STIXtoTypeDBMapper-236"><span class="linenos">236</span></a>        <span class="c1"># update the type if the given object has a predefined extension</span>
</span><span id="STIXtoTypeDBMapper-237"><a href="#STIXtoTypeDBMapper-237"><span class="linenos">237</span></a>        <span class="k">if</span> <span class="n">stix_extensions</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-238"><a href="#STIXtoTypeDBMapper-238"><span class="linenos">238</span></a>            <span class="n">obj_extensions</span> <span class="o">=</span> <span class="n">stix_extensions</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="STIXtoTypeDBMapper-239"><a href="#STIXtoTypeDBMapper-239"><span class="linenos">239</span></a>            <span class="n">predefined_extensions</span> <span class="o">=</span> <span class="n">object_info</span> \
</span><span id="STIXtoTypeDBMapper-240"><a href="#STIXtoTypeDBMapper-240"><span class="linenos">240</span></a>                <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_EXTENSIONS</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-241"><a href="#STIXtoTypeDBMapper-241"><span class="linenos">241</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">predefined_extensions</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-242"><a href="#STIXtoTypeDBMapper-242"><span class="linenos">242</span></a>                <span class="k">return</span> <span class="n">typedb_type</span>
</span><span id="STIXtoTypeDBMapper-243"><a href="#STIXtoTypeDBMapper-243"><span class="linenos">243</span></a>
</span><span id="STIXtoTypeDBMapper-244"><a href="#STIXtoTypeDBMapper-244"><span class="linenos">244</span></a>            <span class="n">predefined_extensions</span> <span class="o">=</span> <span class="n">predefined_extensions</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="STIXtoTypeDBMapper-245"><a href="#STIXtoTypeDBMapper-245"><span class="linenos">245</span></a>            <span class="n">final_extension</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-246"><a href="#STIXtoTypeDBMapper-246"><span class="linenos">246</span></a>            <span class="k">for</span> <span class="n">extension</span> <span class="ow">in</span> <span class="n">obj_extensions</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-247"><a href="#STIXtoTypeDBMapper-247"><span class="linenos">247</span></a>                <span class="k">if</span> <span class="n">extension</span> <span class="ow">in</span> <span class="n">predefined_extensions</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-248"><a href="#STIXtoTypeDBMapper-248"><span class="linenos">248</span></a>                    <span class="k">if</span> <span class="n">final_extension</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-249"><a href="#STIXtoTypeDBMapper-249"><span class="linenos">249</span></a>                        <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-250"><a href="#STIXtoTypeDBMapper-250"><span class="linenos">250</span></a>                            <span class="sa">f</span><span class="s2">&quot;Two predefined extensions given for &#39;</span><span class="si">{</span><span class="n">stix_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
</span><span id="STIXtoTypeDBMapper-251"><a href="#STIXtoTypeDBMapper-251"><span class="linenos">251</span></a>                            <span class="sa">f</span><span class="s2">&quot;The extensions are mutually exclusive, a &#39;</span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&#39; must have &quot;</span>
</span><span id="STIXtoTypeDBMapper-252"><a href="#STIXtoTypeDBMapper-252"><span class="linenos">252</span></a>                            <span class="s2">&quot;at most one extension.&quot;</span>
</span><span id="STIXtoTypeDBMapper-253"><a href="#STIXtoTypeDBMapper-253"><span class="linenos">253</span></a>                        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-254"><a href="#STIXtoTypeDBMapper-254"><span class="linenos">254</span></a>                    <span class="n">final_extension</span> <span class="o">=</span> <span class="n">extension</span>
</span><span id="STIXtoTypeDBMapper-255"><a href="#STIXtoTypeDBMapper-255"><span class="linenos">255</span></a>            <span class="k">if</span> <span class="n">final_extension</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-256"><a href="#STIXtoTypeDBMapper-256"><span class="linenos">256</span></a>                <span class="n">typedb_type</span> <span class="o">=</span> <span class="n">object_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_EXTENSIONS</span><span class="p">)</span> \
</span><span id="STIXtoTypeDBMapper-257"><a href="#STIXtoTypeDBMapper-257"><span class="linenos">257</span></a>                    <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">final_extension</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_TYPEDB_TYPE</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-258"><a href="#STIXtoTypeDBMapper-258"><span class="linenos">258</span></a>
</span><span id="STIXtoTypeDBMapper-259"><a href="#STIXtoTypeDBMapper-259"><span class="linenos">259</span></a>        <span class="k">return</span> <span class="n">typedb_type</span>
</span><span id="STIXtoTypeDBMapper-260"><a href="#STIXtoTypeDBMapper-260"><span class="linenos">260</span></a>
</span><span id="STIXtoTypeDBMapper-261"><a href="#STIXtoTypeDBMapper-261"><span class="linenos">261</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-262"><a href="#STIXtoTypeDBMapper-262"><span class="linenos">262</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_typedb_supertype</span><span class="p">(</span><span class="n">stix_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-263"><a href="#STIXtoTypeDBMapper-263"><span class="linenos">263</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the least abstract supertype in TypeDB for a STIX </span>
</span><span id="STIXtoTypeDBMapper-264"><a href="#STIXtoTypeDBMapper-264"><span class="linenos">264</span></a><span class="sd">        object type.</span>
</span><span id="STIXtoTypeDBMapper-265"><a href="#STIXtoTypeDBMapper-265"><span class="linenos">265</span></a>
</span><span id="STIXtoTypeDBMapper-266"><a href="#STIXtoTypeDBMapper-266"><span class="linenos">266</span></a><span class="sd">        :param stix_type: The STIX Object type, e.g. attack-pattern</span>
</span><span id="STIXtoTypeDBMapper-267"><a href="#STIXtoTypeDBMapper-267"><span class="linenos">267</span></a><span class="sd">        :type stix_type: str</span>
</span><span id="STIXtoTypeDBMapper-268"><a href="#STIXtoTypeDBMapper-268"><span class="linenos">268</span></a>
</span><span id="STIXtoTypeDBMapper-269"><a href="#STIXtoTypeDBMapper-269"><span class="linenos">269</span></a><span class="sd">        :raises MappingException: If the stix type is not defined or the</span>
</span><span id="STIXtoTypeDBMapper-270"><a href="#STIXtoTypeDBMapper-270"><span class="linenos">270</span></a><span class="sd">            mapping is invalid</span>
</span><span id="STIXtoTypeDBMapper-271"><a href="#STIXtoTypeDBMapper-271"><span class="linenos">271</span></a>
</span><span id="STIXtoTypeDBMapper-272"><a href="#STIXtoTypeDBMapper-272"><span class="linenos">272</span></a><span class="sd">        :return: The least abstract supertype in TypeDB for a STIX Object </span>
</span><span id="STIXtoTypeDBMapper-273"><a href="#STIXtoTypeDBMapper-273"><span class="linenos">273</span></a><span class="sd">            type</span>
</span><span id="STIXtoTypeDBMapper-274"><a href="#STIXtoTypeDBMapper-274"><span class="linenos">274</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper-275"><a href="#STIXtoTypeDBMapper-275"><span class="linenos">275</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-276"><a href="#STIXtoTypeDBMapper-276"><span class="linenos">276</span></a>        <span class="n">object_map</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-277"><a href="#STIXtoTypeDBMapper-277"><span class="linenos">277</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">object_map</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-278"><a href="#STIXtoTypeDBMapper-278"><span class="linenos">278</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;STIX type &#39;</span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&#39; not defined&quot;</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-279"><a href="#STIXtoTypeDBMapper-279"><span class="linenos">279</span></a>        <span class="n">sup_type</span> <span class="o">=</span> <span class="n">object_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_TYPEDB_TYPE</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-280"><a href="#STIXtoTypeDBMapper-280"><span class="linenos">280</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">sup_type</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-281"><a href="#STIXtoTypeDBMapper-281"><span class="linenos">281</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-282"><a href="#STIXtoTypeDBMapper-282"><span class="linenos">282</span></a>                <span class="sa">f</span><span class="s2">&quot;No TypeDB type defined for &#39;</span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-283"><a href="#STIXtoTypeDBMapper-283"><span class="linenos">283</span></a>        <span class="k">return</span> <span class="n">sup_type</span>
</span><span id="STIXtoTypeDBMapper-284"><a href="#STIXtoTypeDBMapper-284"><span class="linenos">284</span></a>
</span><span id="STIXtoTypeDBMapper-285"><a href="#STIXtoTypeDBMapper-285"><span class="linenos">285</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-286"><a href="#STIXtoTypeDBMapper-286"><span class="linenos">286</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_default_value_implementation</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-287"><a href="#STIXtoTypeDBMapper-287"><span class="linenos">287</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the default value type for a value of unknown type.</span>
</span><span id="STIXtoTypeDBMapper-288"><a href="#STIXtoTypeDBMapper-288"><span class="linenos">288</span></a>
</span><span id="STIXtoTypeDBMapper-289"><a href="#STIXtoTypeDBMapper-289"><span class="linenos">289</span></a><span class="sd">        :param value: The value whose type is unknown</span>
</span><span id="STIXtoTypeDBMapper-290"><a href="#STIXtoTypeDBMapper-290"><span class="linenos">290</span></a><span class="sd">        :type value: Any</span>
</span><span id="STIXtoTypeDBMapper-291"><a href="#STIXtoTypeDBMapper-291"><span class="linenos">291</span></a>
</span><span id="STIXtoTypeDBMapper-292"><a href="#STIXtoTypeDBMapper-292"><span class="linenos">292</span></a><span class="sd">        :return: The name of the value type, None if no value type</span>
</span><span id="STIXtoTypeDBMapper-293"><a href="#STIXtoTypeDBMapper-293"><span class="linenos">293</span></a><span class="sd">            is defined</span>
</span><span id="STIXtoTypeDBMapper-294"><a href="#STIXtoTypeDBMapper-294"><span class="linenos">294</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper-295"><a href="#STIXtoTypeDBMapper-295"><span class="linenos">295</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-296"><a href="#STIXtoTypeDBMapper-296"><span class="linenos">296</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-297"><a href="#STIXtoTypeDBMapper-297"><span class="linenos">297</span></a>        <span class="k">match</span> <span class="n">value</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-298"><a href="#STIXtoTypeDBMapper-298"><span class="linenos">298</span></a>            <span class="k">case</span> <span class="nb">int</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper-299"><a href="#STIXtoTypeDBMapper-299"><span class="linenos">299</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">typedb_constants</span><span class="o">.</span><span class="n">LONG</span>
</span><span id="STIXtoTypeDBMapper-300"><a href="#STIXtoTypeDBMapper-300"><span class="linenos">300</span></a>            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper-301"><a href="#STIXtoTypeDBMapper-301"><span class="linenos">301</span></a>                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">satrap</span><span class="o">.</span><span class="n">etl</span><span class="o">.</span><span class="n">stix_constants</span><span class="o">.</span><span class="n">STIX_TIMESTAMP_REGEX</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="STIXtoTypeDBMapper-302"><a href="#STIXtoTypeDBMapper-302"><span class="linenos">302</span></a>                    <span class="n">res</span> <span class="o">=</span> <span class="n">typedb_constants</span><span class="o">.</span><span class="n">DATETIME</span>
</span><span id="STIXtoTypeDBMapper-303"><a href="#STIXtoTypeDBMapper-303"><span class="linenos">303</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-304"><a href="#STIXtoTypeDBMapper-304"><span class="linenos">304</span></a>                    <span class="n">res</span> <span class="o">=</span> <span class="n">typedb_constants</span><span class="o">.</span><span class="n">STRING</span>
</span><span id="STIXtoTypeDBMapper-305"><a href="#STIXtoTypeDBMapper-305"><span class="linenos">305</span></a>            <span class="k">case</span> <span class="nb">float</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper-306"><a href="#STIXtoTypeDBMapper-306"><span class="linenos">306</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">typedb_constants</span><span class="o">.</span><span class="n">DOUBLE</span>
</span><span id="STIXtoTypeDBMapper-307"><a href="#STIXtoTypeDBMapper-307"><span class="linenos">307</span></a>            <span class="k">case</span> <span class="nb">bool</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper-308"><a href="#STIXtoTypeDBMapper-308"><span class="linenos">308</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">typedb_constants</span><span class="o">.</span><span class="n">BOOLEAN</span>
</span><span id="STIXtoTypeDBMapper-309"><a href="#STIXtoTypeDBMapper-309"><span class="linenos">309</span></a>            <span class="k">case</span> <span class="nb">list</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper-310"><a href="#STIXtoTypeDBMapper-310"><span class="linenos">310</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-311"><a href="#STIXtoTypeDBMapper-311"><span class="linenos">311</span></a>                <span class="n">list_type</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">TYPEQL_LIST_PREFIX</span>
</span><span id="STIXtoTypeDBMapper-312"><a href="#STIXtoTypeDBMapper-312"><span class="linenos">312</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-313"><a href="#STIXtoTypeDBMapper-313"><span class="linenos">313</span></a>                    <span class="n">subtype</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span> \
</span><span id="STIXtoTypeDBMapper-314"><a href="#STIXtoTypeDBMapper-314"><span class="linenos">314</span></a>                        <span class="o">.</span><span class="n">get_default_value_implementation</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="STIXtoTypeDBMapper-315"><a href="#STIXtoTypeDBMapper-315"><span class="linenos">315</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-316"><a href="#STIXtoTypeDBMapper-316"><span class="linenos">316</span></a>                    <span class="n">subtype</span> <span class="o">=</span> <span class="n">typedb_constants</span><span class="o">.</span><span class="n">STRING</span>
</span><span id="STIXtoTypeDBMapper-317"><a href="#STIXtoTypeDBMapper-317"><span class="linenos">317</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">join_type</span><span class="p">(</span><span class="n">list_type</span><span class="p">,</span> <span class="n">subtype</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-318"><a href="#STIXtoTypeDBMapper-318"><span class="linenos">318</span></a>            <span class="k">case</span> <span class="nb">dict</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper-319"><a href="#STIXtoTypeDBMapper-319"><span class="linenos">319</span></a>                <span class="c1"># maybe check for predefined composite types</span>
</span><span id="STIXtoTypeDBMapper-320"><a href="#STIXtoTypeDBMapper-320"><span class="linenos">320</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">TYPEQL_DICTIONARY_KEYWORD</span>
</span><span id="STIXtoTypeDBMapper-321"><a href="#STIXtoTypeDBMapper-321"><span class="linenos">321</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-322"><a href="#STIXtoTypeDBMapper-322"><span class="linenos">322</span></a>                <span class="kc">None</span>
</span><span id="STIXtoTypeDBMapper-323"><a href="#STIXtoTypeDBMapper-323"><span class="linenos">323</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="STIXtoTypeDBMapper-324"><a href="#STIXtoTypeDBMapper-324"><span class="linenos">324</span></a>
</span><span id="STIXtoTypeDBMapper-325"><a href="#STIXtoTypeDBMapper-325"><span class="linenos">325</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-326"><a href="#STIXtoTypeDBMapper-326"><span class="linenos">326</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_roleplayers_for_SRO</span><span class="p">(</span><span class="n">stix_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper-327"><a href="#STIXtoTypeDBMapper-327"><span class="linenos">327</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Gives the properties that are implemented as roleplayers in</span>
</span><span id="STIXtoTypeDBMapper-328"><a href="#STIXtoTypeDBMapper-328"><span class="linenos">328</span></a><span class="sd">        a STIX relationship object.</span>
</span><span id="STIXtoTypeDBMapper-329"><a href="#STIXtoTypeDBMapper-329"><span class="linenos">329</span></a>
</span><span id="STIXtoTypeDBMapper-330"><a href="#STIXtoTypeDBMapper-330"><span class="linenos">330</span></a><span class="sd">        :param stix_type: The type of the STIX object</span>
</span><span id="STIXtoTypeDBMapper-331"><a href="#STIXtoTypeDBMapper-331"><span class="linenos">331</span></a><span class="sd">        :type stix_type: str</span>
</span><span id="STIXtoTypeDBMapper-332"><a href="#STIXtoTypeDBMapper-332"><span class="linenos">332</span></a>
</span><span id="STIXtoTypeDBMapper-333"><a href="#STIXtoTypeDBMapper-333"><span class="linenos">333</span></a><span class="sd">        :raises MappingException: If the STIX type does not exist</span>
</span><span id="STIXtoTypeDBMapper-334"><a href="#STIXtoTypeDBMapper-334"><span class="linenos">334</span></a>
</span><span id="STIXtoTypeDBMapper-335"><a href="#STIXtoTypeDBMapper-335"><span class="linenos">335</span></a><span class="sd">        :return: The properties that specify roleplayers</span>
</span><span id="STIXtoTypeDBMapper-336"><a href="#STIXtoTypeDBMapper-336"><span class="linenos">336</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper-337"><a href="#STIXtoTypeDBMapper-337"><span class="linenos">337</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-338"><a href="#STIXtoTypeDBMapper-338"><span class="linenos">338</span></a>        <span class="n">object_info</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-339"><a href="#STIXtoTypeDBMapper-339"><span class="linenos">339</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">object_info</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-340"><a href="#STIXtoTypeDBMapper-340"><span class="linenos">340</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-341"><a href="#STIXtoTypeDBMapper-341"><span class="linenos">341</span></a>                <span class="sa">f</span><span class="s2">&quot;STIX Object </span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2"> not defined&quot;</span>
</span><span id="STIXtoTypeDBMapper-342"><a href="#STIXtoTypeDBMapper-342"><span class="linenos">342</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-343"><a href="#STIXtoTypeDBMapper-343"><span class="linenos">343</span></a>        <span class="n">attributes</span> <span class="o">=</span> <span class="n">object_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTES</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-344"><a href="#STIXtoTypeDBMapper-344"><span class="linenos">344</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attributes</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-345"><a href="#STIXtoTypeDBMapper-345"><span class="linenos">345</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-346"><a href="#STIXtoTypeDBMapper-346"><span class="linenos">346</span></a>                <span class="sa">f</span><span class="s2">&quot;No attributes defined for STIX Object </span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper-347"><a href="#STIXtoTypeDBMapper-347"><span class="linenos">347</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-348"><a href="#STIXtoTypeDBMapper-348"><span class="linenos">348</span></a>        <span class="n">roleplayers</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="STIXtoTypeDBMapper-349"><a href="#STIXtoTypeDBMapper-349"><span class="linenos">349</span></a>        <span class="k">for</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">attribute_info</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper-350"><a href="#STIXtoTypeDBMapper-350"><span class="linenos">350</span></a>            <span class="n">value_type</span> <span class="o">=</span> <span class="n">attribute_info</span> \
</span><span id="STIXtoTypeDBMapper-351"><a href="#STIXtoTypeDBMapper-351"><span class="linenos">351</span></a>                <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_VALUE_TYPE</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-352"><a href="#STIXtoTypeDBMapper-352"><span class="linenos">352</span></a>            <span class="k">if</span> <span class="n">value_type</span> <span class="o">==</span> <span class="n">constants</span><span class="o">.</span><span class="n">TYPEQL_ROLEPLAYER</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-353"><a href="#STIXtoTypeDBMapper-353"><span class="linenos">353</span></a>                <span class="n">roleplayers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-354"><a href="#STIXtoTypeDBMapper-354"><span class="linenos">354</span></a>        <span class="k">return</span> <span class="n">roleplayers</span>
</span><span id="STIXtoTypeDBMapper-355"><a href="#STIXtoTypeDBMapper-355"><span class="linenos">355</span></a>
</span><span id="STIXtoTypeDBMapper-356"><a href="#STIXtoTypeDBMapper-356"><span class="linenos">356</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-357"><a href="#STIXtoTypeDBMapper-357"><span class="linenos">357</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_object_attribute_info</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-358"><a href="#STIXtoTypeDBMapper-358"><span class="linenos">358</span></a>        <span class="n">stix_object</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="STIXtoTypeDBMapper-359"><a href="#STIXtoTypeDBMapper-359"><span class="linenos">359</span></a>        <span class="n">stix_attribute</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="STIXtoTypeDBMapper-360"><a href="#STIXtoTypeDBMapper-360"><span class="linenos">360</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper-361"><a href="#STIXtoTypeDBMapper-361"><span class="linenos">361</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name and value of an attribute in the </span>
</span><span id="STIXtoTypeDBMapper-362"><a href="#STIXtoTypeDBMapper-362"><span class="linenos">362</span></a><span class="sd">        TypeDB Schema.</span>
</span><span id="STIXtoTypeDBMapper-363"><a href="#STIXtoTypeDBMapper-363"><span class="linenos">363</span></a>
</span><span id="STIXtoTypeDBMapper-364"><a href="#STIXtoTypeDBMapper-364"><span class="linenos">364</span></a><span class="sd">        :param stix_object: The type of the STIX object, </span>
</span><span id="STIXtoTypeDBMapper-365"><a href="#STIXtoTypeDBMapper-365"><span class="linenos">365</span></a><span class="sd">            e.g. attack-pattern</span>
</span><span id="STIXtoTypeDBMapper-366"><a href="#STIXtoTypeDBMapper-366"><span class="linenos">366</span></a><span class="sd">        :type stix_object: str</span>
</span><span id="STIXtoTypeDBMapper-367"><a href="#STIXtoTypeDBMapper-367"><span class="linenos">367</span></a><span class="sd">        :param stix_attribute: The attribute of the STIX Object</span>
</span><span id="STIXtoTypeDBMapper-368"><a href="#STIXtoTypeDBMapper-368"><span class="linenos">368</span></a><span class="sd">        :type stix_attribute: str</span>
</span><span id="STIXtoTypeDBMapper-369"><a href="#STIXtoTypeDBMapper-369"><span class="linenos">369</span></a>
</span><span id="STIXtoTypeDBMapper-370"><a href="#STIXtoTypeDBMapper-370"><span class="linenos">370</span></a><span class="sd">        :raises MappingException: If the stix type is not defined</span>
</span><span id="STIXtoTypeDBMapper-371"><a href="#STIXtoTypeDBMapper-371"><span class="linenos">371</span></a><span class="sd">            or the mapping is not valid/ complete</span>
</span><span id="STIXtoTypeDBMapper-372"><a href="#STIXtoTypeDBMapper-372"><span class="linenos">372</span></a>
</span><span id="STIXtoTypeDBMapper-373"><a href="#STIXtoTypeDBMapper-373"><span class="linenos">373</span></a><span class="sd">        :return: The TypeDB name and value, None if the attribute</span>
</span><span id="STIXtoTypeDBMapper-374"><a href="#STIXtoTypeDBMapper-374"><span class="linenos">374</span></a><span class="sd">            is a custom attribute</span>
</span><span id="STIXtoTypeDBMapper-375"><a href="#STIXtoTypeDBMapper-375"><span class="linenos">375</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="STIXtoTypeDBMapper-376"><a href="#STIXtoTypeDBMapper-376"><span class="linenos">376</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-377"><a href="#STIXtoTypeDBMapper-377"><span class="linenos">377</span></a>        <span class="n">common_attributes</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">common_attributes</span>
</span><span id="STIXtoTypeDBMapper-378"><a href="#STIXtoTypeDBMapper-378"><span class="linenos">378</span></a>
</span><span id="STIXtoTypeDBMapper-379"><a href="#STIXtoTypeDBMapper-379"><span class="linenos">379</span></a>        <span class="k">if</span> <span class="n">stix_attribute</span> <span class="ow">in</span> <span class="n">common_attributes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper-380"><a href="#STIXtoTypeDBMapper-380"><span class="linenos">380</span></a>            <span class="n">attr_info</span> <span class="o">=</span> <span class="n">common_attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_attribute</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-381"><a href="#STIXtoTypeDBMapper-381"><span class="linenos">381</span></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">attr_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_NAME</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-382"><a href="#STIXtoTypeDBMapper-382"><span class="linenos">382</span></a>            <span class="n">value</span> <span class="o">=</span> <span class="n">attr_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-383"><a href="#STIXtoTypeDBMapper-383"><span class="linenos">383</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_VALUE_TYPE</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-384"><a href="#STIXtoTypeDBMapper-384"><span class="linenos">384</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-385"><a href="#STIXtoTypeDBMapper-385"><span class="linenos">385</span></a>                <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-386"><a href="#STIXtoTypeDBMapper-386"><span class="linenos">386</span></a>                    <span class="sa">f</span><span class="s2">&quot;No name or no value given for &#39;</span><span class="si">{</span><span class="n">stix_attribute</span><span class="si">}</span><span class="s2">&#39; in common attributes&quot;</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-387"><a href="#STIXtoTypeDBMapper-387"><span class="linenos">387</span></a>            <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span>
</span><span id="STIXtoTypeDBMapper-388"><a href="#STIXtoTypeDBMapper-388"><span class="linenos">388</span></a>
</span><span id="STIXtoTypeDBMapper-389"><a href="#STIXtoTypeDBMapper-389"><span class="linenos">389</span></a>        <span class="n">stix_obj</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_object</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-390"><a href="#STIXtoTypeDBMapper-390"><span class="linenos">390</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">stix_object</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-391"><a href="#STIXtoTypeDBMapper-391"><span class="linenos">391</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-392"><a href="#STIXtoTypeDBMapper-392"><span class="linenos">392</span></a>                <span class="s2">&quot;The specified STIX Object does not exist&quot;</span>
</span><span id="STIXtoTypeDBMapper-393"><a href="#STIXtoTypeDBMapper-393"><span class="linenos">393</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-394"><a href="#STIXtoTypeDBMapper-394"><span class="linenos">394</span></a>
</span><span id="STIXtoTypeDBMapper-395"><a href="#STIXtoTypeDBMapper-395"><span class="linenos">395</span></a>        <span class="n">specific_attributes</span> <span class="o">=</span> <span class="n">stix_obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTES</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-396"><a href="#STIXtoTypeDBMapper-396"><span class="linenos">396</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">specific_attributes</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-397"><a href="#STIXtoTypeDBMapper-397"><span class="linenos">397</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-398"><a href="#STIXtoTypeDBMapper-398"><span class="linenos">398</span></a>                <span class="s2">&quot;No attributes are defined for </span><span class="si">{stix_object}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper-399"><a href="#STIXtoTypeDBMapper-399"><span class="linenos">399</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-400"><a href="#STIXtoTypeDBMapper-400"><span class="linenos">400</span></a>
</span><span id="STIXtoTypeDBMapper-401"><a href="#STIXtoTypeDBMapper-401"><span class="linenos">401</span></a>        <span class="n">attr_info</span> <span class="o">=</span> <span class="n">specific_attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_attribute</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-402"><a href="#STIXtoTypeDBMapper-402"><span class="linenos">402</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attr_info</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-403"><a href="#STIXtoTypeDBMapper-403"><span class="linenos">403</span></a>            <span class="c1"># Custom property</span>
</span><span id="STIXtoTypeDBMapper-404"><a href="#STIXtoTypeDBMapper-404"><span class="linenos">404</span></a>            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="STIXtoTypeDBMapper-405"><a href="#STIXtoTypeDBMapper-405"><span class="linenos">405</span></a>
</span><span id="STIXtoTypeDBMapper-406"><a href="#STIXtoTypeDBMapper-406"><span class="linenos">406</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">attr_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_NAME</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-407"><a href="#STIXtoTypeDBMapper-407"><span class="linenos">407</span></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">attr_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_VALUE_TYPE</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-408"><a href="#STIXtoTypeDBMapper-408"><span class="linenos">408</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-409"><a href="#STIXtoTypeDBMapper-409"><span class="linenos">409</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-410"><a href="#STIXtoTypeDBMapper-410"><span class="linenos">410</span></a>                <span class="sa">f</span><span class="s2">&quot;No name or no value given for attribute </span><span class="si">{</span><span class="n">stix_attribute</span><span class="si">}</span><span class="s2"> of stix type </span><span class="si">{</span><span class="n">stix_object</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper-411"><a href="#STIXtoTypeDBMapper-411"><span class="linenos">411</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-412"><a href="#STIXtoTypeDBMapper-412"><span class="linenos">412</span></a>        <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span>
</span><span id="STIXtoTypeDBMapper-413"><a href="#STIXtoTypeDBMapper-413"><span class="linenos">413</span></a>
</span><span id="STIXtoTypeDBMapper-414"><a href="#STIXtoTypeDBMapper-414"><span class="linenos">414</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-415"><a href="#STIXtoTypeDBMapper-415"><span class="linenos">415</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_composite_name</span><span class="p">(</span><span class="n">composite_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-416"><a href="#STIXtoTypeDBMapper-416"><span class="linenos">416</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the TypeDB name used for the composite type.</span>
</span><span id="STIXtoTypeDBMapper-417"><a href="#STIXtoTypeDBMapper-417"><span class="linenos">417</span></a>
</span><span id="STIXtoTypeDBMapper-418"><a href="#STIXtoTypeDBMapper-418"><span class="linenos">418</span></a><span class="sd">        :param composite_type: The STIX name of the composite type</span>
</span><span id="STIXtoTypeDBMapper-419"><a href="#STIXtoTypeDBMapper-419"><span class="linenos">419</span></a><span class="sd">        :type composite_type: str</span>
</span><span id="STIXtoTypeDBMapper-420"><a href="#STIXtoTypeDBMapper-420"><span class="linenos">420</span></a>
</span><span id="STIXtoTypeDBMapper-421"><a href="#STIXtoTypeDBMapper-421"><span class="linenos">421</span></a><span class="sd">        :raises MappingException: If the composite type does not exist,</span>
</span><span id="STIXtoTypeDBMapper-422"><a href="#STIXtoTypeDBMapper-422"><span class="linenos">422</span></a><span class="sd">            i.e. the mapping is invalid or incomplete</span>
</span><span id="STIXtoTypeDBMapper-423"><a href="#STIXtoTypeDBMapper-423"><span class="linenos">423</span></a>
</span><span id="STIXtoTypeDBMapper-424"><a href="#STIXtoTypeDBMapper-424"><span class="linenos">424</span></a><span class="sd">        :return: The TypeDB name used for the composite type</span>
</span><span id="STIXtoTypeDBMapper-425"><a href="#STIXtoTypeDBMapper-425"><span class="linenos">425</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper-426"><a href="#STIXtoTypeDBMapper-426"><span class="linenos">426</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-427"><a href="#STIXtoTypeDBMapper-427"><span class="linenos">427</span></a>        <span class="n">composite</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span> \
</span><span id="STIXtoTypeDBMapper-428"><a href="#STIXtoTypeDBMapper-428"><span class="linenos">428</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">composite_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-429"><a href="#STIXtoTypeDBMapper-429"><span class="linenos">429</span></a>
</span><span id="STIXtoTypeDBMapper-430"><a href="#STIXtoTypeDBMapper-430"><span class="linenos">430</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">composite</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-431"><a href="#STIXtoTypeDBMapper-431"><span class="linenos">431</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-432"><a href="#STIXtoTypeDBMapper-432"><span class="linenos">432</span></a>                <span class="sa">f</span><span class="s2">&quot;Composite type </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="STIXtoTypeDBMapper-433"><a href="#STIXtoTypeDBMapper-433"><span class="linenos">433</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-434"><a href="#STIXtoTypeDBMapper-434"><span class="linenos">434</span></a>
</span><span id="STIXtoTypeDBMapper-435"><a href="#STIXtoTypeDBMapper-435"><span class="linenos">435</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">composite</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_COMPOSITE_NAME</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-436"><a href="#STIXtoTypeDBMapper-436"><span class="linenos">436</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-437"><a href="#STIXtoTypeDBMapper-437"><span class="linenos">437</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-438"><a href="#STIXtoTypeDBMapper-438"><span class="linenos">438</span></a>                <span class="sa">f</span><span class="s2">&quot;No TypeDB name specified for composite </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper-439"><a href="#STIXtoTypeDBMapper-439"><span class="linenos">439</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-440"><a href="#STIXtoTypeDBMapper-440"><span class="linenos">440</span></a>
</span><span id="STIXtoTypeDBMapper-441"><a href="#STIXtoTypeDBMapper-441"><span class="linenos">441</span></a>        <span class="k">return</span> <span class="n">name</span>
</span><span id="STIXtoTypeDBMapper-442"><a href="#STIXtoTypeDBMapper-442"><span class="linenos">442</span></a>
</span><span id="STIXtoTypeDBMapper-443"><a href="#STIXtoTypeDBMapper-443"><span class="linenos">443</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-444"><a href="#STIXtoTypeDBMapper-444"><span class="linenos">444</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_composite_attribute_info</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-445"><a href="#STIXtoTypeDBMapper-445"><span class="linenos">445</span></a>        <span class="n">composite_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="STIXtoTypeDBMapper-446"><a href="#STIXtoTypeDBMapper-446"><span class="linenos">446</span></a>        <span class="n">stix_property</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="STIXtoTypeDBMapper-447"><a href="#STIXtoTypeDBMapper-447"><span class="linenos">447</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper-448"><a href="#STIXtoTypeDBMapper-448"><span class="linenos">448</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the TypeDB name of a specified attribute of a </span>
</span><span id="STIXtoTypeDBMapper-449"><a href="#STIXtoTypeDBMapper-449"><span class="linenos">449</span></a><span class="sd">        specified composite type.</span>
</span><span id="STIXtoTypeDBMapper-450"><a href="#STIXtoTypeDBMapper-450"><span class="linenos">450</span></a>
</span><span id="STIXtoTypeDBMapper-451"><a href="#STIXtoTypeDBMapper-451"><span class="linenos">451</span></a><span class="sd">        :param composite_type: The name of the composite type</span>
</span><span id="STIXtoTypeDBMapper-452"><a href="#STIXtoTypeDBMapper-452"><span class="linenos">452</span></a><span class="sd">        :type composite_type: str</span>
</span><span id="STIXtoTypeDBMapper-453"><a href="#STIXtoTypeDBMapper-453"><span class="linenos">453</span></a><span class="sd">        :param stix_property: The name of the STIX attribute</span>
</span><span id="STIXtoTypeDBMapper-454"><a href="#STIXtoTypeDBMapper-454"><span class="linenos">454</span></a><span class="sd">        :type stix_property: str</span>
</span><span id="STIXtoTypeDBMapper-455"><a href="#STIXtoTypeDBMapper-455"><span class="linenos">455</span></a>
</span><span id="STIXtoTypeDBMapper-456"><a href="#STIXtoTypeDBMapper-456"><span class="linenos">456</span></a><span class="sd">        :raises MappingException: If the composite type or attribute</span>
</span><span id="STIXtoTypeDBMapper-457"><a href="#STIXtoTypeDBMapper-457"><span class="linenos">457</span></a><span class="sd">            is not defined in the mapping</span>
</span><span id="STIXtoTypeDBMapper-458"><a href="#STIXtoTypeDBMapper-458"><span class="linenos">458</span></a>
</span><span id="STIXtoTypeDBMapper-459"><a href="#STIXtoTypeDBMapper-459"><span class="linenos">459</span></a><span class="sd">        :return: The TypeDB name and value type for the attribute</span>
</span><span id="STIXtoTypeDBMapper-460"><a href="#STIXtoTypeDBMapper-460"><span class="linenos">460</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="STIXtoTypeDBMapper-461"><a href="#STIXtoTypeDBMapper-461"><span class="linenos">461</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-462"><a href="#STIXtoTypeDBMapper-462"><span class="linenos">462</span></a>        <span class="n">composite</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span> \
</span><span id="STIXtoTypeDBMapper-463"><a href="#STIXtoTypeDBMapper-463"><span class="linenos">463</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">composite_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-464"><a href="#STIXtoTypeDBMapper-464"><span class="linenos">464</span></a>
</span><span id="STIXtoTypeDBMapper-465"><a href="#STIXtoTypeDBMapper-465"><span class="linenos">465</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">composite</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-466"><a href="#STIXtoTypeDBMapper-466"><span class="linenos">466</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-467"><a href="#STIXtoTypeDBMapper-467"><span class="linenos">467</span></a>                <span class="sa">f</span><span class="s2">&quot;Composite type </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="STIXtoTypeDBMapper-468"><a href="#STIXtoTypeDBMapper-468"><span class="linenos">468</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-469"><a href="#STIXtoTypeDBMapper-469"><span class="linenos">469</span></a>
</span><span id="STIXtoTypeDBMapper-470"><a href="#STIXtoTypeDBMapper-470"><span class="linenos">470</span></a>        <span class="n">typedb_attribute</span> <span class="o">=</span> <span class="n">composite</span> \
</span><span id="STIXtoTypeDBMapper-471"><a href="#STIXtoTypeDBMapper-471"><span class="linenos">471</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTES</span><span class="p">)</span> \
</span><span id="STIXtoTypeDBMapper-472"><a href="#STIXtoTypeDBMapper-472"><span class="linenos">472</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_property</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-473"><a href="#STIXtoTypeDBMapper-473"><span class="linenos">473</span></a>
</span><span id="STIXtoTypeDBMapper-474"><a href="#STIXtoTypeDBMapper-474"><span class="linenos">474</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">typedb_attribute</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-475"><a href="#STIXtoTypeDBMapper-475"><span class="linenos">475</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-476"><a href="#STIXtoTypeDBMapper-476"><span class="linenos">476</span></a>                <span class="sa">f</span><span class="s2">&quot;Attribute </span><span class="si">{</span><span class="n">stix_property</span><span class="si">}</span><span class="s2"> does not exist for composite type </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper-477"><a href="#STIXtoTypeDBMapper-477"><span class="linenos">477</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-478"><a href="#STIXtoTypeDBMapper-478"><span class="linenos">478</span></a>
</span><span id="STIXtoTypeDBMapper-479"><a href="#STIXtoTypeDBMapper-479"><span class="linenos">479</span></a>        <span class="n">attribute_name</span> <span class="o">=</span> <span class="n">typedb_attribute</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-480"><a href="#STIXtoTypeDBMapper-480"><span class="linenos">480</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_NAME</span>
</span><span id="STIXtoTypeDBMapper-481"><a href="#STIXtoTypeDBMapper-481"><span class="linenos">481</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-482"><a href="#STIXtoTypeDBMapper-482"><span class="linenos">482</span></a>        <span class="n">attribute_type</span> <span class="o">=</span> <span class="n">typedb_attribute</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-483"><a href="#STIXtoTypeDBMapper-483"><span class="linenos">483</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_VALUE_TYPE</span>
</span><span id="STIXtoTypeDBMapper-484"><a href="#STIXtoTypeDBMapper-484"><span class="linenos">484</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-485"><a href="#STIXtoTypeDBMapper-485"><span class="linenos">485</span></a>
</span><span id="STIXtoTypeDBMapper-486"><a href="#STIXtoTypeDBMapper-486"><span class="linenos">486</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attribute_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">attribute_type</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-487"><a href="#STIXtoTypeDBMapper-487"><span class="linenos">487</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-488"><a href="#STIXtoTypeDBMapper-488"><span class="linenos">488</span></a>                <span class="sa">f</span><span class="s2">&quot;Attribute name or value type for attribute </span><span class="si">{</span><span class="n">stix_property</span><span class="si">}</span><span class="s2"> of composite &quot;</span>
</span><span id="STIXtoTypeDBMapper-489"><a href="#STIXtoTypeDBMapper-489"><span class="linenos">489</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2"> not specified&quot;</span>
</span><span id="STIXtoTypeDBMapper-490"><a href="#STIXtoTypeDBMapper-490"><span class="linenos">490</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-491"><a href="#STIXtoTypeDBMapper-491"><span class="linenos">491</span></a>        <span class="k">return</span> <span class="n">attribute_name</span><span class="p">,</span> <span class="n">attribute_type</span>
</span><span id="STIXtoTypeDBMapper-492"><a href="#STIXtoTypeDBMapper-492"><span class="linenos">492</span></a>
</span><span id="STIXtoTypeDBMapper-493"><a href="#STIXtoTypeDBMapper-493"><span class="linenos">493</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-494"><a href="#STIXtoTypeDBMapper-494"><span class="linenos">494</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_composite_type_relation</span><span class="p">(</span><span class="n">composite_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-495"><a href="#STIXtoTypeDBMapper-495"><span class="linenos">495</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of the helper relation for the composite </span>
</span><span id="STIXtoTypeDBMapper-496"><a href="#STIXtoTypeDBMapper-496"><span class="linenos">496</span></a><span class="sd">        type.</span>
</span><span id="STIXtoTypeDBMapper-497"><a href="#STIXtoTypeDBMapper-497"><span class="linenos">497</span></a>
</span><span id="STIXtoTypeDBMapper-498"><a href="#STIXtoTypeDBMapper-498"><span class="linenos">498</span></a><span class="sd">        :param composite_type: The name of the composite type</span>
</span><span id="STIXtoTypeDBMapper-499"><a href="#STIXtoTypeDBMapper-499"><span class="linenos">499</span></a><span class="sd">        :type composite_type: str</span>
</span><span id="STIXtoTypeDBMapper-500"><a href="#STIXtoTypeDBMapper-500"><span class="linenos">500</span></a>
</span><span id="STIXtoTypeDBMapper-501"><a href="#STIXtoTypeDBMapper-501"><span class="linenos">501</span></a><span class="sd">        :raises MappingException: If the composite type does not exist</span>
</span><span id="STIXtoTypeDBMapper-502"><a href="#STIXtoTypeDBMapper-502"><span class="linenos">502</span></a><span class="sd">            or no relation is specified</span>
</span><span id="STIXtoTypeDBMapper-503"><a href="#STIXtoTypeDBMapper-503"><span class="linenos">503</span></a>
</span><span id="STIXtoTypeDBMapper-504"><a href="#STIXtoTypeDBMapper-504"><span class="linenos">504</span></a><span class="sd">        :return: The name of the helper relation of the composite type</span>
</span><span id="STIXtoTypeDBMapper-505"><a href="#STIXtoTypeDBMapper-505"><span class="linenos">505</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper-506"><a href="#STIXtoTypeDBMapper-506"><span class="linenos">506</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-507"><a href="#STIXtoTypeDBMapper-507"><span class="linenos">507</span></a>        <span class="n">composite</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span> \
</span><span id="STIXtoTypeDBMapper-508"><a href="#STIXtoTypeDBMapper-508"><span class="linenos">508</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">composite_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-509"><a href="#STIXtoTypeDBMapper-509"><span class="linenos">509</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">composite</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-510"><a href="#STIXtoTypeDBMapper-510"><span class="linenos">510</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-511"><a href="#STIXtoTypeDBMapper-511"><span class="linenos">511</span></a>                <span class="sa">f</span><span class="s2">&quot;Composite type </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="STIXtoTypeDBMapper-512"><a href="#STIXtoTypeDBMapper-512"><span class="linenos">512</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-513"><a href="#STIXtoTypeDBMapper-513"><span class="linenos">513</span></a>
</span><span id="STIXtoTypeDBMapper-514"><a href="#STIXtoTypeDBMapper-514"><span class="linenos">514</span></a>        <span class="n">relation</span> <span class="o">=</span> <span class="n">composite</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_COMPOSITE_RELATION</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-515"><a href="#STIXtoTypeDBMapper-515"><span class="linenos">515</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-516"><a href="#STIXtoTypeDBMapper-516"><span class="linenos">516</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-517"><a href="#STIXtoTypeDBMapper-517"><span class="linenos">517</span></a>                <span class="sa">f</span><span class="s2">&quot;No relation specified for composite </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper-518"><a href="#STIXtoTypeDBMapper-518"><span class="linenos">518</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-519"><a href="#STIXtoTypeDBMapper-519"><span class="linenos">519</span></a>
</span><span id="STIXtoTypeDBMapper-520"><a href="#STIXtoTypeDBMapper-520"><span class="linenos">520</span></a>        <span class="n">relation_name</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">RELATION_NAME</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-521"><a href="#STIXtoTypeDBMapper-521"><span class="linenos">521</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation_name</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-522"><a href="#STIXtoTypeDBMapper-522"><span class="linenos">522</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-523"><a href="#STIXtoTypeDBMapper-523"><span class="linenos">523</span></a>                <span class="sa">f</span><span class="s2">&quot;No relation name specified for composite </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper-524"><a href="#STIXtoTypeDBMapper-524"><span class="linenos">524</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-525"><a href="#STIXtoTypeDBMapper-525"><span class="linenos">525</span></a>
</span><span id="STIXtoTypeDBMapper-526"><a href="#STIXtoTypeDBMapper-526"><span class="linenos">526</span></a>        <span class="k">return</span> <span class="n">relation_name</span>
</span><span id="STIXtoTypeDBMapper-527"><a href="#STIXtoTypeDBMapper-527"><span class="linenos">527</span></a>
</span><span id="STIXtoTypeDBMapper-528"><a href="#STIXtoTypeDBMapper-528"><span class="linenos">528</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-529"><a href="#STIXtoTypeDBMapper-529"><span class="linenos">529</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_composite_relation_roles</span><span class="p">(</span><span class="n">composite_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper-530"><a href="#STIXtoTypeDBMapper-530"><span class="linenos">530</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the names of the roles of the helper relation of a </span>
</span><span id="STIXtoTypeDBMapper-531"><a href="#STIXtoTypeDBMapper-531"><span class="linenos">531</span></a><span class="sd">        composite type, i.e. the name of the object&#39;s role and the name</span>
</span><span id="STIXtoTypeDBMapper-532"><a href="#STIXtoTypeDBMapper-532"><span class="linenos">532</span></a><span class="sd">        of the values&#39; role.</span>
</span><span id="STIXtoTypeDBMapper-533"><a href="#STIXtoTypeDBMapper-533"><span class="linenos">533</span></a>
</span><span id="STIXtoTypeDBMapper-534"><a href="#STIXtoTypeDBMapper-534"><span class="linenos">534</span></a><span class="sd">        :param composite_type: The name of the composite value type </span>
</span><span id="STIXtoTypeDBMapper-535"><a href="#STIXtoTypeDBMapper-535"><span class="linenos">535</span></a><span class="sd">        :type composite_type: str</span>
</span><span id="STIXtoTypeDBMapper-536"><a href="#STIXtoTypeDBMapper-536"><span class="linenos">536</span></a>
</span><span id="STIXtoTypeDBMapper-537"><a href="#STIXtoTypeDBMapper-537"><span class="linenos">537</span></a><span class="sd">        :raises MappingException: If the composite type does not exist</span>
</span><span id="STIXtoTypeDBMapper-538"><a href="#STIXtoTypeDBMapper-538"><span class="linenos">538</span></a><span class="sd">            or its definition is incomplete</span>
</span><span id="STIXtoTypeDBMapper-539"><a href="#STIXtoTypeDBMapper-539"><span class="linenos">539</span></a>
</span><span id="STIXtoTypeDBMapper-540"><a href="#STIXtoTypeDBMapper-540"><span class="linenos">540</span></a><span class="sd">        :return: The name of the object&#39;s and values&#39; role</span>
</span><span id="STIXtoTypeDBMapper-541"><a href="#STIXtoTypeDBMapper-541"><span class="linenos">541</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="STIXtoTypeDBMapper-542"><a href="#STIXtoTypeDBMapper-542"><span class="linenos">542</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-543"><a href="#STIXtoTypeDBMapper-543"><span class="linenos">543</span></a>        <span class="n">composite</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span> \
</span><span id="STIXtoTypeDBMapper-544"><a href="#STIXtoTypeDBMapper-544"><span class="linenos">544</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">composite_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-545"><a href="#STIXtoTypeDBMapper-545"><span class="linenos">545</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">composite</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-546"><a href="#STIXtoTypeDBMapper-546"><span class="linenos">546</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-547"><a href="#STIXtoTypeDBMapper-547"><span class="linenos">547</span></a>                <span class="sa">f</span><span class="s2">&quot;Composite type </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="STIXtoTypeDBMapper-548"><a href="#STIXtoTypeDBMapper-548"><span class="linenos">548</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-549"><a href="#STIXtoTypeDBMapper-549"><span class="linenos">549</span></a>
</span><span id="STIXtoTypeDBMapper-550"><a href="#STIXtoTypeDBMapper-550"><span class="linenos">550</span></a>        <span class="n">relation</span> <span class="o">=</span> <span class="n">composite</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_COMPOSITE_RELATION</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-551"><a href="#STIXtoTypeDBMapper-551"><span class="linenos">551</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-552"><a href="#STIXtoTypeDBMapper-552"><span class="linenos">552</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-553"><a href="#STIXtoTypeDBMapper-553"><span class="linenos">553</span></a>                <span class="sa">f</span><span class="s2">&quot;No relation specified for composite </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper-554"><a href="#STIXtoTypeDBMapper-554"><span class="linenos">554</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-555"><a href="#STIXtoTypeDBMapper-555"><span class="linenos">555</span></a>
</span><span id="STIXtoTypeDBMapper-556"><a href="#STIXtoTypeDBMapper-556"><span class="linenos">556</span></a>        <span class="n">object_role</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-557"><a href="#STIXtoTypeDBMapper-557"><span class="linenos">557</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_COMPOSITE_RELATION_OBJECT_ROLE</span>
</span><span id="STIXtoTypeDBMapper-558"><a href="#STIXtoTypeDBMapper-558"><span class="linenos">558</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-559"><a href="#STIXtoTypeDBMapper-559"><span class="linenos">559</span></a>        <span class="n">value_role</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-560"><a href="#STIXtoTypeDBMapper-560"><span class="linenos">560</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_COMPOSITE_RELATION_VALUE_ROLE</span>
</span><span id="STIXtoTypeDBMapper-561"><a href="#STIXtoTypeDBMapper-561"><span class="linenos">561</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-562"><a href="#STIXtoTypeDBMapper-562"><span class="linenos">562</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">object_role</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">value_role</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-563"><a href="#STIXtoTypeDBMapper-563"><span class="linenos">563</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-564"><a href="#STIXtoTypeDBMapper-564"><span class="linenos">564</span></a>                <span class="sa">f</span><span class="s2">&quot;No object or value role defined for helper relation of &quot;</span>
</span><span id="STIXtoTypeDBMapper-565"><a href="#STIXtoTypeDBMapper-565"><span class="linenos">565</span></a>                <span class="sa">f</span><span class="s2">&quot;composite type </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper-566"><a href="#STIXtoTypeDBMapper-566"><span class="linenos">566</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-567"><a href="#STIXtoTypeDBMapper-567"><span class="linenos">567</span></a>
</span><span id="STIXtoTypeDBMapper-568"><a href="#STIXtoTypeDBMapper-568"><span class="linenos">568</span></a>        <span class="k">return</span> <span class="n">object_role</span><span class="p">,</span> <span class="n">value_role</span>
</span><span id="STIXtoTypeDBMapper-569"><a href="#STIXtoTypeDBMapper-569"><span class="linenos">569</span></a>
</span><span id="STIXtoTypeDBMapper-570"><a href="#STIXtoTypeDBMapper-570"><span class="linenos">570</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-571"><a href="#STIXtoTypeDBMapper-571"><span class="linenos">571</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sro_role</span><span class="p">(</span><span class="n">relation_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">attribute</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-572"><a href="#STIXtoTypeDBMapper-572"><span class="linenos">572</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of the role for an SRO attribute.</span>
</span><span id="STIXtoTypeDBMapper-573"><a href="#STIXtoTypeDBMapper-573"><span class="linenos">573</span></a>
</span><span id="STIXtoTypeDBMapper-574"><a href="#STIXtoTypeDBMapper-574"><span class="linenos">574</span></a><span class="sd">        :param relation_name: The name of the SRO</span>
</span><span id="STIXtoTypeDBMapper-575"><a href="#STIXtoTypeDBMapper-575"><span class="linenos">575</span></a><span class="sd">        :type relation_name: str</span>
</span><span id="STIXtoTypeDBMapper-576"><a href="#STIXtoTypeDBMapper-576"><span class="linenos">576</span></a><span class="sd">        :param role: The name of the attribute </span>
</span><span id="STIXtoTypeDBMapper-577"><a href="#STIXtoTypeDBMapper-577"><span class="linenos">577</span></a><span class="sd">        :type role: str</span>
</span><span id="STIXtoTypeDBMapper-578"><a href="#STIXtoTypeDBMapper-578"><span class="linenos">578</span></a>
</span><span id="STIXtoTypeDBMapper-579"><a href="#STIXtoTypeDBMapper-579"><span class="linenos">579</span></a><span class="sd">        :raises MappingException: If the relation is not defined or the </span>
</span><span id="STIXtoTypeDBMapper-580"><a href="#STIXtoTypeDBMapper-580"><span class="linenos">580</span></a><span class="sd">            attribute is not implemented as a roleplayer</span>
</span><span id="STIXtoTypeDBMapper-581"><a href="#STIXtoTypeDBMapper-581"><span class="linenos">581</span></a>
</span><span id="STIXtoTypeDBMapper-582"><a href="#STIXtoTypeDBMapper-582"><span class="linenos">582</span></a><span class="sd">        :return: The name of the role and TypeDB object type that </span>
</span><span id="STIXtoTypeDBMapper-583"><a href="#STIXtoTypeDBMapper-583"><span class="linenos">583</span></a><span class="sd">            plays the role</span>
</span><span id="STIXtoTypeDBMapper-584"><a href="#STIXtoTypeDBMapper-584"><span class="linenos">584</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper-585"><a href="#STIXtoTypeDBMapper-585"><span class="linenos">585</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-586"><a href="#STIXtoTypeDBMapper-586"><span class="linenos">586</span></a>        <span class="n">relation</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">sros_role_info</span> \
</span><span id="STIXtoTypeDBMapper-587"><a href="#STIXtoTypeDBMapper-587"><span class="linenos">587</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">relation_name</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-588"><a href="#STIXtoTypeDBMapper-588"><span class="linenos">588</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-589"><a href="#STIXtoTypeDBMapper-589"><span class="linenos">589</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-590"><a href="#STIXtoTypeDBMapper-590"><span class="linenos">590</span></a>                <span class="sa">f</span><span class="s2">&quot;Relation </span><span class="si">{</span><span class="n">relation_name</span><span class="si">}</span><span class="s2"> is not defined&quot;</span>
</span><span id="STIXtoTypeDBMapper-591"><a href="#STIXtoTypeDBMapper-591"><span class="linenos">591</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-592"><a href="#STIXtoTypeDBMapper-592"><span class="linenos">592</span></a>
</span><span id="STIXtoTypeDBMapper-593"><a href="#STIXtoTypeDBMapper-593"><span class="linenos">593</span></a>        <span class="n">role_name</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-594"><a href="#STIXtoTypeDBMapper-594"><span class="linenos">594</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">role_name</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-595"><a href="#STIXtoTypeDBMapper-595"><span class="linenos">595</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-596"><a href="#STIXtoTypeDBMapper-596"><span class="linenos">596</span></a>                <span class="sa">f</span><span class="s2">&quot;Role information for role </span><span class="si">{</span><span class="n">attribute</span><span class="si">}</span><span class="s2"> missing for relation </span><span class="si">{</span><span class="n">relation_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper-597"><a href="#STIXtoTypeDBMapper-597"><span class="linenos">597</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-598"><a href="#STIXtoTypeDBMapper-598"><span class="linenos">598</span></a>
</span><span id="STIXtoTypeDBMapper-599"><a href="#STIXtoTypeDBMapper-599"><span class="linenos">599</span></a>        <span class="k">return</span> <span class="n">role_name</span>
</span><span id="STIXtoTypeDBMapper-600"><a href="#STIXtoTypeDBMapper-600"><span class="linenos">600</span></a>
</span><span id="STIXtoTypeDBMapper-601"><a href="#STIXtoTypeDBMapper-601"><span class="linenos">601</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-602"><a href="#STIXtoTypeDBMapper-602"><span class="linenos">602</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_embedded_relation_roles</span><span class="p">(</span><span class="n">attribute_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper-603"><a href="#STIXtoTypeDBMapper-603"><span class="linenos">603</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the object&#39;s and value&#39;s role using the name of the</span>
</span><span id="STIXtoTypeDBMapper-604"><a href="#STIXtoTypeDBMapper-604"><span class="linenos">604</span></a><span class="sd">        attribute specified for the TypeDB translation of a STIX </span>
</span><span id="STIXtoTypeDBMapper-605"><a href="#STIXtoTypeDBMapper-605"><span class="linenos">605</span></a><span class="sd">        property.</span>
</span><span id="STIXtoTypeDBMapper-606"><a href="#STIXtoTypeDBMapper-606"><span class="linenos">606</span></a>
</span><span id="STIXtoTypeDBMapper-607"><a href="#STIXtoTypeDBMapper-607"><span class="linenos">607</span></a><span class="sd">        :param attribute_name: The specified attribute name for the</span>
</span><span id="STIXtoTypeDBMapper-608"><a href="#STIXtoTypeDBMapper-608"><span class="linenos">608</span></a><span class="sd">            TypeDB translation</span>
</span><span id="STIXtoTypeDBMapper-609"><a href="#STIXtoTypeDBMapper-609"><span class="linenos">609</span></a><span class="sd">        :type attribute_name: str</span>
</span><span id="STIXtoTypeDBMapper-610"><a href="#STIXtoTypeDBMapper-610"><span class="linenos">610</span></a>
</span><span id="STIXtoTypeDBMapper-611"><a href="#STIXtoTypeDBMapper-611"><span class="linenos">611</span></a><span class="sd">        :raises MappingException: If the attribute name does not </span>
</span><span id="STIXtoTypeDBMapper-612"><a href="#STIXtoTypeDBMapper-612"><span class="linenos">612</span></a><span class="sd">            fulfill the required format</span>
</span><span id="STIXtoTypeDBMapper-613"><a href="#STIXtoTypeDBMapper-613"><span class="linenos">613</span></a>
</span><span id="STIXtoTypeDBMapper-614"><a href="#STIXtoTypeDBMapper-614"><span class="linenos">614</span></a><span class="sd">        :return: The name of the object&#39;s and value&#39;s role</span>
</span><span id="STIXtoTypeDBMapper-615"><a href="#STIXtoTypeDBMapper-615"><span class="linenos">615</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="STIXtoTypeDBMapper-616"><a href="#STIXtoTypeDBMapper-616"><span class="linenos">616</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-617"><a href="#STIXtoTypeDBMapper-617"><span class="linenos">617</span></a>        <span class="n">roles</span> <span class="o">=</span> <span class="n">attribute_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ROLE_SEPARATION</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-618"><a href="#STIXtoTypeDBMapper-618"><span class="linenos">618</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">roles</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-619"><a href="#STIXtoTypeDBMapper-619"><span class="linenos">619</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-620"><a href="#STIXtoTypeDBMapper-620"><span class="linenos">620</span></a>                <span class="sa">f</span><span class="s2">&quot;Roles are not properly specified: </span><span class="si">{</span><span class="n">attribute_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper-621"><a href="#STIXtoTypeDBMapper-621"><span class="linenos">621</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-622"><a href="#STIXtoTypeDBMapper-622"><span class="linenos">622</span></a>
</span><span id="STIXtoTypeDBMapper-623"><a href="#STIXtoTypeDBMapper-623"><span class="linenos">623</span></a>        <span class="k">return</span> <span class="n">roles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">roles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="STIXtoTypeDBMapper-624"><a href="#STIXtoTypeDBMapper-624"><span class="linenos">624</span></a>
</span><span id="STIXtoTypeDBMapper-625"><a href="#STIXtoTypeDBMapper-625"><span class="linenos">625</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-626"><a href="#STIXtoTypeDBMapper-626"><span class="linenos">626</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_key_value_pair_key_translation</span><span class="p">(</span><span class="n">pair_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-627"><a href="#STIXtoTypeDBMapper-627"><span class="linenos">627</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the entity type of the key. Returns None if the key</span>
</span><span id="STIXtoTypeDBMapper-628"><a href="#STIXtoTypeDBMapper-628"><span class="linenos">628</span></a><span class="sd">        is not defined.</span>
</span><span id="STIXtoTypeDBMapper-629"><a href="#STIXtoTypeDBMapper-629"><span class="linenos">629</span></a>
</span><span id="STIXtoTypeDBMapper-630"><a href="#STIXtoTypeDBMapper-630"><span class="linenos">630</span></a><span class="sd">        :param pair_type: The name of the Pair Type</span>
</span><span id="STIXtoTypeDBMapper-631"><a href="#STIXtoTypeDBMapper-631"><span class="linenos">631</span></a><span class="sd">        :type pair_type: str</span>
</span><span id="STIXtoTypeDBMapper-632"><a href="#STIXtoTypeDBMapper-632"><span class="linenos">632</span></a><span class="sd">        :param key: The name of the key</span>
</span><span id="STIXtoTypeDBMapper-633"><a href="#STIXtoTypeDBMapper-633"><span class="linenos">633</span></a><span class="sd">        :type key: str</span>
</span><span id="STIXtoTypeDBMapper-634"><a href="#STIXtoTypeDBMapper-634"><span class="linenos">634</span></a>
</span><span id="STIXtoTypeDBMapper-635"><a href="#STIXtoTypeDBMapper-635"><span class="linenos">635</span></a><span class="sd">        :raises MappingException: If the Mapping is invalid or </span>
</span><span id="STIXtoTypeDBMapper-636"><a href="#STIXtoTypeDBMapper-636"><span class="linenos">636</span></a><span class="sd">            incomplete or the pair type does not exist</span>
</span><span id="STIXtoTypeDBMapper-637"><a href="#STIXtoTypeDBMapper-637"><span class="linenos">637</span></a>
</span><span id="STIXtoTypeDBMapper-638"><a href="#STIXtoTypeDBMapper-638"><span class="linenos">638</span></a><span class="sd">        :return: The name of the TypeDB Entity</span>
</span><span id="STIXtoTypeDBMapper-639"><a href="#STIXtoTypeDBMapper-639"><span class="linenos">639</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper-640"><a href="#STIXtoTypeDBMapper-640"><span class="linenos">640</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-641"><a href="#STIXtoTypeDBMapper-641"><span class="linenos">641</span></a>        <span class="n">pair_type</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span> \
</span><span id="STIXtoTypeDBMapper-642"><a href="#STIXtoTypeDBMapper-642"><span class="linenos">642</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pair_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-643"><a href="#STIXtoTypeDBMapper-643"><span class="linenos">643</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">pair_type</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-644"><a href="#STIXtoTypeDBMapper-644"><span class="linenos">644</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-645"><a href="#STIXtoTypeDBMapper-645"><span class="linenos">645</span></a>                <span class="sa">f</span><span class="s2">&quot;Pair type </span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="STIXtoTypeDBMapper-646"><a href="#STIXtoTypeDBMapper-646"><span class="linenos">646</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-647"><a href="#STIXtoTypeDBMapper-647"><span class="linenos">647</span></a>
</span><span id="STIXtoTypeDBMapper-648"><a href="#STIXtoTypeDBMapper-648"><span class="linenos">648</span></a>        <span class="n">keys</span> <span class="o">=</span> <span class="n">pair_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIRS_KEYS</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-649"><a href="#STIXtoTypeDBMapper-649"><span class="linenos">649</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">keys</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-650"><a href="#STIXtoTypeDBMapper-650"><span class="linenos">650</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-651"><a href="#STIXtoTypeDBMapper-651"><span class="linenos">651</span></a>                <span class="sa">f</span><span class="s2">&quot;No keys defined for pair type </span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper-652"><a href="#STIXtoTypeDBMapper-652"><span class="linenos">652</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-653"><a href="#STIXtoTypeDBMapper-653"><span class="linenos">653</span></a>        <span class="n">key</span> <span class="o">=</span> <span class="n">keys</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-654"><a href="#STIXtoTypeDBMapper-654"><span class="linenos">654</span></a>
</span><span id="STIXtoTypeDBMapper-655"><a href="#STIXtoTypeDBMapper-655"><span class="linenos">655</span></a>        <span class="k">return</span> <span class="n">key</span>
</span><span id="STIXtoTypeDBMapper-656"><a href="#STIXtoTypeDBMapper-656"><span class="linenos">656</span></a>
</span><span id="STIXtoTypeDBMapper-657"><a href="#STIXtoTypeDBMapper-657"><span class="linenos">657</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-658"><a href="#STIXtoTypeDBMapper-658"><span class="linenos">658</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_key_value_pair_custom</span><span class="p">(</span><span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper-659"><a href="#STIXtoTypeDBMapper-659"><span class="linenos">659</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of the custom entity and the attribute </span>
</span><span id="STIXtoTypeDBMapper-660"><a href="#STIXtoTypeDBMapper-660"><span class="linenos">660</span></a><span class="sd">        name for the key.</span>
</span><span id="STIXtoTypeDBMapper-661"><a href="#STIXtoTypeDBMapper-661"><span class="linenos">661</span></a>
</span><span id="STIXtoTypeDBMapper-662"><a href="#STIXtoTypeDBMapper-662"><span class="linenos">662</span></a><span class="sd">        :param pair_type: The name of the pair type</span>
</span><span id="STIXtoTypeDBMapper-663"><a href="#STIXtoTypeDBMapper-663"><span class="linenos">663</span></a><span class="sd">        :type pair_type: str</span>
</span><span id="STIXtoTypeDBMapper-664"><a href="#STIXtoTypeDBMapper-664"><span class="linenos">664</span></a>
</span><span id="STIXtoTypeDBMapper-665"><a href="#STIXtoTypeDBMapper-665"><span class="linenos">665</span></a><span class="sd">        :raises MappingException: If the Mapping is invalid or incomplete</span>
</span><span id="STIXtoTypeDBMapper-666"><a href="#STIXtoTypeDBMapper-666"><span class="linenos">666</span></a><span class="sd">            or the pair type does not exist</span>
</span><span id="STIXtoTypeDBMapper-667"><a href="#STIXtoTypeDBMapper-667"><span class="linenos">667</span></a>
</span><span id="STIXtoTypeDBMapper-668"><a href="#STIXtoTypeDBMapper-668"><span class="linenos">668</span></a><span class="sd">        :return: The name of the entity and key attribute</span>
</span><span id="STIXtoTypeDBMapper-669"><a href="#STIXtoTypeDBMapper-669"><span class="linenos">669</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="STIXtoTypeDBMapper-670"><a href="#STIXtoTypeDBMapper-670"><span class="linenos">670</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-671"><a href="#STIXtoTypeDBMapper-671"><span class="linenos">671</span></a>        <span class="n">pair_type</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span> \
</span><span id="STIXtoTypeDBMapper-672"><a href="#STIXtoTypeDBMapper-672"><span class="linenos">672</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-673"><a href="#STIXtoTypeDBMapper-673"><span class="linenos">673</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">pair_type</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-674"><a href="#STIXtoTypeDBMapper-674"><span class="linenos">674</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-675"><a href="#STIXtoTypeDBMapper-675"><span class="linenos">675</span></a>                <span class="sa">f</span><span class="s2">&quot;A mapping for the key-value type &#39;</span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2">&#39; is not defined&quot;</span>
</span><span id="STIXtoTypeDBMapper-676"><a href="#STIXtoTypeDBMapper-676"><span class="linenos">676</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-677"><a href="#STIXtoTypeDBMapper-677"><span class="linenos">677</span></a>
</span><span id="STIXtoTypeDBMapper-678"><a href="#STIXtoTypeDBMapper-678"><span class="linenos">678</span></a>        <span class="n">mapping</span> <span class="o">=</span> <span class="n">pair_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIR_CUSTOM</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-679"><a href="#STIXtoTypeDBMapper-679"><span class="linenos">679</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">mapping</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-680"><a href="#STIXtoTypeDBMapper-680"><span class="linenos">680</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-681"><a href="#STIXtoTypeDBMapper-681"><span class="linenos">681</span></a>                <span class="sa">f</span><span class="s2">&quot;Custom keys are not supported in the STIX key-value type &#39;</span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
</span><span id="STIXtoTypeDBMapper-682"><a href="#STIXtoTypeDBMapper-682"><span class="linenos">682</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Valid keys: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">pair_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIRS_KEYS</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="STIXtoTypeDBMapper-683"><a href="#STIXtoTypeDBMapper-683"><span class="linenos">683</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-684"><a href="#STIXtoTypeDBMapper-684"><span class="linenos">684</span></a>
</span><span id="STIXtoTypeDBMapper-685"><a href="#STIXtoTypeDBMapper-685"><span class="linenos">685</span></a>        <span class="n">entity</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIR_CUSTOM_ENTITY</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-686"><a href="#STIXtoTypeDBMapper-686"><span class="linenos">686</span></a>        <span class="n">attribute</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIR_CUSTOM_ATTRIBUTE</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-687"><a href="#STIXtoTypeDBMapper-687"><span class="linenos">687</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">entity</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">attribute</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-688"><a href="#STIXtoTypeDBMapper-688"><span class="linenos">688</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-689"><a href="#STIXtoTypeDBMapper-689"><span class="linenos">689</span></a>                <span class="sa">f</span><span class="s2">&quot;No entity type or attribute name specified for custom keys &quot;</span>
</span><span id="STIXtoTypeDBMapper-690"><a href="#STIXtoTypeDBMapper-690"><span class="linenos">690</span></a>                <span class="sa">f</span><span class="s2">&quot;in key-value type &#39;</span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-691"><a href="#STIXtoTypeDBMapper-691"><span class="linenos">691</span></a>
</span><span id="STIXtoTypeDBMapper-692"><a href="#STIXtoTypeDBMapper-692"><span class="linenos">692</span></a>        <span class="k">return</span> <span class="n">entity</span><span class="p">,</span> <span class="n">attribute</span>
</span><span id="STIXtoTypeDBMapper-693"><a href="#STIXtoTypeDBMapper-693"><span class="linenos">693</span></a>
</span><span id="STIXtoTypeDBMapper-694"><a href="#STIXtoTypeDBMapper-694"><span class="linenos">694</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-695"><a href="#STIXtoTypeDBMapper-695"><span class="linenos">695</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_pairs_value_and_type</span><span class="p">(</span><span class="n">pair_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper-696"><a href="#STIXtoTypeDBMapper-696"><span class="linenos">696</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the attribute name and value type of the pair type.</span>
</span><span id="STIXtoTypeDBMapper-697"><a href="#STIXtoTypeDBMapper-697"><span class="linenos">697</span></a>
</span><span id="STIXtoTypeDBMapper-698"><a href="#STIXtoTypeDBMapper-698"><span class="linenos">698</span></a><span class="sd">        :param pair_type: The name of the pair type</span>
</span><span id="STIXtoTypeDBMapper-699"><a href="#STIXtoTypeDBMapper-699"><span class="linenos">699</span></a><span class="sd">        :type pair_type: str</span>
</span><span id="STIXtoTypeDBMapper-700"><a href="#STIXtoTypeDBMapper-700"><span class="linenos">700</span></a>
</span><span id="STIXtoTypeDBMapper-701"><a href="#STIXtoTypeDBMapper-701"><span class="linenos">701</span></a><span class="sd">        :raises MappingException: If the Mapping is invalid or incomplete</span>
</span><span id="STIXtoTypeDBMapper-702"><a href="#STIXtoTypeDBMapper-702"><span class="linenos">702</span></a><span class="sd">            or the pair type does not exist</span>
</span><span id="STIXtoTypeDBMapper-703"><a href="#STIXtoTypeDBMapper-703"><span class="linenos">703</span></a>
</span><span id="STIXtoTypeDBMapper-704"><a href="#STIXtoTypeDBMapper-704"><span class="linenos">704</span></a><span class="sd">        :return: The attribute name and value type for the values</span>
</span><span id="STIXtoTypeDBMapper-705"><a href="#STIXtoTypeDBMapper-705"><span class="linenos">705</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="STIXtoTypeDBMapper-706"><a href="#STIXtoTypeDBMapper-706"><span class="linenos">706</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-707"><a href="#STIXtoTypeDBMapper-707"><span class="linenos">707</span></a>        <span class="n">pair_type</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span> \
</span><span id="STIXtoTypeDBMapper-708"><a href="#STIXtoTypeDBMapper-708"><span class="linenos">708</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pair_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-709"><a href="#STIXtoTypeDBMapper-709"><span class="linenos">709</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">pair_type</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-710"><a href="#STIXtoTypeDBMapper-710"><span class="linenos">710</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-711"><a href="#STIXtoTypeDBMapper-711"><span class="linenos">711</span></a>                <span class="sa">f</span><span class="s2">&quot;Pair Type </span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="STIXtoTypeDBMapper-712"><a href="#STIXtoTypeDBMapper-712"><span class="linenos">712</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-713"><a href="#STIXtoTypeDBMapper-713"><span class="linenos">713</span></a>
</span><span id="STIXtoTypeDBMapper-714"><a href="#STIXtoTypeDBMapper-714"><span class="linenos">714</span></a>        <span class="n">attribute_name</span> <span class="o">=</span> <span class="n">pair_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIRS_ATTRIBUTE_NAME</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-715"><a href="#STIXtoTypeDBMapper-715"><span class="linenos">715</span></a>        <span class="n">value_type</span> <span class="o">=</span> <span class="n">pair_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIRS_VALUE_TYPE</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-716"><a href="#STIXtoTypeDBMapper-716"><span class="linenos">716</span></a>
</span><span id="STIXtoTypeDBMapper-717"><a href="#STIXtoTypeDBMapper-717"><span class="linenos">717</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attribute_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">value_type</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-718"><a href="#STIXtoTypeDBMapper-718"><span class="linenos">718</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-719"><a href="#STIXtoTypeDBMapper-719"><span class="linenos">719</span></a>                <span class="sa">f</span><span class="s2">&quot;Attribute name or value type not specified for pair type </span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper-720"><a href="#STIXtoTypeDBMapper-720"><span class="linenos">720</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-721"><a href="#STIXtoTypeDBMapper-721"><span class="linenos">721</span></a>
</span><span id="STIXtoTypeDBMapper-722"><a href="#STIXtoTypeDBMapper-722"><span class="linenos">722</span></a>        <span class="k">return</span> <span class="n">attribute_name</span><span class="p">,</span> <span class="n">value_type</span>
</span><span id="STIXtoTypeDBMapper-723"><a href="#STIXtoTypeDBMapper-723"><span class="linenos">723</span></a>
</span><span id="STIXtoTypeDBMapper-724"><a href="#STIXtoTypeDBMapper-724"><span class="linenos">724</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-725"><a href="#STIXtoTypeDBMapper-725"><span class="linenos">725</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_pair_relation</span><span class="p">(</span><span class="n">pair_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper-726"><a href="#STIXtoTypeDBMapper-726"><span class="linenos">726</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the relation name of the helper relation for the </span>
</span><span id="STIXtoTypeDBMapper-727"><a href="#STIXtoTypeDBMapper-727"><span class="linenos">727</span></a><span class="sd">        pair type and the roles for the object and pair item.</span>
</span><span id="STIXtoTypeDBMapper-728"><a href="#STIXtoTypeDBMapper-728"><span class="linenos">728</span></a>
</span><span id="STIXtoTypeDBMapper-729"><a href="#STIXtoTypeDBMapper-729"><span class="linenos">729</span></a><span class="sd">        :param pair_type: The name of the pair type</span>
</span><span id="STIXtoTypeDBMapper-730"><a href="#STIXtoTypeDBMapper-730"><span class="linenos">730</span></a><span class="sd">        :type pair_type: str</span>
</span><span id="STIXtoTypeDBMapper-731"><a href="#STIXtoTypeDBMapper-731"><span class="linenos">731</span></a>
</span><span id="STIXtoTypeDBMapper-732"><a href="#STIXtoTypeDBMapper-732"><span class="linenos">732</span></a><span class="sd">        :raises MappingException: If the pair type does not exist or </span>
</span><span id="STIXtoTypeDBMapper-733"><a href="#STIXtoTypeDBMapper-733"><span class="linenos">733</span></a><span class="sd">            the mapping is invalid/ incomplete</span>
</span><span id="STIXtoTypeDBMapper-734"><a href="#STIXtoTypeDBMapper-734"><span class="linenos">734</span></a>
</span><span id="STIXtoTypeDBMapper-735"><a href="#STIXtoTypeDBMapper-735"><span class="linenos">735</span></a><span class="sd">        :return: The name of the relation, object role and item role</span>
</span><span id="STIXtoTypeDBMapper-736"><a href="#STIXtoTypeDBMapper-736"><span class="linenos">736</span></a><span class="sd">        :rtype: tuple[str, str, str]</span>
</span><span id="STIXtoTypeDBMapper-737"><a href="#STIXtoTypeDBMapper-737"><span class="linenos">737</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-738"><a href="#STIXtoTypeDBMapper-738"><span class="linenos">738</span></a>        <span class="n">pair_type</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span> \
</span><span id="STIXtoTypeDBMapper-739"><a href="#STIXtoTypeDBMapper-739"><span class="linenos">739</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pair_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-740"><a href="#STIXtoTypeDBMapper-740"><span class="linenos">740</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">pair_type</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-741"><a href="#STIXtoTypeDBMapper-741"><span class="linenos">741</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-742"><a href="#STIXtoTypeDBMapper-742"><span class="linenos">742</span></a>                <span class="sa">f</span><span class="s2">&quot;Pair Type </span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="STIXtoTypeDBMapper-743"><a href="#STIXtoTypeDBMapper-743"><span class="linenos">743</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-744"><a href="#STIXtoTypeDBMapper-744"><span class="linenos">744</span></a>
</span><span id="STIXtoTypeDBMapper-745"><a href="#STIXtoTypeDBMapper-745"><span class="linenos">745</span></a>        <span class="n">relation</span> <span class="o">=</span> <span class="n">pair_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIRS_RELATION</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-746"><a href="#STIXtoTypeDBMapper-746"><span class="linenos">746</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-747"><a href="#STIXtoTypeDBMapper-747"><span class="linenos">747</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-748"><a href="#STIXtoTypeDBMapper-748"><span class="linenos">748</span></a>                <span class="sa">f</span><span class="s2">&quot;Relation is not specified for pair type </span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper-749"><a href="#STIXtoTypeDBMapper-749"><span class="linenos">749</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-750"><a href="#STIXtoTypeDBMapper-750"><span class="linenos">750</span></a>        <span class="n">relation_name</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">RELATION_NAME</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-751"><a href="#STIXtoTypeDBMapper-751"><span class="linenos">751</span></a>        <span class="n">item_role</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ROLE_ITEM</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-752"><a href="#STIXtoTypeDBMapper-752"><span class="linenos">752</span></a>        <span class="n">object_role</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ROLE_OBJECT</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-753"><a href="#STIXtoTypeDBMapper-753"><span class="linenos">753</span></a>
</span><span id="STIXtoTypeDBMapper-754"><a href="#STIXtoTypeDBMapper-754"><span class="linenos">754</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">item_role</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">object_role</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-755"><a href="#STIXtoTypeDBMapper-755"><span class="linenos">755</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span><span class="s2">&quot;Relation info is not fully specified&quot;</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-756"><a href="#STIXtoTypeDBMapper-756"><span class="linenos">756</span></a>
</span><span id="STIXtoTypeDBMapper-757"><a href="#STIXtoTypeDBMapper-757"><span class="linenos">757</span></a>        <span class="k">return</span> <span class="n">relation_name</span><span class="p">,</span> <span class="n">object_role</span><span class="p">,</span> <span class="n">item_role</span>
</span><span id="STIXtoTypeDBMapper-758"><a href="#STIXtoTypeDBMapper-758"><span class="linenos">758</span></a>
</span><span id="STIXtoTypeDBMapper-759"><a href="#STIXtoTypeDBMapper-759"><span class="linenos">759</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-760"><a href="#STIXtoTypeDBMapper-760"><span class="linenos">760</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_dictionary_item_data</span><span class="p">(</span><span class="n">value_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper-761"><a href="#STIXtoTypeDBMapper-761"><span class="linenos">761</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of the item entity, the name of the key </span>
</span><span id="STIXtoTypeDBMapper-762"><a href="#STIXtoTypeDBMapper-762"><span class="linenos">762</span></a><span class="sd">        attribute name of the value attribute.</span>
</span><span id="STIXtoTypeDBMapper-763"><a href="#STIXtoTypeDBMapper-763"><span class="linenos">763</span></a>
</span><span id="STIXtoTypeDBMapper-764"><a href="#STIXtoTypeDBMapper-764"><span class="linenos">764</span></a><span class="sd">        :param value_type: The type of the value of the item</span>
</span><span id="STIXtoTypeDBMapper-765"><a href="#STIXtoTypeDBMapper-765"><span class="linenos">765</span></a><span class="sd">        :type value_type: str</span>
</span><span id="STIXtoTypeDBMapper-766"><a href="#STIXtoTypeDBMapper-766"><span class="linenos">766</span></a>
</span><span id="STIXtoTypeDBMapper-767"><a href="#STIXtoTypeDBMapper-767"><span class="linenos">767</span></a><span class="sd">        :raises MappingException: If the mapping is invalid/incomplete</span>
</span><span id="STIXtoTypeDBMapper-768"><a href="#STIXtoTypeDBMapper-768"><span class="linenos">768</span></a>
</span><span id="STIXtoTypeDBMapper-769"><a href="#STIXtoTypeDBMapper-769"><span class="linenos">769</span></a><span class="sd">        :return: The name of the item entity, key attribute and value </span>
</span><span id="STIXtoTypeDBMapper-770"><a href="#STIXtoTypeDBMapper-770"><span class="linenos">770</span></a><span class="sd">            attribute</span>
</span><span id="STIXtoTypeDBMapper-771"><a href="#STIXtoTypeDBMapper-771"><span class="linenos">771</span></a><span class="sd">        :rtype: tuple[str, str, str]</span>
</span><span id="STIXtoTypeDBMapper-772"><a href="#STIXtoTypeDBMapper-772"><span class="linenos">772</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-773"><a href="#STIXtoTypeDBMapper-773"><span class="linenos">773</span></a>        <span class="n">abstract</span><span class="p">,</span> <span class="n">specific</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">split_type</span><span class="p">(</span><span class="n">value_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-774"><a href="#STIXtoTypeDBMapper-774"><span class="linenos">774</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">specific</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-775"><a href="#STIXtoTypeDBMapper-775"><span class="linenos">775</span></a>            <span class="n">value_type</span> <span class="o">=</span> <span class="n">abstract</span>
</span><span id="STIXtoTypeDBMapper-776"><a href="#STIXtoTypeDBMapper-776"><span class="linenos">776</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-777"><a href="#STIXtoTypeDBMapper-777"><span class="linenos">777</span></a>            <span class="n">value_type</span> <span class="o">=</span> <span class="n">specific</span>
</span><span id="STIXtoTypeDBMapper-778"><a href="#STIXtoTypeDBMapper-778"><span class="linenos">778</span></a>
</span><span id="STIXtoTypeDBMapper-779"><a href="#STIXtoTypeDBMapper-779"><span class="linenos">779</span></a>        <span class="n">dict_data</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">dictionary_data</span>
</span><span id="STIXtoTypeDBMapper-780"><a href="#STIXtoTypeDBMapper-780"><span class="linenos">780</span></a>        <span class="n">key_name</span> <span class="o">=</span> <span class="n">dict_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DICTIONARY_KEY</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-781"><a href="#STIXtoTypeDBMapper-781"><span class="linenos">781</span></a>        <span class="n">items_data</span> <span class="o">=</span> <span class="n">dict_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DICTIONARY_SUBITEMS</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-782"><a href="#STIXtoTypeDBMapper-782"><span class="linenos">782</span></a>
</span><span id="STIXtoTypeDBMapper-783"><a href="#STIXtoTypeDBMapper-783"><span class="linenos">783</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">key_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">items_data</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-784"><a href="#STIXtoTypeDBMapper-784"><span class="linenos">784</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-785"><a href="#STIXtoTypeDBMapper-785"><span class="linenos">785</span></a>                <span class="s2">&quot;Dictionary data incomplete&quot;</span>
</span><span id="STIXtoTypeDBMapper-786"><a href="#STIXtoTypeDBMapper-786"><span class="linenos">786</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-787"><a href="#STIXtoTypeDBMapper-787"><span class="linenos">787</span></a>
</span><span id="STIXtoTypeDBMapper-788"><a href="#STIXtoTypeDBMapper-788"><span class="linenos">788</span></a>        <span class="n">item_data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">items_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">value_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-789"><a href="#STIXtoTypeDBMapper-789"><span class="linenos">789</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">item_data</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-790"><a href="#STIXtoTypeDBMapper-790"><span class="linenos">790</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-791"><a href="#STIXtoTypeDBMapper-791"><span class="linenos">791</span></a>                <span class="sa">f</span><span class="s2">&quot;Value type &#39;</span><span class="si">{</span><span class="n">value_type</span><span class="si">}</span><span class="s2">&#39; not supported in items of STIX properties &quot;</span>
</span><span id="STIXtoTypeDBMapper-792"><a href="#STIXtoTypeDBMapper-792"><span class="linenos">792</span></a>                <span class="s2">&quot;of type &#39;dictionary&#39; (e.g. exif_tags, additional_header_fields). &quot;</span>
</span><span id="STIXtoTypeDBMapper-793"><a href="#STIXtoTypeDBMapper-793"><span class="linenos">793</span></a>                <span class="sa">f</span><span class="s2">&quot;Valid types: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">items_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper-794"><a href="#STIXtoTypeDBMapper-794"><span class="linenos">794</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-795"><a href="#STIXtoTypeDBMapper-795"><span class="linenos">795</span></a>
</span><span id="STIXtoTypeDBMapper-796"><a href="#STIXtoTypeDBMapper-796"><span class="linenos">796</span></a>        <span class="n">item_name</span> <span class="o">=</span> <span class="n">item_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-797"><a href="#STIXtoTypeDBMapper-797"><span class="linenos">797</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DICTIONARY_ITEM_ENTITY</span>
</span><span id="STIXtoTypeDBMapper-798"><a href="#STIXtoTypeDBMapper-798"><span class="linenos">798</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-799"><a href="#STIXtoTypeDBMapper-799"><span class="linenos">799</span></a>        <span class="n">attr_name</span> <span class="o">=</span> <span class="n">item_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-800"><a href="#STIXtoTypeDBMapper-800"><span class="linenos">800</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DICTIONARY_VALUE_ATTRIBUTE</span>
</span><span id="STIXtoTypeDBMapper-801"><a href="#STIXtoTypeDBMapper-801"><span class="linenos">801</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-802"><a href="#STIXtoTypeDBMapper-802"><span class="linenos">802</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">item_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">attr_name</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-803"><a href="#STIXtoTypeDBMapper-803"><span class="linenos">803</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-804"><a href="#STIXtoTypeDBMapper-804"><span class="linenos">804</span></a>                <span class="s2">&quot;No item entity name of value attribute given for dictionary&quot;</span>
</span><span id="STIXtoTypeDBMapper-805"><a href="#STIXtoTypeDBMapper-805"><span class="linenos">805</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-806"><a href="#STIXtoTypeDBMapper-806"><span class="linenos">806</span></a>        <span class="k">return</span> <span class="n">item_name</span><span class="p">,</span> <span class="n">key_name</span><span class="p">,</span> <span class="n">attr_name</span>
</span><span id="STIXtoTypeDBMapper-807"><a href="#STIXtoTypeDBMapper-807"><span class="linenos">807</span></a>
</span><span id="STIXtoTypeDBMapper-808"><a href="#STIXtoTypeDBMapper-808"><span class="linenos">808</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-809"><a href="#STIXtoTypeDBMapper-809"><span class="linenos">809</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_dictionary_relation_data</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper-810"><a href="#STIXtoTypeDBMapper-810"><span class="linenos">810</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of the relation and roles used for building </span>
</span><span id="STIXtoTypeDBMapper-811"><a href="#STIXtoTypeDBMapper-811"><span class="linenos">811</span></a><span class="sd">        the dictionary, i.e. connecting the object to the items.</span>
</span><span id="STIXtoTypeDBMapper-812"><a href="#STIXtoTypeDBMapper-812"><span class="linenos">812</span></a>
</span><span id="STIXtoTypeDBMapper-813"><a href="#STIXtoTypeDBMapper-813"><span class="linenos">813</span></a><span class="sd">        :raises MappingException: If there is no relation specified</span>
</span><span id="STIXtoTypeDBMapper-814"><a href="#STIXtoTypeDBMapper-814"><span class="linenos">814</span></a>
</span><span id="STIXtoTypeDBMapper-815"><a href="#STIXtoTypeDBMapper-815"><span class="linenos">815</span></a><span class="sd">        :return: The name of the relation, role of the item and role</span>
</span><span id="STIXtoTypeDBMapper-816"><a href="#STIXtoTypeDBMapper-816"><span class="linenos">816</span></a><span class="sd">            of the object</span>
</span><span id="STIXtoTypeDBMapper-817"><a href="#STIXtoTypeDBMapper-817"><span class="linenos">817</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper-818"><a href="#STIXtoTypeDBMapper-818"><span class="linenos">818</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-819"><a href="#STIXtoTypeDBMapper-819"><span class="linenos">819</span></a>        <span class="n">dict_data</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">dictionary_data</span>
</span><span id="STIXtoTypeDBMapper-820"><a href="#STIXtoTypeDBMapper-820"><span class="linenos">820</span></a>        <span class="n">relation</span> <span class="o">=</span> <span class="n">dict_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DICTIONARY_RELATION</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-821"><a href="#STIXtoTypeDBMapper-821"><span class="linenos">821</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-822"><a href="#STIXtoTypeDBMapper-822"><span class="linenos">822</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-823"><a href="#STIXtoTypeDBMapper-823"><span class="linenos">823</span></a>                <span class="s2">&quot;No relation specified for dictionaries&quot;</span>
</span><span id="STIXtoTypeDBMapper-824"><a href="#STIXtoTypeDBMapper-824"><span class="linenos">824</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-825"><a href="#STIXtoTypeDBMapper-825"><span class="linenos">825</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">RELATION_NAME</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-826"><a href="#STIXtoTypeDBMapper-826"><span class="linenos">826</span></a>        <span class="n">item_role</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ROLE_ITEM</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-827"><a href="#STIXtoTypeDBMapper-827"><span class="linenos">827</span></a>        <span class="n">object_role</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ROLE_OBJECT</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-828"><a href="#STIXtoTypeDBMapper-828"><span class="linenos">828</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">item_role</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">object_role</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-829"><a href="#STIXtoTypeDBMapper-829"><span class="linenos">829</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-830"><a href="#STIXtoTypeDBMapper-830"><span class="linenos">830</span></a>                <span class="s2">&quot;Dictionary Data incomplete, relation name or roles missing&quot;</span>
</span><span id="STIXtoTypeDBMapper-831"><a href="#STIXtoTypeDBMapper-831"><span class="linenos">831</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-832"><a href="#STIXtoTypeDBMapper-832"><span class="linenos">832</span></a>        <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">item_role</span><span class="p">,</span> <span class="n">object_role</span>
</span><span id="STIXtoTypeDBMapper-833"><a href="#STIXtoTypeDBMapper-833"><span class="linenos">833</span></a>
</span><span id="STIXtoTypeDBMapper-834"><a href="#STIXtoTypeDBMapper-834"><span class="linenos">834</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-835"><a href="#STIXtoTypeDBMapper-835"><span class="linenos">835</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_dictionary_property_attribute</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-836"><a href="#STIXtoTypeDBMapper-836"><span class="linenos">836</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Gives the name of the attribute used for the name of the </span>
</span><span id="STIXtoTypeDBMapper-837"><a href="#STIXtoTypeDBMapper-837"><span class="linenos">837</span></a><span class="sd">        STIX property that is implemented as a dictionary.</span>
</span><span id="STIXtoTypeDBMapper-838"><a href="#STIXtoTypeDBMapper-838"><span class="linenos">838</span></a>
</span><span id="STIXtoTypeDBMapper-839"><a href="#STIXtoTypeDBMapper-839"><span class="linenos">839</span></a><span class="sd">        :raises MappingException: If the mapping is invalid or </span>
</span><span id="STIXtoTypeDBMapper-840"><a href="#STIXtoTypeDBMapper-840"><span class="linenos">840</span></a><span class="sd">            incomplete</span>
</span><span id="STIXtoTypeDBMapper-841"><a href="#STIXtoTypeDBMapper-841"><span class="linenos">841</span></a>
</span><span id="STIXtoTypeDBMapper-842"><a href="#STIXtoTypeDBMapper-842"><span class="linenos">842</span></a><span class="sd">        :return: The name of the attribute for the name of the STIX </span>
</span><span id="STIXtoTypeDBMapper-843"><a href="#STIXtoTypeDBMapper-843"><span class="linenos">843</span></a><span class="sd">            property</span>
</span><span id="STIXtoTypeDBMapper-844"><a href="#STIXtoTypeDBMapper-844"><span class="linenos">844</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper-845"><a href="#STIXtoTypeDBMapper-845"><span class="linenos">845</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-846"><a href="#STIXtoTypeDBMapper-846"><span class="linenos">846</span></a>        <span class="n">dict_data</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">dictionary_data</span>
</span><span id="STIXtoTypeDBMapper-847"><a href="#STIXtoTypeDBMapper-847"><span class="linenos">847</span></a>        <span class="n">attribute_name</span> <span class="o">=</span> <span class="n">dict_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-848"><a href="#STIXtoTypeDBMapper-848"><span class="linenos">848</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DICTIONARY_ATTRIBUTE_NAME</span>
</span><span id="STIXtoTypeDBMapper-849"><a href="#STIXtoTypeDBMapper-849"><span class="linenos">849</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-850"><a href="#STIXtoTypeDBMapper-850"><span class="linenos">850</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attribute_name</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-851"><a href="#STIXtoTypeDBMapper-851"><span class="linenos">851</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-852"><a href="#STIXtoTypeDBMapper-852"><span class="linenos">852</span></a>                <span class="s2">&quot;No attribute specified for name of the property&quot;</span>
</span><span id="STIXtoTypeDBMapper-853"><a href="#STIXtoTypeDBMapper-853"><span class="linenos">853</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-854"><a href="#STIXtoTypeDBMapper-854"><span class="linenos">854</span></a>        <span class="k">return</span> <span class="n">attribute_name</span>
</span><span id="STIXtoTypeDBMapper-855"><a href="#STIXtoTypeDBMapper-855"><span class="linenos">855</span></a>
</span><span id="STIXtoTypeDBMapper-856"><a href="#STIXtoTypeDBMapper-856"><span class="linenos">856</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-857"><a href="#STIXtoTypeDBMapper-857"><span class="linenos">857</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_extension_attribute_info</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-858"><a href="#STIXtoTypeDBMapper-858"><span class="linenos">858</span></a>        <span class="n">stix_object</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="STIXtoTypeDBMapper-859"><a href="#STIXtoTypeDBMapper-859"><span class="linenos">859</span></a>        <span class="n">stix_extension</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="STIXtoTypeDBMapper-860"><a href="#STIXtoTypeDBMapper-860"><span class="linenos">860</span></a>        <span class="n">stix_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="STIXtoTypeDBMapper-861"><a href="#STIXtoTypeDBMapper-861"><span class="linenos">861</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper-862"><a href="#STIXtoTypeDBMapper-862"><span class="linenos">862</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the attribute info of an extension.</span>
</span><span id="STIXtoTypeDBMapper-863"><a href="#STIXtoTypeDBMapper-863"><span class="linenos">863</span></a>
</span><span id="STIXtoTypeDBMapper-864"><a href="#STIXtoTypeDBMapper-864"><span class="linenos">864</span></a><span class="sd">        :param stix_object: The name of the STIX type, e.g. malware</span>
</span><span id="STIXtoTypeDBMapper-865"><a href="#STIXtoTypeDBMapper-865"><span class="linenos">865</span></a><span class="sd">        :type stix_object: str</span>
</span><span id="STIXtoTypeDBMapper-866"><a href="#STIXtoTypeDBMapper-866"><span class="linenos">866</span></a><span class="sd">        :param stix_extension: The name of the extension</span>
</span><span id="STIXtoTypeDBMapper-867"><a href="#STIXtoTypeDBMapper-867"><span class="linenos">867</span></a><span class="sd">        :type stix_extension: str</span>
</span><span id="STIXtoTypeDBMapper-868"><a href="#STIXtoTypeDBMapper-868"><span class="linenos">868</span></a><span class="sd">        :param stix_name: The name of the attribute</span>
</span><span id="STIXtoTypeDBMapper-869"><a href="#STIXtoTypeDBMapper-869"><span class="linenos">869</span></a><span class="sd">        :type stix_name: str</span>
</span><span id="STIXtoTypeDBMapper-870"><a href="#STIXtoTypeDBMapper-870"><span class="linenos">870</span></a>
</span><span id="STIXtoTypeDBMapper-871"><a href="#STIXtoTypeDBMapper-871"><span class="linenos">871</span></a><span class="sd">        :raises MappingException: If the stix type or extension is not </span>
</span><span id="STIXtoTypeDBMapper-872"><a href="#STIXtoTypeDBMapper-872"><span class="linenos">872</span></a><span class="sd">            defined in the mapping</span>
</span><span id="STIXtoTypeDBMapper-873"><a href="#STIXtoTypeDBMapper-873"><span class="linenos">873</span></a>
</span><span id="STIXtoTypeDBMapper-874"><a href="#STIXtoTypeDBMapper-874"><span class="linenos">874</span></a><span class="sd">        :return: The name and type of the attribute in TypeDB,</span>
</span><span id="STIXtoTypeDBMapper-875"><a href="#STIXtoTypeDBMapper-875"><span class="linenos">875</span></a><span class="sd">            (None, None) if it a custom attribute</span>
</span><span id="STIXtoTypeDBMapper-876"><a href="#STIXtoTypeDBMapper-876"><span class="linenos">876</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="STIXtoTypeDBMapper-877"><a href="#STIXtoTypeDBMapper-877"><span class="linenos">877</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-878"><a href="#STIXtoTypeDBMapper-878"><span class="linenos">878</span></a>        <span class="n">object_extensions</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span> \
</span><span id="STIXtoTypeDBMapper-879"><a href="#STIXtoTypeDBMapper-879"><span class="linenos">879</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_object</span><span class="p">)</span> \
</span><span id="STIXtoTypeDBMapper-880"><a href="#STIXtoTypeDBMapper-880"><span class="linenos">880</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_EXTENSIONS</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-881"><a href="#STIXtoTypeDBMapper-881"><span class="linenos">881</span></a>
</span><span id="STIXtoTypeDBMapper-882"><a href="#STIXtoTypeDBMapper-882"><span class="linenos">882</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">object_extensions</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-883"><a href="#STIXtoTypeDBMapper-883"><span class="linenos">883</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-884"><a href="#STIXtoTypeDBMapper-884"><span class="linenos">884</span></a>                <span class="sa">f</span><span class="s2">&quot;No extension specified for type </span><span class="si">{</span><span class="n">stix_object</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper-885"><a href="#STIXtoTypeDBMapper-885"><span class="linenos">885</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-886"><a href="#STIXtoTypeDBMapper-886"><span class="linenos">886</span></a>        <span class="n">extension</span> <span class="o">=</span> <span class="n">object_extensions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_extension</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-887"><a href="#STIXtoTypeDBMapper-887"><span class="linenos">887</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">extension</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-888"><a href="#STIXtoTypeDBMapper-888"><span class="linenos">888</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-889"><a href="#STIXtoTypeDBMapper-889"><span class="linenos">889</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stix_extension</span><span class="si">}</span><span class="s2"> is not a predefined extension for type </span><span class="si">{</span><span class="n">stix_object</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper-890"><a href="#STIXtoTypeDBMapper-890"><span class="linenos">890</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-891"><a href="#STIXtoTypeDBMapper-891"><span class="linenos">891</span></a>        <span class="n">attributes</span> <span class="o">=</span> <span class="n">extension</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTES</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-892"><a href="#STIXtoTypeDBMapper-892"><span class="linenos">892</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attributes</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-893"><a href="#STIXtoTypeDBMapper-893"><span class="linenos">893</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-894"><a href="#STIXtoTypeDBMapper-894"><span class="linenos">894</span></a>                <span class="sa">f</span><span class="s2">&quot;No attributes defined for extension </span><span class="si">{</span><span class="n">stix_extension</span><span class="si">}</span><span class="s2"> of stix type </span><span class="si">{</span><span class="n">stix_object</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper-895"><a href="#STIXtoTypeDBMapper-895"><span class="linenos">895</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-896"><a href="#STIXtoTypeDBMapper-896"><span class="linenos">896</span></a>        <span class="n">attribute_data</span> <span class="o">=</span> <span class="n">attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_name</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-897"><a href="#STIXtoTypeDBMapper-897"><span class="linenos">897</span></a>
</span><span id="STIXtoTypeDBMapper-898"><a href="#STIXtoTypeDBMapper-898"><span class="linenos">898</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attribute_data</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-899"><a href="#STIXtoTypeDBMapper-899"><span class="linenos">899</span></a>            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="STIXtoTypeDBMapper-900"><a href="#STIXtoTypeDBMapper-900"><span class="linenos">900</span></a>
</span><span id="STIXtoTypeDBMapper-901"><a href="#STIXtoTypeDBMapper-901"><span class="linenos">901</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">attribute_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_NAME</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-902"><a href="#STIXtoTypeDBMapper-902"><span class="linenos">902</span></a>        <span class="n">value_type</span> <span class="o">=</span> <span class="n">attribute_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-903"><a href="#STIXtoTypeDBMapper-903"><span class="linenos">903</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_VALUE_TYPE</span>
</span><span id="STIXtoTypeDBMapper-904"><a href="#STIXtoTypeDBMapper-904"><span class="linenos">904</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-905"><a href="#STIXtoTypeDBMapper-905"><span class="linenos">905</span></a>
</span><span id="STIXtoTypeDBMapper-906"><a href="#STIXtoTypeDBMapper-906"><span class="linenos">906</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">value_type</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-907"><a href="#STIXtoTypeDBMapper-907"><span class="linenos">907</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-908"><a href="#STIXtoTypeDBMapper-908"><span class="linenos">908</span></a>                <span class="sa">f</span><span class="s2">&quot;No name or no value type specified for attribute </span><span class="si">{</span><span class="n">stix_name</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="STIXtoTypeDBMapper-909"><a href="#STIXtoTypeDBMapper-909"><span class="linenos">909</span></a>                <span class="sa">f</span><span class="s2">&quot;of extension </span><span class="si">{</span><span class="n">stix_extension</span><span class="si">}</span><span class="s2"> of stix type </span><span class="si">{</span><span class="n">stix_object</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper-910"><a href="#STIXtoTypeDBMapper-910"><span class="linenos">910</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-911"><a href="#STIXtoTypeDBMapper-911"><span class="linenos">911</span></a>
</span><span id="STIXtoTypeDBMapper-912"><a href="#STIXtoTypeDBMapper-912"><span class="linenos">912</span></a>        <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">value_type</span>
</span><span id="STIXtoTypeDBMapper-913"><a href="#STIXtoTypeDBMapper-913"><span class="linenos">913</span></a>
</span><span id="STIXtoTypeDBMapper-914"><a href="#STIXtoTypeDBMapper-914"><span class="linenos">914</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper-915"><a href="#STIXtoTypeDBMapper-915"><span class="linenos">915</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_defined_extension</span><span class="p">(</span><span class="n">stix_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">extension_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-916"><a href="#STIXtoTypeDBMapper-916"><span class="linenos">916</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;States whether an extension name is defined according to</span>
</span><span id="STIXtoTypeDBMapper-917"><a href="#STIXtoTypeDBMapper-917"><span class="linenos">917</span></a><span class="sd">        STIX 2.1 or not, that means it is a custom extension.</span>
</span><span id="STIXtoTypeDBMapper-918"><a href="#STIXtoTypeDBMapper-918"><span class="linenos">918</span></a>
</span><span id="STIXtoTypeDBMapper-919"><a href="#STIXtoTypeDBMapper-919"><span class="linenos">919</span></a><span class="sd">        :param stix_type: The type of the STIX object</span>
</span><span id="STIXtoTypeDBMapper-920"><a href="#STIXtoTypeDBMapper-920"><span class="linenos">920</span></a><span class="sd">        :type stix_type: str</span>
</span><span id="STIXtoTypeDBMapper-921"><a href="#STIXtoTypeDBMapper-921"><span class="linenos">921</span></a><span class="sd">        :param extension_name: The name of the extension</span>
</span><span id="STIXtoTypeDBMapper-922"><a href="#STIXtoTypeDBMapper-922"><span class="linenos">922</span></a><span class="sd">        :type extension_name: str</span>
</span><span id="STIXtoTypeDBMapper-923"><a href="#STIXtoTypeDBMapper-923"><span class="linenos">923</span></a>
</span><span id="STIXtoTypeDBMapper-924"><a href="#STIXtoTypeDBMapper-924"><span class="linenos">924</span></a><span class="sd">        :raises MappingException: If the stix type is not defined</span>
</span><span id="STIXtoTypeDBMapper-925"><a href="#STIXtoTypeDBMapper-925"><span class="linenos">925</span></a>
</span><span id="STIXtoTypeDBMapper-926"><a href="#STIXtoTypeDBMapper-926"><span class="linenos">926</span></a><span class="sd">        :return: Whether the extension is a predefined extension</span>
</span><span id="STIXtoTypeDBMapper-927"><a href="#STIXtoTypeDBMapper-927"><span class="linenos">927</span></a><span class="sd">        :rtype: bool</span>
</span><span id="STIXtoTypeDBMapper-928"><a href="#STIXtoTypeDBMapper-928"><span class="linenos">928</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper-929"><a href="#STIXtoTypeDBMapper-929"><span class="linenos">929</span></a>        <span class="n">stix_object_data</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span> \
</span><span id="STIXtoTypeDBMapper-930"><a href="#STIXtoTypeDBMapper-930"><span class="linenos">930</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-931"><a href="#STIXtoTypeDBMapper-931"><span class="linenos">931</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">stix_object_data</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-932"><a href="#STIXtoTypeDBMapper-932"><span class="linenos">932</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper-933"><a href="#STIXtoTypeDBMapper-933"><span class="linenos">933</span></a>                <span class="sa">f</span><span class="s2">&quot;Stix type </span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2"> is not defined&quot;</span>
</span><span id="STIXtoTypeDBMapper-934"><a href="#STIXtoTypeDBMapper-934"><span class="linenos">934</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-935"><a href="#STIXtoTypeDBMapper-935"><span class="linenos">935</span></a>        <span class="n">extensions</span> <span class="o">=</span> <span class="n">stix_object_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_EXTENSIONS</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper-936"><a href="#STIXtoTypeDBMapper-936"><span class="linenos">936</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">extensions</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper-937"><a href="#STIXtoTypeDBMapper-937"><span class="linenos">937</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="STIXtoTypeDBMapper-938"><a href="#STIXtoTypeDBMapper-938"><span class="linenos">938</span></a>
</span><span id="STIXtoTypeDBMapper-939"><a href="#STIXtoTypeDBMapper-939"><span class="linenos">939</span></a>        <span class="k">return</span> <span class="n">extension_name</span> <span class="ow">in</span> <span class="n">extensions</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Handles the mapping file that describes how to translate 
STIX 2.1 to the TypeDB schema.</p>
</div>


                            <div id="STIXtoTypeDBMapper.classes" class="classattr">
                                <div class="attr variable">
            <span class="name">classes</span><span class="annotation">: dict</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.classes"></a>
    
    

                            </div>
                            <div id="STIXtoTypeDBMapper.stix_objects" class="classattr">
                                <div class="attr variable">
            <span class="name">stix_objects</span><span class="annotation">: dict</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.stix_objects"></a>
    
    

                            </div>
                            <div id="STIXtoTypeDBMapper.composites_mapping" class="classattr">
                                <div class="attr variable">
            <span class="name">composites_mapping</span><span class="annotation">: dict</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.composites_mapping"></a>
    
    

                            </div>
                            <div id="STIXtoTypeDBMapper.common_attributes" class="classattr">
                                <div class="attr variable">
            <span class="name">common_attributes</span><span class="annotation">: dict</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.common_attributes"></a>
    
    

                            </div>
                            <div id="STIXtoTypeDBMapper.sros_role_info" class="classattr">
                                <div class="attr variable">
            <span class="name">sros_role_info</span><span class="annotation">: dict</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.sros_role_info"></a>
    
    

                            </div>
                            <div id="STIXtoTypeDBMapper.key_value_pairs" class="classattr">
                                <div class="attr variable">
            <span class="name">key_value_pairs</span><span class="annotation">: dict</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.key_value_pairs"></a>
    
    

                            </div>
                            <div id="STIXtoTypeDBMapper.dictionary_data" class="classattr">
                                <div class="attr variable">
            <span class="name">dictionary_data</span><span class="annotation">: dict</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.dictionary_data"></a>
    
    

                            </div>
                            <div id="STIXtoTypeDBMapper.split_type" class="classattr">
                                        <input id="STIXtoTypeDBMapper.split_type-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">split_type</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">value_type</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.split_type-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.split_type"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.split_type-27"><a href="#STIXtoTypeDBMapper.split_type-27"><span class="linenos">27</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.split_type-28"><a href="#STIXtoTypeDBMapper.split_type-28"><span class="linenos">28</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">split_type</span><span class="p">(</span><span class="n">value_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper.split_type-29"><a href="#STIXtoTypeDBMapper.split_type-29"><span class="linenos">29</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Splits a compound value type to its ingredients according </span>
</span><span id="STIXtoTypeDBMapper.split_type-30"><a href="#STIXtoTypeDBMapper.split_type-30"><span class="linenos">30</span></a><span class="sd">        to the mapping.</span>
</span><span id="STIXtoTypeDBMapper.split_type-31"><a href="#STIXtoTypeDBMapper.split_type-31"><span class="linenos">31</span></a><span class="sd">        If it is indeed a NonPrimitive Type, then the first value is </span>
</span><span id="STIXtoTypeDBMapper.split_type-32"><a href="#STIXtoTypeDBMapper.split_type-32"><span class="linenos">32</span></a><span class="sd">        the abstract and the second the subtype. Otherwise, the first</span>
</span><span id="STIXtoTypeDBMapper.split_type-33"><a href="#STIXtoTypeDBMapper.split_type-33"><span class="linenos">33</span></a><span class="sd">        value is the value type and the second is empty.</span>
</span><span id="STIXtoTypeDBMapper.split_type-34"><a href="#STIXtoTypeDBMapper.split_type-34"><span class="linenos">34</span></a>
</span><span id="STIXtoTypeDBMapper.split_type-35"><a href="#STIXtoTypeDBMapper.split_type-35"><span class="linenos">35</span></a><span class="sd">        :param value_type: The type of a value</span>
</span><span id="STIXtoTypeDBMapper.split_type-36"><a href="#STIXtoTypeDBMapper.split_type-36"><span class="linenos">36</span></a><span class="sd">        :type value_type: str</span>
</span><span id="STIXtoTypeDBMapper.split_type-37"><a href="#STIXtoTypeDBMapper.split_type-37"><span class="linenos">37</span></a>
</span><span id="STIXtoTypeDBMapper.split_type-38"><a href="#STIXtoTypeDBMapper.split_type-38"><span class="linenos">38</span></a><span class="sd">        :return: The abstract and subtype of the type</span>
</span><span id="STIXtoTypeDBMapper.split_type-39"><a href="#STIXtoTypeDBMapper.split_type-39"><span class="linenos">39</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="STIXtoTypeDBMapper.split_type-40"><a href="#STIXtoTypeDBMapper.split_type-40"><span class="linenos">40</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.split_type-41"><a href="#STIXtoTypeDBMapper.split_type-41"><span class="linenos">41</span></a>        <span class="n">splitted</span> <span class="o">=</span> <span class="n">value_type</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_TYPE_SEPARATOR</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.split_type-42"><a href="#STIXtoTypeDBMapper.split_type-42"><span class="linenos">42</span></a>        <span class="n">abstract</span> <span class="o">=</span> <span class="n">splitted</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="STIXtoTypeDBMapper.split_type-43"><a href="#STIXtoTypeDBMapper.split_type-43"><span class="linenos">43</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">splitted</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.split_type-44"><a href="#STIXtoTypeDBMapper.split_type-44"><span class="linenos">44</span></a>            <span class="n">subtype</span> <span class="o">=</span> <span class="n">splitted</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="STIXtoTypeDBMapper.split_type-45"><a href="#STIXtoTypeDBMapper.split_type-45"><span class="linenos">45</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.split_type-46"><a href="#STIXtoTypeDBMapper.split_type-46"><span class="linenos">46</span></a>            <span class="n">subtype</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.split_type-47"><a href="#STIXtoTypeDBMapper.split_type-47"><span class="linenos">47</span></a>        <span class="k">return</span> <span class="n">abstract</span><span class="p">,</span> <span class="n">subtype</span>
</span></pre></div>


            <div class="docstring"><p>Splits a compound value type to its ingredients according 
to the mapping.
If it is indeed a NonPrimitive Type, then the first value is 
the abstract and the second the subtype. Otherwise, the first
value is the value type and the second is empty.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>value_type</strong>:  The type of a value</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The abstract and subtype of the type</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.join_type" class="classattr">
                                        <input id="STIXtoTypeDBMapper.join_type-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">join_type</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">tl_type</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">subtype</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.join_type-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.join_type"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.join_type-49"><a href="#STIXtoTypeDBMapper.join_type-49"><span class="linenos">49</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.join_type-50"><a href="#STIXtoTypeDBMapper.join_type-50"><span class="linenos">50</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">join_type</span><span class="p">(</span><span class="n">tl_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subtype</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.join_type-51"><a href="#STIXtoTypeDBMapper.join_type-51"><span class="linenos">51</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Join an abstract and specific type together according </span>
</span><span id="STIXtoTypeDBMapper.join_type-52"><a href="#STIXtoTypeDBMapper.join_type-52"><span class="linenos">52</span></a><span class="sd">        to the mapping.</span>
</span><span id="STIXtoTypeDBMapper.join_type-53"><a href="#STIXtoTypeDBMapper.join_type-53"><span class="linenos">53</span></a>
</span><span id="STIXtoTypeDBMapper.join_type-54"><a href="#STIXtoTypeDBMapper.join_type-54"><span class="linenos">54</span></a><span class="sd">        :param tl_type: The top-level-/ abstract  type</span>
</span><span id="STIXtoTypeDBMapper.join_type-55"><a href="#STIXtoTypeDBMapper.join_type-55"><span class="linenos">55</span></a><span class="sd">        :type tl_type: str</span>
</span><span id="STIXtoTypeDBMapper.join_type-56"><a href="#STIXtoTypeDBMapper.join_type-56"><span class="linenos">56</span></a><span class="sd">        :param subtype: The sub-/ specific type</span>
</span><span id="STIXtoTypeDBMapper.join_type-57"><a href="#STIXtoTypeDBMapper.join_type-57"><span class="linenos">57</span></a><span class="sd">        :type subtype: str</span>
</span><span id="STIXtoTypeDBMapper.join_type-58"><a href="#STIXtoTypeDBMapper.join_type-58"><span class="linenos">58</span></a>
</span><span id="STIXtoTypeDBMapper.join_type-59"><a href="#STIXtoTypeDBMapper.join_type-59"><span class="linenos">59</span></a><span class="sd">        :return: The two types joined together</span>
</span><span id="STIXtoTypeDBMapper.join_type-60"><a href="#STIXtoTypeDBMapper.join_type-60"><span class="linenos">60</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper.join_type-61"><a href="#STIXtoTypeDBMapper.join_type-61"><span class="linenos">61</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.join_type-62"><a href="#STIXtoTypeDBMapper.join_type-62"><span class="linenos">62</span></a>        <span class="k">return</span> <span class="n">tl_type</span> <span class="o">+</span> <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_TYPE_SEPARATOR</span> <span class="o">+</span> <span class="n">subtype</span>
</span></pre></div>


            <div class="docstring"><p>Join an abstract and specific type together according 
to the mapping.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>tl_type</strong>:  The top-level-/ abstract  type</li>
<li><strong>subtype</strong>:  The sub-/ specific type</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The two types joined together</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.validate" class="classattr">
                                        <input id="STIXtoTypeDBMapper.validate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">validate</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.validate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.validate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.validate-64"><a href="#STIXtoTypeDBMapper.validate-64"><span class="linenos"> 64</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.validate-65"><a href="#STIXtoTypeDBMapper.validate-65"><span class="linenos"> 65</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper.validate-66"><a href="#STIXtoTypeDBMapper.validate-66"><span class="linenos"> 66</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validates STIX to TypeDB JSON mappings against predefined schema files.</span>
</span><span id="STIXtoTypeDBMapper.validate-67"><a href="#STIXtoTypeDBMapper.validate-67"><span class="linenos"> 67</span></a>
</span><span id="STIXtoTypeDBMapper.validate-68"><a href="#STIXtoTypeDBMapper.validate-68"><span class="linenos"> 68</span></a><span class="sd">        This function reads various schema files in JSON format and validates</span>
</span><span id="STIXtoTypeDBMapper.validate-69"><a href="#STIXtoTypeDBMapper.validate-69"><span class="linenos"> 69</span></a><span class="sd">        the corresponding mappings in the STIXtoTypeDBMapper class against these</span>
</span><span id="STIXtoTypeDBMapper.validate-70"><a href="#STIXtoTypeDBMapper.validate-70"><span class="linenos"> 70</span></a><span class="sd">        schemas. The schemas include classes, STIX objects, composites, SRO roles,</span>
</span><span id="STIXtoTypeDBMapper.validate-71"><a href="#STIXtoTypeDBMapper.validate-71"><span class="linenos"> 71</span></a><span class="sd">        key-value pairs, a dictionary type, and common attributes.</span>
</span><span id="STIXtoTypeDBMapper.validate-72"><a href="#STIXtoTypeDBMapper.validate-72"><span class="linenos"> 72</span></a>
</span><span id="STIXtoTypeDBMapper.validate-73"><a href="#STIXtoTypeDBMapper.validate-73"><span class="linenos"> 73</span></a><span class="sd">        :raises ValidationError: If a mapping file does not match the schema</span>
</span><span id="STIXtoTypeDBMapper.validate-74"><a href="#STIXtoTypeDBMapper.validate-74"><span class="linenos"> 74</span></a><span class="sd">        :raises SchemaError: If a JSON schema file is invalid</span>
</span><span id="STIXtoTypeDBMapper.validate-75"><a href="#STIXtoTypeDBMapper.validate-75"><span class="linenos"> 75</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.validate-76"><a href="#STIXtoTypeDBMapper.validate-76"><span class="linenos"> 76</span></a>        <span class="n">schema_classes</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.validate-77"><a href="#STIXtoTypeDBMapper.validate-77"><span class="linenos"> 77</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_CLASSES</span>
</span><span id="STIXtoTypeDBMapper.validate-78"><a href="#STIXtoTypeDBMapper.validate-78"><span class="linenos"> 78</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.validate-79"><a href="#STIXtoTypeDBMapper.validate-79"><span class="linenos"> 79</span></a>        <span class="n">schema_stix_objects</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.validate-80"><a href="#STIXtoTypeDBMapper.validate-80"><span class="linenos"> 80</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_STIX_OBJECTS</span>
</span><span id="STIXtoTypeDBMapper.validate-81"><a href="#STIXtoTypeDBMapper.validate-81"><span class="linenos"> 81</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.validate-82"><a href="#STIXtoTypeDBMapper.validate-82"><span class="linenos"> 82</span></a>        <span class="n">schema_composites</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.validate-83"><a href="#STIXtoTypeDBMapper.validate-83"><span class="linenos"> 83</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_COMPOSITES</span>
</span><span id="STIXtoTypeDBMapper.validate-84"><a href="#STIXtoTypeDBMapper.validate-84"><span class="linenos"> 84</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.validate-85"><a href="#STIXtoTypeDBMapper.validate-85"><span class="linenos"> 85</span></a>        <span class="n">schema_sro_roles</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.validate-86"><a href="#STIXtoTypeDBMapper.validate-86"><span class="linenos"> 86</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_SRO_ROLES</span>
</span><span id="STIXtoTypeDBMapper.validate-87"><a href="#STIXtoTypeDBMapper.validate-87"><span class="linenos"> 87</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.validate-88"><a href="#STIXtoTypeDBMapper.validate-88"><span class="linenos"> 88</span></a>        <span class="n">schema_key_value_pairs</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.validate-89"><a href="#STIXtoTypeDBMapper.validate-89"><span class="linenos"> 89</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_KV_PAIRS</span>
</span><span id="STIXtoTypeDBMapper.validate-90"><a href="#STIXtoTypeDBMapper.validate-90"><span class="linenos"> 90</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.validate-91"><a href="#STIXtoTypeDBMapper.validate-91"><span class="linenos"> 91</span></a>        <span class="n">schema_dictionary</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.validate-92"><a href="#STIXtoTypeDBMapper.validate-92"><span class="linenos"> 92</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_DICT</span>
</span><span id="STIXtoTypeDBMapper.validate-93"><a href="#STIXtoTypeDBMapper.validate-93"><span class="linenos"> 93</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.validate-94"><a href="#STIXtoTypeDBMapper.validate-94"><span class="linenos"> 94</span></a>        <span class="n">schema_common_attributes</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.validate-95"><a href="#STIXtoTypeDBMapper.validate-95"><span class="linenos"> 95</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCHEMA_COMMON_ATTRIBUTES</span>
</span><span id="STIXtoTypeDBMapper.validate-96"><a href="#STIXtoTypeDBMapper.validate-96"><span class="linenos"> 96</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.validate-97"><a href="#STIXtoTypeDBMapper.validate-97"><span class="linenos"> 97</span></a>
</span><span id="STIXtoTypeDBMapper.validate-98"><a href="#STIXtoTypeDBMapper.validate-98"><span class="linenos"> 98</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">classes</span><span class="p">,</span> <span class="n">schema_classes</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.validate-99"><a href="#STIXtoTypeDBMapper.validate-99"><span class="linenos"> 99</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="p">,</span> <span class="n">schema_stix_objects</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.validate-100"><a href="#STIXtoTypeDBMapper.validate-100"><span class="linenos">100</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span><span class="p">,</span> <span class="n">schema_composites</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.validate-101"><a href="#STIXtoTypeDBMapper.validate-101"><span class="linenos">101</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">common_attributes</span><span class="p">,</span>
</span><span id="STIXtoTypeDBMapper.validate-102"><a href="#STIXtoTypeDBMapper.validate-102"><span class="linenos">102</span></a>                 <span class="n">schema_common_attributes</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.validate-103"><a href="#STIXtoTypeDBMapper.validate-103"><span class="linenos">103</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">sros_role_info</span><span class="p">,</span> <span class="n">schema_sro_roles</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.validate-104"><a href="#STIXtoTypeDBMapper.validate-104"><span class="linenos">104</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span><span class="p">,</span> <span class="n">schema_key_value_pairs</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.validate-105"><a href="#STIXtoTypeDBMapper.validate-105"><span class="linenos">105</span></a>        <span class="n">validate</span><span class="p">(</span><span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">dictionary_data</span><span class="p">,</span> <span class="n">schema_dictionary</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Validates STIX to TypeDB JSON mappings against predefined schema files.</p>

<p>This function reads various schema files in JSON format and validates
the corresponding mappings in the STIXtoTypeDBMapper class against these
schemas. The schemas include classes, STIX objects, composites, SRO roles,
key-value pairs, a dictionary type, and common attributes.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValidationError</strong>:  If a mapping file does not match the schema</li>
<li><strong>SchemaError</strong>:  If a JSON schema file is invalid</li>
</ul>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_data" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_data</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">validate</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_data-107"><a href="#STIXtoTypeDBMapper.get_data-107"><span class="linenos">107</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_data-108"><a href="#STIXtoTypeDBMapper.get_data-108"><span class="linenos">108</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_data</span><span class="p">(</span><span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_data-109"><a href="#STIXtoTypeDBMapper.get_data-109"><span class="linenos">109</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads the data of the JSON map.</span>
</span><span id="STIXtoTypeDBMapper.get_data-110"><a href="#STIXtoTypeDBMapper.get_data-110"><span class="linenos">110</span></a>
</span><span id="STIXtoTypeDBMapper.get_data-111"><a href="#STIXtoTypeDBMapper.get_data-111"><span class="linenos">111</span></a><span class="sd">        Note that though every function calls this function here, </span>
</span><span id="STIXtoTypeDBMapper.get_data-112"><a href="#STIXtoTypeDBMapper.get_data-112"><span class="linenos">112</span></a><span class="sd">        the data is loaded only once. Therefore, the first call to </span>
</span><span id="STIXtoTypeDBMapper.get_data-113"><a href="#STIXtoTypeDBMapper.get_data-113"><span class="linenos">113</span></a><span class="sd">        this method decides which mappings to load.</span>
</span><span id="STIXtoTypeDBMapper.get_data-114"><a href="#STIXtoTypeDBMapper.get_data-114"><span class="linenos">114</span></a>
</span><span id="STIXtoTypeDBMapper.get_data-115"><a href="#STIXtoTypeDBMapper.get_data-115"><span class="linenos">115</span></a><span class="sd">        :param validate: Whether the data should be validated, too</span>
</span><span id="STIXtoTypeDBMapper.get_data-116"><a href="#STIXtoTypeDBMapper.get_data-116"><span class="linenos">116</span></a><span class="sd">        :type validate: bool, optional</span>
</span><span id="STIXtoTypeDBMapper.get_data-117"><a href="#STIXtoTypeDBMapper.get_data-117"><span class="linenos">117</span></a>
</span><span id="STIXtoTypeDBMapper.get_data-118"><a href="#STIXtoTypeDBMapper.get_data-118"><span class="linenos">118</span></a><span class="sd">        :raises SchemaError: If the schema is invalid </span>
</span><span id="STIXtoTypeDBMapper.get_data-119"><a href="#STIXtoTypeDBMapper.get_data-119"><span class="linenos">119</span></a><span class="sd">            and validate = True</span>
</span><span id="STIXtoTypeDBMapper.get_data-120"><a href="#STIXtoTypeDBMapper.get_data-120"><span class="linenos">120</span></a><span class="sd">        :raises ValidationError: If the mapping is invalid</span>
</span><span id="STIXtoTypeDBMapper.get_data-121"><a href="#STIXtoTypeDBMapper.get_data-121"><span class="linenos">121</span></a><span class="sd">            and validate = True</span>
</span><span id="STIXtoTypeDBMapper.get_data-122"><a href="#STIXtoTypeDBMapper.get_data-122"><span class="linenos">122</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_data-123"><a href="#STIXtoTypeDBMapper.get_data-123"><span class="linenos">123</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_data-124"><a href="#STIXtoTypeDBMapper.get_data-124"><span class="linenos">124</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_data-125"><a href="#STIXtoTypeDBMapper.get_data-125"><span class="linenos">125</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_COMPOSITES</span>
</span><span id="STIXtoTypeDBMapper.get_data-126"><a href="#STIXtoTypeDBMapper.get_data-126"><span class="linenos">126</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_data-127"><a href="#STIXtoTypeDBMapper.get_data-127"><span class="linenos">127</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_data-128"><a href="#STIXtoTypeDBMapper.get_data-128"><span class="linenos">128</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_data-129"><a href="#STIXtoTypeDBMapper.get_data-129"><span class="linenos">129</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SDO</span>
</span><span id="STIXtoTypeDBMapper.get_data-130"><a href="#STIXtoTypeDBMapper.get_data-130"><span class="linenos">130</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_data-131"><a href="#STIXtoTypeDBMapper.get_data-131"><span class="linenos">131</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_data-132"><a href="#STIXtoTypeDBMapper.get_data-132"><span class="linenos">132</span></a>                <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">FILE_SRO</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_data-133"><a href="#STIXtoTypeDBMapper.get_data-133"><span class="linenos">133</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_data-134"><a href="#STIXtoTypeDBMapper.get_data-134"><span class="linenos">134</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_data-135"><a href="#STIXtoTypeDBMapper.get_data-135"><span class="linenos">135</span></a>                <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">FILE_SCO</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_data-136"><a href="#STIXtoTypeDBMapper.get_data-136"><span class="linenos">136</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_data-137"><a href="#STIXtoTypeDBMapper.get_data-137"><span class="linenos">137</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_data-138"><a href="#STIXtoTypeDBMapper.get_data-138"><span class="linenos">138</span></a>                <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">FILE_SMO</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_data-139"><a href="#STIXtoTypeDBMapper.get_data-139"><span class="linenos">139</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_data-140"><a href="#STIXtoTypeDBMapper.get_data-140"><span class="linenos">140</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">classes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_data-141"><a href="#STIXtoTypeDBMapper.get_data-141"><span class="linenos">141</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_data-142"><a href="#STIXtoTypeDBMapper.get_data-142"><span class="linenos">142</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_CLASSES</span>
</span><span id="STIXtoTypeDBMapper.get_data-143"><a href="#STIXtoTypeDBMapper.get_data-143"><span class="linenos">143</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_data-144"><a href="#STIXtoTypeDBMapper.get_data-144"><span class="linenos">144</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">common_attributes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_data-145"><a href="#STIXtoTypeDBMapper.get_data-145"><span class="linenos">145</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">common_attributes</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_data-146"><a href="#STIXtoTypeDBMapper.get_data-146"><span class="linenos">146</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_COMMON_ATTRIBUTES</span>
</span><span id="STIXtoTypeDBMapper.get_data-147"><a href="#STIXtoTypeDBMapper.get_data-147"><span class="linenos">147</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_data-148"><a href="#STIXtoTypeDBMapper.get_data-148"><span class="linenos">148</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">sros_role_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_data-149"><a href="#STIXtoTypeDBMapper.get_data-149"><span class="linenos">149</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">sros_role_info</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_data-150"><a href="#STIXtoTypeDBMapper.get_data-150"><span class="linenos">150</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_SRO_ROLES_INFO</span>
</span><span id="STIXtoTypeDBMapper.get_data-151"><a href="#STIXtoTypeDBMapper.get_data-151"><span class="linenos">151</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_data-152"><a href="#STIXtoTypeDBMapper.get_data-152"><span class="linenos">152</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_data-153"><a href="#STIXtoTypeDBMapper.get_data-153"><span class="linenos">153</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_data-154"><a href="#STIXtoTypeDBMapper.get_data-154"><span class="linenos">154</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_KEY_VALUE_PAIRS</span>
</span><span id="STIXtoTypeDBMapper.get_data-155"><a href="#STIXtoTypeDBMapper.get_data-155"><span class="linenos">155</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_data-156"><a href="#STIXtoTypeDBMapper.get_data-156"><span class="linenos">156</span></a>        <span class="k">if</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">dictionary_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_data-157"><a href="#STIXtoTypeDBMapper.get_data-157"><span class="linenos">157</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">dictionary_data</span> <span class="o">=</span> <span class="n">file_utils</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_data-158"><a href="#STIXtoTypeDBMapper.get_data-158"><span class="linenos">158</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">FILE_DICTIONARY_DATA</span>
</span><span id="STIXtoTypeDBMapper.get_data-159"><a href="#STIXtoTypeDBMapper.get_data-159"><span class="linenos">159</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_data-160"><a href="#STIXtoTypeDBMapper.get_data-160"><span class="linenos">160</span></a>        <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_data-161"><a href="#STIXtoTypeDBMapper.get_data-161"><span class="linenos">161</span></a>            <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Loads the data of the JSON map.</p>

<p>Note that though every function calls this function here, 
the data is loaded only once. Therefore, the first call to 
this method decides which mappings to load.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>validate</strong>:  Whether the data should be validated, too</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>SchemaError</strong>:  If the schema is invalid 
and validate = True</li>
<li><strong>ValidationError</strong>:  If the mapping is invalid
and validate = True</li>
</ul>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_class" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_class-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_class</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">stix_object_type</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_class-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_class"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_class-163"><a href="#STIXtoTypeDBMapper.get_class-163"><span class="linenos">163</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_class-164"><a href="#STIXtoTypeDBMapper.get_class-164"><span class="linenos">164</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_class</span><span class="p">(</span><span class="n">stix_object_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_class-165"><a href="#STIXtoTypeDBMapper.get_class-165"><span class="linenos">165</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the class used to build this STIX type.</span>
</span><span id="STIXtoTypeDBMapper.get_class-166"><a href="#STIXtoTypeDBMapper.get_class-166"><span class="linenos">166</span></a>
</span><span id="STIXtoTypeDBMapper.get_class-167"><a href="#STIXtoTypeDBMapper.get_class-167"><span class="linenos">167</span></a><span class="sd">        :param stix_object_type: The type of the STIX object, </span>
</span><span id="STIXtoTypeDBMapper.get_class-168"><a href="#STIXtoTypeDBMapper.get_class-168"><span class="linenos">168</span></a><span class="sd">            e.g. attack-pattern</span>
</span><span id="STIXtoTypeDBMapper.get_class-169"><a href="#STIXtoTypeDBMapper.get_class-169"><span class="linenos">169</span></a><span class="sd">        :type stix_object_type: str</span>
</span><span id="STIXtoTypeDBMapper.get_class-170"><a href="#STIXtoTypeDBMapper.get_class-170"><span class="linenos">170</span></a>
</span><span id="STIXtoTypeDBMapper.get_class-171"><a href="#STIXtoTypeDBMapper.get_class-171"><span class="linenos">171</span></a><span class="sd">        :return: The class used for the building, None if the type </span>
</span><span id="STIXtoTypeDBMapper.get_class-172"><a href="#STIXtoTypeDBMapper.get_class-172"><span class="linenos">172</span></a><span class="sd">            is a custom type</span>
</span><span id="STIXtoTypeDBMapper.get_class-173"><a href="#STIXtoTypeDBMapper.get_class-173"><span class="linenos">173</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper.get_class-174"><a href="#STIXtoTypeDBMapper.get_class-174"><span class="linenos">174</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_class-175"><a href="#STIXtoTypeDBMapper.get_class-175"><span class="linenos">175</span></a>        <span class="n">class_type</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="STIXtoTypeDBMapper.get_class-176"><a href="#STIXtoTypeDBMapper.get_class-176"><span class="linenos">176</span></a>        <span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">stix_object_types</span> <span class="ow">in</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper.get_class-177"><a href="#STIXtoTypeDBMapper.get_class-177"><span class="linenos">177</span></a>            <span class="k">if</span> <span class="n">stix_object_type</span> <span class="ow">in</span> <span class="n">stix_object_types</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_class-178"><a href="#STIXtoTypeDBMapper.get_class-178"><span class="linenos">178</span></a>                <span class="n">class_type</span> <span class="o">=</span> <span class="n">category</span>
</span><span id="STIXtoTypeDBMapper.get_class-179"><a href="#STIXtoTypeDBMapper.get_class-179"><span class="linenos">179</span></a>                <span class="k">break</span>
</span><span id="STIXtoTypeDBMapper.get_class-180"><a href="#STIXtoTypeDBMapper.get_class-180"><span class="linenos">180</span></a>        <span class="k">return</span> <span class="n">class_type</span>
</span></pre></div>


            <div class="docstring"><p>Returns the class used to build this STIX type.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>stix_object_type</strong>:  The type of the STIX object, 
e.g. attack-pattern</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The class used for the building, None if the type 
      is a custom type</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_typeql_thing_name" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_typeql_thing_name-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_typeql_thing_name</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">stix_type</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">stix_properties</span><span class="p">:</span> <span class="nb">dict</span>, </span><span class="param"><span class="n">stix_extensions</span><span class="p">:</span> <span class="nb">dict</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_typeql_thing_name-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_typeql_thing_name"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-182"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-182"><span class="linenos">182</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-183"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-183"><span class="linenos">183</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_typeql_thing_name</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-184"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-184"><span class="linenos">184</span></a>        <span class="n">stix_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-185"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-185"><span class="linenos">185</span></a>        <span class="n">stix_properties</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-186"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-186"><span class="linenos">186</span></a>        <span class="n">stix_extensions</span><span class="p">:</span> <span class="nb">dict</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-187"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-187"><span class="linenos">187</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-188"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-188"><span class="linenos">188</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of the TypeQL thing for a certain </span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-189"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-189"><span class="linenos">189</span></a><span class="sd">        STIX Object. E.g. &quot;attack-pattern&quot; -&gt; &quot;attack-pattern&quot;.</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-190"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-190"><span class="linenos">190</span></a>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-191"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-191"><span class="linenos">191</span></a><span class="sd">        :param stix_type: The type of the STIX object</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-192"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-192"><span class="linenos">192</span></a><span class="sd">        :type stix_type: str</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-193"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-193"><span class="linenos">193</span></a><span class="sd">        :param stix_properties: The properties of the STIX Object</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-194"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-194"><span class="linenos">194</span></a><span class="sd">        :type stix_properties: dict </span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-195"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-195"><span class="linenos">195</span></a><span class="sd">        :param stix_extensions: The extensions of the STIX Object</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-196"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-196"><span class="linenos">196</span></a><span class="sd">        :type stix_extensions: dict </span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-197"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-197"><span class="linenos">197</span></a>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-198"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-198"><span class="linenos">198</span></a><span class="sd">        :raises MappingException: If the Type cannot be determined</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-199"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-199"><span class="linenos">199</span></a>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-200"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-200"><span class="linenos">200</span></a><span class="sd">        :return: The name of the object in TypeDB, None if the type </span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-201"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-201"><span class="linenos">201</span></a><span class="sd">            is a custom type</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-202"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-202"><span class="linenos">202</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-203"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-203"><span class="linenos">203</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-204"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-204"><span class="linenos">204</span></a>        <span class="n">object_info</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span> \
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-205"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-205"><span class="linenos">205</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-206"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-206"><span class="linenos">206</span></a>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-207"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-207"><span class="linenos">207</span></a>        <span class="c1"># Custom type</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-208"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-208"><span class="linenos">208</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">object_info</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-209"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-209"><span class="linenos">209</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-210"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-210"><span class="linenos">210</span></a>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-211"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-211"><span class="linenos">211</span></a>        <span class="n">assigned_type</span> <span class="o">=</span> <span class="n">object_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_TYPEDB_TYPE</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-212"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-212"><span class="linenos">212</span></a>        <span class="n">subtypes</span> <span class="o">=</span> <span class="n">object_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_SUBTYPES</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-213"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-213"><span class="linenos">213</span></a>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-214"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-214"><span class="linenos">214</span></a>        <span class="n">typedb_type</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-215"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-215"><span class="linenos">215</span></a>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-216"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-216"><span class="linenos">216</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">assigned_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-217"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-217"><span class="linenos">217</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No TypeDB type specified for </span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-218"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-218"><span class="linenos">218</span></a>        <span class="n">typedb_type</span> <span class="o">=</span> <span class="n">assigned_type</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-219"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-219"><span class="linenos">219</span></a>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-220"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="n">subtypes</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-221"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-221"><span class="linenos">221</span></a>            <span class="n">attribute</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">subtypes</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-222"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-222"><span class="linenos">222</span></a>            <span class="n">value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">stix_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-223"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-223"><span class="linenos">223</span></a>            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-224"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-224"><span class="linenos">224</span></a>                <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-225"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-225"><span class="linenos">225</span></a>                    <span class="sa">f</span><span class="s2">&quot;The property &#39;</span><span class="si">{</span><span class="n">attribute</span><span class="si">}</span><span class="s2">&#39; is required for STIX objects of type &#39;</span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-226"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-226"><span class="linenos">226</span></a>            <span class="n">typedb_type</span> <span class="o">=</span> <span class="n">subtypes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-227"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-227"><span class="linenos">227</span></a>            <span class="k">if</span> <span class="n">typedb_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-228"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-228"><span class="linenos">228</span></a>                <span class="n">typedb_type</span> <span class="o">=</span> <span class="n">subtypes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span> \
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-229"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-229"><span class="linenos">229</span></a>                    <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DEFAULT_KEY</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-230"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-230"><span class="linenos">230</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">typedb_type</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-231"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-231"><span class="linenos">231</span></a>                <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-232"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-232"><span class="linenos">232</span></a>                    <span class="c1"># f&quot;{stix_properties.get(&#39;id&#39;)}: subtyping for &#39;{stix_type}&#39; is not exhaustive&quot;)</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-233"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-233"><span class="linenos">233</span></a>                    <span class="sa">f</span><span class="s2">&quot;In &#39;</span><span class="si">{</span><span class="n">stix_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;: the value &#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39; &quot;</span>\
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-234"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-234"><span class="linenos">234</span></a>                    <span class="sa">f</span><span class="s2">&quot;is not defined for &#39;</span><span class="si">{</span><span class="n">attribute</span><span class="si">}</span><span class="s2">&#39; in the mapping of &#39;</span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-235"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-235"><span class="linenos">235</span></a>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-236"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-236"><span class="linenos">236</span></a>        <span class="c1"># update the type if the given object has a predefined extension</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-237"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-237"><span class="linenos">237</span></a>        <span class="k">if</span> <span class="n">stix_extensions</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-238"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-238"><span class="linenos">238</span></a>            <span class="n">obj_extensions</span> <span class="o">=</span> <span class="n">stix_extensions</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-239"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-239"><span class="linenos">239</span></a>            <span class="n">predefined_extensions</span> <span class="o">=</span> <span class="n">object_info</span> \
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-240"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-240"><span class="linenos">240</span></a>                <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_EXTENSIONS</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-241"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-241"><span class="linenos">241</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">predefined_extensions</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-242"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-242"><span class="linenos">242</span></a>                <span class="k">return</span> <span class="n">typedb_type</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-243"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-243"><span class="linenos">243</span></a>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-244"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-244"><span class="linenos">244</span></a>            <span class="n">predefined_extensions</span> <span class="o">=</span> <span class="n">predefined_extensions</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-245"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-245"><span class="linenos">245</span></a>            <span class="n">final_extension</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-246"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-246"><span class="linenos">246</span></a>            <span class="k">for</span> <span class="n">extension</span> <span class="ow">in</span> <span class="n">obj_extensions</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-247"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-247"><span class="linenos">247</span></a>                <span class="k">if</span> <span class="n">extension</span> <span class="ow">in</span> <span class="n">predefined_extensions</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-248"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-248"><span class="linenos">248</span></a>                    <span class="k">if</span> <span class="n">final_extension</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-249"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-249"><span class="linenos">249</span></a>                        <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-250"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-250"><span class="linenos">250</span></a>                            <span class="sa">f</span><span class="s2">&quot;Two predefined extensions given for &#39;</span><span class="si">{</span><span class="n">stix_properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-251"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-251"><span class="linenos">251</span></a>                            <span class="sa">f</span><span class="s2">&quot;The extensions are mutually exclusive, a &#39;</span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&#39; must have &quot;</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-252"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-252"><span class="linenos">252</span></a>                            <span class="s2">&quot;at most one extension.&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-253"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-253"><span class="linenos">253</span></a>                        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-254"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-254"><span class="linenos">254</span></a>                    <span class="n">final_extension</span> <span class="o">=</span> <span class="n">extension</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-255"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-255"><span class="linenos">255</span></a>            <span class="k">if</span> <span class="n">final_extension</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-256"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-256"><span class="linenos">256</span></a>                <span class="n">typedb_type</span> <span class="o">=</span> <span class="n">object_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_EXTENSIONS</span><span class="p">)</span> \
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-257"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-257"><span class="linenos">257</span></a>                    <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">final_extension</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_TYPEDB_TYPE</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-258"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-258"><span class="linenos">258</span></a>
</span><span id="STIXtoTypeDBMapper.get_typeql_thing_name-259"><a href="#STIXtoTypeDBMapper.get_typeql_thing_name-259"><span class="linenos">259</span></a>        <span class="k">return</span> <span class="n">typedb_type</span>
</span></pre></div>


            <div class="docstring"><p>Returns the name of the TypeQL thing for a certain 
STIX Object. E.g. "attack-pattern" -> "attack-pattern".</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>stix_type</strong>:  The type of the STIX object</li>
<li><strong>stix_properties</strong>:  The properties of the STIX Object</li>
<li><strong>stix_extensions</strong>:  The extensions of the STIX Object</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MappingException</strong>:  If the Type cannot be determined</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The name of the object in TypeDB, None if the type 
      is a custom type</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_typedb_supertype" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_typedb_supertype-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_typedb_supertype</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">stix_type</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_typedb_supertype-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_typedb_supertype"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_typedb_supertype-261"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-261"><span class="linenos">261</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-262"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-262"><span class="linenos">262</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_typedb_supertype</span><span class="p">(</span><span class="n">stix_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-263"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-263"><span class="linenos">263</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the least abstract supertype in TypeDB for a STIX </span>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-264"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-264"><span class="linenos">264</span></a><span class="sd">        object type.</span>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-265"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-265"><span class="linenos">265</span></a>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-266"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-266"><span class="linenos">266</span></a><span class="sd">        :param stix_type: The STIX Object type, e.g. attack-pattern</span>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-267"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-267"><span class="linenos">267</span></a><span class="sd">        :type stix_type: str</span>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-268"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-268"><span class="linenos">268</span></a>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-269"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-269"><span class="linenos">269</span></a><span class="sd">        :raises MappingException: If the stix type is not defined or the</span>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-270"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-270"><span class="linenos">270</span></a><span class="sd">            mapping is invalid</span>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-271"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-271"><span class="linenos">271</span></a>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-272"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-272"><span class="linenos">272</span></a><span class="sd">        :return: The least abstract supertype in TypeDB for a STIX Object </span>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-273"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-273"><span class="linenos">273</span></a><span class="sd">            type</span>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-274"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-274"><span class="linenos">274</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-275"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-275"><span class="linenos">275</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-276"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-276"><span class="linenos">276</span></a>        <span class="n">object_map</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-277"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-277"><span class="linenos">277</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">object_map</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-278"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-278"><span class="linenos">278</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;STIX type &#39;</span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&#39; not defined&quot;</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-279"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-279"><span class="linenos">279</span></a>        <span class="n">sup_type</span> <span class="o">=</span> <span class="n">object_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_TYPEDB_TYPE</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-280"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-280"><span class="linenos">280</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">sup_type</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-281"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-281"><span class="linenos">281</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-282"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-282"><span class="linenos">282</span></a>                <span class="sa">f</span><span class="s2">&quot;No TypeDB type defined for &#39;</span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_typedb_supertype-283"><a href="#STIXtoTypeDBMapper.get_typedb_supertype-283"><span class="linenos">283</span></a>        <span class="k">return</span> <span class="n">sup_type</span>
</span></pre></div>


            <div class="docstring"><p>Returns the least abstract supertype in TypeDB for a STIX 
object type.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>stix_type</strong>:  The STIX Object type, e.g. attack-pattern</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MappingException</strong>:  If the stix type is not defined or the
mapping is invalid</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The least abstract supertype in TypeDB for a STIX Object 
      type</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_default_value_implementation" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_default_value_implementation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_default_value_implementation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">value</span><span class="p">:</span> <span class="n">Any</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_default_value_implementation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_default_value_implementation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_default_value_implementation-285"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-285"><span class="linenos">285</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-286"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-286"><span class="linenos">286</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_default_value_implementation</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-287"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-287"><span class="linenos">287</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the default value type for a value of unknown type.</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-288"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-288"><span class="linenos">288</span></a>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-289"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-289"><span class="linenos">289</span></a><span class="sd">        :param value: The value whose type is unknown</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-290"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-290"><span class="linenos">290</span></a><span class="sd">        :type value: Any</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-291"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-291"><span class="linenos">291</span></a>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-292"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-292"><span class="linenos">292</span></a><span class="sd">        :return: The name of the value type, None if no value type</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-293"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-293"><span class="linenos">293</span></a><span class="sd">            is defined</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-294"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-294"><span class="linenos">294</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-295"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-295"><span class="linenos">295</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-296"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-296"><span class="linenos">296</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-297"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-297"><span class="linenos">297</span></a>        <span class="k">match</span> <span class="n">value</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-298"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-298"><span class="linenos">298</span></a>            <span class="k">case</span> <span class="nb">int</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-299"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-299"><span class="linenos">299</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">typedb_constants</span><span class="o">.</span><span class="n">LONG</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-300"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-300"><span class="linenos">300</span></a>            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-301"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-301"><span class="linenos">301</span></a>                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">satrap</span><span class="o">.</span><span class="n">etl</span><span class="o">.</span><span class="n">stix_constants</span><span class="o">.</span><span class="n">STIX_TIMESTAMP_REGEX</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-302"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-302"><span class="linenos">302</span></a>                    <span class="n">res</span> <span class="o">=</span> <span class="n">typedb_constants</span><span class="o">.</span><span class="n">DATETIME</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-303"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-303"><span class="linenos">303</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-304"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-304"><span class="linenos">304</span></a>                    <span class="n">res</span> <span class="o">=</span> <span class="n">typedb_constants</span><span class="o">.</span><span class="n">STRING</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-305"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-305"><span class="linenos">305</span></a>            <span class="k">case</span> <span class="nb">float</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-306"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-306"><span class="linenos">306</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">typedb_constants</span><span class="o">.</span><span class="n">DOUBLE</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-307"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-307"><span class="linenos">307</span></a>            <span class="k">case</span> <span class="nb">bool</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-308"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-308"><span class="linenos">308</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">typedb_constants</span><span class="o">.</span><span class="n">BOOLEAN</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-309"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-309"><span class="linenos">309</span></a>            <span class="k">case</span> <span class="nb">list</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-310"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-310"><span class="linenos">310</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-311"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-311"><span class="linenos">311</span></a>                <span class="n">list_type</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">TYPEQL_LIST_PREFIX</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-312"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-312"><span class="linenos">312</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-313"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-313"><span class="linenos">313</span></a>                    <span class="n">subtype</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span> \
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-314"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-314"><span class="linenos">314</span></a>                        <span class="o">.</span><span class="n">get_default_value_implementation</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-315"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-315"><span class="linenos">315</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-316"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-316"><span class="linenos">316</span></a>                    <span class="n">subtype</span> <span class="o">=</span> <span class="n">typedb_constants</span><span class="o">.</span><span class="n">STRING</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-317"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-317"><span class="linenos">317</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">join_type</span><span class="p">(</span><span class="n">list_type</span><span class="p">,</span> <span class="n">subtype</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-318"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-318"><span class="linenos">318</span></a>            <span class="k">case</span> <span class="nb">dict</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-319"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-319"><span class="linenos">319</span></a>                <span class="c1"># maybe check for predefined composite types</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-320"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-320"><span class="linenos">320</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">TYPEQL_DICTIONARY_KEYWORD</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-321"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-321"><span class="linenos">321</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-322"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-322"><span class="linenos">322</span></a>                <span class="kc">None</span>
</span><span id="STIXtoTypeDBMapper.get_default_value_implementation-323"><a href="#STIXtoTypeDBMapper.get_default_value_implementation-323"><span class="linenos">323</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Returns the default value type for a value of unknown type.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>value</strong>:  The value whose type is unknown</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The name of the value type, None if no value type
      is defined</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_roleplayers_for_SRO" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_roleplayers_for_SRO</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">stix_type</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_roleplayers_for_SRO-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-325"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-325"><span class="linenos">325</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-326"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-326"><span class="linenos">326</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_roleplayers_for_SRO</span><span class="p">(</span><span class="n">stix_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-327"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-327"><span class="linenos">327</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Gives the properties that are implemented as roleplayers in</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-328"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-328"><span class="linenos">328</span></a><span class="sd">        a STIX relationship object.</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-329"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-329"><span class="linenos">329</span></a>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-330"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-330"><span class="linenos">330</span></a><span class="sd">        :param stix_type: The type of the STIX object</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-331"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-331"><span class="linenos">331</span></a><span class="sd">        :type stix_type: str</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-332"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-332"><span class="linenos">332</span></a>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-333"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-333"><span class="linenos">333</span></a><span class="sd">        :raises MappingException: If the STIX type does not exist</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-334"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-334"><span class="linenos">334</span></a>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-335"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-335"><span class="linenos">335</span></a><span class="sd">        :return: The properties that specify roleplayers</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-336"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-336"><span class="linenos">336</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-337"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-337"><span class="linenos">337</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-338"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-338"><span class="linenos">338</span></a>        <span class="n">object_info</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-339"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-339"><span class="linenos">339</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">object_info</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-340"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-340"><span class="linenos">340</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-341"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-341"><span class="linenos">341</span></a>                <span class="sa">f</span><span class="s2">&quot;STIX Object </span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2"> not defined&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-342"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-342"><span class="linenos">342</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-343"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-343"><span class="linenos">343</span></a>        <span class="n">attributes</span> <span class="o">=</span> <span class="n">object_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTES</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-344"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-344"><span class="linenos">344</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attributes</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-345"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-345"><span class="linenos">345</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-346"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-346"><span class="linenos">346</span></a>                <span class="sa">f</span><span class="s2">&quot;No attributes defined for STIX Object </span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-347"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-347"><span class="linenos">347</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-348"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-348"><span class="linenos">348</span></a>        <span class="n">roleplayers</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-349"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-349"><span class="linenos">349</span></a>        <span class="k">for</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">attribute_info</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-350"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-350"><span class="linenos">350</span></a>            <span class="n">value_type</span> <span class="o">=</span> <span class="n">attribute_info</span> \
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-351"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-351"><span class="linenos">351</span></a>                <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_VALUE_TYPE</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-352"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-352"><span class="linenos">352</span></a>            <span class="k">if</span> <span class="n">value_type</span> <span class="o">==</span> <span class="n">constants</span><span class="o">.</span><span class="n">TYPEQL_ROLEPLAYER</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-353"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-353"><span class="linenos">353</span></a>                <span class="n">roleplayers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_roleplayers_for_SRO-354"><a href="#STIXtoTypeDBMapper.get_roleplayers_for_SRO-354"><span class="linenos">354</span></a>        <span class="k">return</span> <span class="n">roleplayers</span>
</span></pre></div>


            <div class="docstring"><p>Gives the properties that are implemented as roleplayers in
a STIX relationship object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>stix_type</strong>:  The type of the STIX object</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MappingException</strong>:  If the STIX type does not exist</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The properties that specify roleplayers</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_object_attribute_info" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_object_attribute_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_object_attribute_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">stix_object</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">stix_attribute</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_object_attribute_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_object_attribute_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_object_attribute_info-356"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-356"><span class="linenos">356</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-357"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-357"><span class="linenos">357</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_object_attribute_info</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-358"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-358"><span class="linenos">358</span></a>        <span class="n">stix_object</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-359"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-359"><span class="linenos">359</span></a>        <span class="n">stix_attribute</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-360"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-360"><span class="linenos">360</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-361"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-361"><span class="linenos">361</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name and value of an attribute in the </span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-362"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-362"><span class="linenos">362</span></a><span class="sd">        TypeDB Schema.</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-363"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-363"><span class="linenos">363</span></a>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-364"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-364"><span class="linenos">364</span></a><span class="sd">        :param stix_object: The type of the STIX object, </span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-365"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-365"><span class="linenos">365</span></a><span class="sd">            e.g. attack-pattern</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-366"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-366"><span class="linenos">366</span></a><span class="sd">        :type stix_object: str</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-367"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-367"><span class="linenos">367</span></a><span class="sd">        :param stix_attribute: The attribute of the STIX Object</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-368"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-368"><span class="linenos">368</span></a><span class="sd">        :type stix_attribute: str</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-369"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-369"><span class="linenos">369</span></a>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-370"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-370"><span class="linenos">370</span></a><span class="sd">        :raises MappingException: If the stix type is not defined</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-371"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-371"><span class="linenos">371</span></a><span class="sd">            or the mapping is not valid/ complete</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-372"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-372"><span class="linenos">372</span></a>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-373"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-373"><span class="linenos">373</span></a><span class="sd">        :return: The TypeDB name and value, None if the attribute</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-374"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-374"><span class="linenos">374</span></a><span class="sd">            is a custom attribute</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-375"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-375"><span class="linenos">375</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-376"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-376"><span class="linenos">376</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-377"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-377"><span class="linenos">377</span></a>        <span class="n">common_attributes</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">common_attributes</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-378"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-378"><span class="linenos">378</span></a>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-379"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-379"><span class="linenos">379</span></a>        <span class="k">if</span> <span class="n">stix_attribute</span> <span class="ow">in</span> <span class="n">common_attributes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-380"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-380"><span class="linenos">380</span></a>            <span class="n">attr_info</span> <span class="o">=</span> <span class="n">common_attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_attribute</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-381"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-381"><span class="linenos">381</span></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">attr_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_NAME</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-382"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-382"><span class="linenos">382</span></a>            <span class="n">value</span> <span class="o">=</span> <span class="n">attr_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-383"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-383"><span class="linenos">383</span></a>                <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_VALUE_TYPE</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-384"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-384"><span class="linenos">384</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-385"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-385"><span class="linenos">385</span></a>                <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-386"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-386"><span class="linenos">386</span></a>                    <span class="sa">f</span><span class="s2">&quot;No name or no value given for &#39;</span><span class="si">{</span><span class="n">stix_attribute</span><span class="si">}</span><span class="s2">&#39; in common attributes&quot;</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-387"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-387"><span class="linenos">387</span></a>            <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-388"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-388"><span class="linenos">388</span></a>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-389"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-389"><span class="linenos">389</span></a>        <span class="n">stix_obj</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_object</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-390"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-390"><span class="linenos">390</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">stix_object</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-391"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-391"><span class="linenos">391</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-392"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-392"><span class="linenos">392</span></a>                <span class="s2">&quot;The specified STIX Object does not exist&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-393"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-393"><span class="linenos">393</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-394"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-394"><span class="linenos">394</span></a>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-395"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-395"><span class="linenos">395</span></a>        <span class="n">specific_attributes</span> <span class="o">=</span> <span class="n">stix_obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTES</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-396"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-396"><span class="linenos">396</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">specific_attributes</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-397"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-397"><span class="linenos">397</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-398"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-398"><span class="linenos">398</span></a>                <span class="s2">&quot;No attributes are defined for </span><span class="si">{stix_object}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-399"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-399"><span class="linenos">399</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-400"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-400"><span class="linenos">400</span></a>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-401"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-401"><span class="linenos">401</span></a>        <span class="n">attr_info</span> <span class="o">=</span> <span class="n">specific_attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_attribute</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-402"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-402"><span class="linenos">402</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attr_info</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-403"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-403"><span class="linenos">403</span></a>            <span class="c1"># Custom property</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-404"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-404"><span class="linenos">404</span></a>            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-405"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-405"><span class="linenos">405</span></a>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-406"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-406"><span class="linenos">406</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">attr_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_NAME</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-407"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-407"><span class="linenos">407</span></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">attr_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_VALUE_TYPE</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-408"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-408"><span class="linenos">408</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-409"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-409"><span class="linenos">409</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-410"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-410"><span class="linenos">410</span></a>                <span class="sa">f</span><span class="s2">&quot;No name or no value given for attribute </span><span class="si">{</span><span class="n">stix_attribute</span><span class="si">}</span><span class="s2"> of stix type </span><span class="si">{</span><span class="n">stix_object</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-411"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-411"><span class="linenos">411</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_object_attribute_info-412"><a href="#STIXtoTypeDBMapper.get_object_attribute_info-412"><span class="linenos">412</span></a>        <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>Returns the name and value of an attribute in the 
TypeDB Schema.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>stix_object</strong>:  The type of the STIX object, 
e.g. attack-pattern</li>
<li><strong>stix_attribute</strong>:  The attribute of the STIX Object</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MappingException</strong>:  If the stix type is not defined
or the mapping is not valid/ complete</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The TypeDB name and value, None if the attribute
      is a custom attribute</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_composite_name" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_composite_name-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_composite_name</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">composite_type</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_composite_name-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_composite_name"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_composite_name-414"><a href="#STIXtoTypeDBMapper.get_composite_name-414"><span class="linenos">414</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-415"><a href="#STIXtoTypeDBMapper.get_composite_name-415"><span class="linenos">415</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_composite_name</span><span class="p">(</span><span class="n">composite_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-416"><a href="#STIXtoTypeDBMapper.get_composite_name-416"><span class="linenos">416</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the TypeDB name used for the composite type.</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-417"><a href="#STIXtoTypeDBMapper.get_composite_name-417"><span class="linenos">417</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_name-418"><a href="#STIXtoTypeDBMapper.get_composite_name-418"><span class="linenos">418</span></a><span class="sd">        :param composite_type: The STIX name of the composite type</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-419"><a href="#STIXtoTypeDBMapper.get_composite_name-419"><span class="linenos">419</span></a><span class="sd">        :type composite_type: str</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-420"><a href="#STIXtoTypeDBMapper.get_composite_name-420"><span class="linenos">420</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_name-421"><a href="#STIXtoTypeDBMapper.get_composite_name-421"><span class="linenos">421</span></a><span class="sd">        :raises MappingException: If the composite type does not exist,</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-422"><a href="#STIXtoTypeDBMapper.get_composite_name-422"><span class="linenos">422</span></a><span class="sd">            i.e. the mapping is invalid or incomplete</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-423"><a href="#STIXtoTypeDBMapper.get_composite_name-423"><span class="linenos">423</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_name-424"><a href="#STIXtoTypeDBMapper.get_composite_name-424"><span class="linenos">424</span></a><span class="sd">        :return: The TypeDB name used for the composite type</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-425"><a href="#STIXtoTypeDBMapper.get_composite_name-425"><span class="linenos">425</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-426"><a href="#STIXtoTypeDBMapper.get_composite_name-426"><span class="linenos">426</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-427"><a href="#STIXtoTypeDBMapper.get_composite_name-427"><span class="linenos">427</span></a>        <span class="n">composite</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span> \
</span><span id="STIXtoTypeDBMapper.get_composite_name-428"><a href="#STIXtoTypeDBMapper.get_composite_name-428"><span class="linenos">428</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">composite_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-429"><a href="#STIXtoTypeDBMapper.get_composite_name-429"><span class="linenos">429</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_name-430"><a href="#STIXtoTypeDBMapper.get_composite_name-430"><span class="linenos">430</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">composite</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-431"><a href="#STIXtoTypeDBMapper.get_composite_name-431"><span class="linenos">431</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-432"><a href="#STIXtoTypeDBMapper.get_composite_name-432"><span class="linenos">432</span></a>                <span class="sa">f</span><span class="s2">&quot;Composite type </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-433"><a href="#STIXtoTypeDBMapper.get_composite_name-433"><span class="linenos">433</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-434"><a href="#STIXtoTypeDBMapper.get_composite_name-434"><span class="linenos">434</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_name-435"><a href="#STIXtoTypeDBMapper.get_composite_name-435"><span class="linenos">435</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">composite</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_COMPOSITE_NAME</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-436"><a href="#STIXtoTypeDBMapper.get_composite_name-436"><span class="linenos">436</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-437"><a href="#STIXtoTypeDBMapper.get_composite_name-437"><span class="linenos">437</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-438"><a href="#STIXtoTypeDBMapper.get_composite_name-438"><span class="linenos">438</span></a>                <span class="sa">f</span><span class="s2">&quot;No TypeDB name specified for composite </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-439"><a href="#STIXtoTypeDBMapper.get_composite_name-439"><span class="linenos">439</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_name-440"><a href="#STIXtoTypeDBMapper.get_composite_name-440"><span class="linenos">440</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_name-441"><a href="#STIXtoTypeDBMapper.get_composite_name-441"><span class="linenos">441</span></a>        <span class="k">return</span> <span class="n">name</span>
</span></pre></div>


            <div class="docstring"><p>Returns the TypeDB name used for the composite type.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>composite_type</strong>:  The STIX name of the composite type</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MappingException</strong>:  If the composite type does not exist,
i.e. the mapping is invalid or incomplete</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The TypeDB name used for the composite type</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_composite_attribute_info" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_composite_attribute_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_composite_attribute_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">composite_type</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">stix_property</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_composite_attribute_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_composite_attribute_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-443"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-443"><span class="linenos">443</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-444"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-444"><span class="linenos">444</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_composite_attribute_info</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-445"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-445"><span class="linenos">445</span></a>        <span class="n">composite_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-446"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-446"><span class="linenos">446</span></a>        <span class="n">stix_property</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-447"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-447"><span class="linenos">447</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-448"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-448"><span class="linenos">448</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the TypeDB name of a specified attribute of a </span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-449"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-449"><span class="linenos">449</span></a><span class="sd">        specified composite type.</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-450"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-450"><span class="linenos">450</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-451"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-451"><span class="linenos">451</span></a><span class="sd">        :param composite_type: The name of the composite type</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-452"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-452"><span class="linenos">452</span></a><span class="sd">        :type composite_type: str</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-453"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-453"><span class="linenos">453</span></a><span class="sd">        :param stix_property: The name of the STIX attribute</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-454"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-454"><span class="linenos">454</span></a><span class="sd">        :type stix_property: str</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-455"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-455"><span class="linenos">455</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-456"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-456"><span class="linenos">456</span></a><span class="sd">        :raises MappingException: If the composite type or attribute</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-457"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-457"><span class="linenos">457</span></a><span class="sd">            is not defined in the mapping</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-458"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-458"><span class="linenos">458</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-459"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-459"><span class="linenos">459</span></a><span class="sd">        :return: The TypeDB name and value type for the attribute</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-460"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-460"><span class="linenos">460</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-461"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-461"><span class="linenos">461</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-462"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-462"><span class="linenos">462</span></a>        <span class="n">composite</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span> \
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-463"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-463"><span class="linenos">463</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">composite_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-464"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-464"><span class="linenos">464</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-465"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-465"><span class="linenos">465</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">composite</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-466"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-466"><span class="linenos">466</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-467"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-467"><span class="linenos">467</span></a>                <span class="sa">f</span><span class="s2">&quot;Composite type </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-468"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-468"><span class="linenos">468</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-469"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-469"><span class="linenos">469</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-470"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-470"><span class="linenos">470</span></a>        <span class="n">typedb_attribute</span> <span class="o">=</span> <span class="n">composite</span> \
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-471"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-471"><span class="linenos">471</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTES</span><span class="p">)</span> \
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-472"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-472"><span class="linenos">472</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_property</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-473"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-473"><span class="linenos">473</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-474"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-474"><span class="linenos">474</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">typedb_attribute</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-475"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-475"><span class="linenos">475</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-476"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-476"><span class="linenos">476</span></a>                <span class="sa">f</span><span class="s2">&quot;Attribute </span><span class="si">{</span><span class="n">stix_property</span><span class="si">}</span><span class="s2"> does not exist for composite type </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-477"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-477"><span class="linenos">477</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-478"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-478"><span class="linenos">478</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-479"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-479"><span class="linenos">479</span></a>        <span class="n">attribute_name</span> <span class="o">=</span> <span class="n">typedb_attribute</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-480"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-480"><span class="linenos">480</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_NAME</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-481"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-481"><span class="linenos">481</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-482"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-482"><span class="linenos">482</span></a>        <span class="n">attribute_type</span> <span class="o">=</span> <span class="n">typedb_attribute</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-483"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-483"><span class="linenos">483</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_VALUE_TYPE</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-484"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-484"><span class="linenos">484</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-485"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-485"><span class="linenos">485</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-486"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-486"><span class="linenos">486</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attribute_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">attribute_type</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-487"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-487"><span class="linenos">487</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-488"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-488"><span class="linenos">488</span></a>                <span class="sa">f</span><span class="s2">&quot;Attribute name or value type for attribute </span><span class="si">{</span><span class="n">stix_property</span><span class="si">}</span><span class="s2"> of composite &quot;</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-489"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-489"><span class="linenos">489</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2"> not specified&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-490"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-490"><span class="linenos">490</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_attribute_info-491"><a href="#STIXtoTypeDBMapper.get_composite_attribute_info-491"><span class="linenos">491</span></a>        <span class="k">return</span> <span class="n">attribute_name</span><span class="p">,</span> <span class="n">attribute_type</span>
</span></pre></div>


            <div class="docstring"><p>Returns the TypeDB name of a specified attribute of a 
specified composite type.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>composite_type</strong>:  The name of the composite type</li>
<li><strong>stix_property</strong>:  The name of the STIX attribute</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MappingException</strong>:  If the composite type or attribute
is not defined in the mapping</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The TypeDB name and value type for the attribute</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_composite_type_relation" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_composite_type_relation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_composite_type_relation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">composite_type</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_composite_type_relation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_composite_type_relation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_composite_type_relation-493"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-493"><span class="linenos">493</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-494"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-494"><span class="linenos">494</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_composite_type_relation</span><span class="p">(</span><span class="n">composite_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-495"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-495"><span class="linenos">495</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of the helper relation for the composite </span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-496"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-496"><span class="linenos">496</span></a><span class="sd">        type.</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-497"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-497"><span class="linenos">497</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-498"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-498"><span class="linenos">498</span></a><span class="sd">        :param composite_type: The name of the composite type</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-499"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-499"><span class="linenos">499</span></a><span class="sd">        :type composite_type: str</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-500"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-500"><span class="linenos">500</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-501"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-501"><span class="linenos">501</span></a><span class="sd">        :raises MappingException: If the composite type does not exist</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-502"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-502"><span class="linenos">502</span></a><span class="sd">            or no relation is specified</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-503"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-503"><span class="linenos">503</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-504"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-504"><span class="linenos">504</span></a><span class="sd">        :return: The name of the helper relation of the composite type</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-505"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-505"><span class="linenos">505</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-506"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-506"><span class="linenos">506</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-507"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-507"><span class="linenos">507</span></a>        <span class="n">composite</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span> \
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-508"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-508"><span class="linenos">508</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">composite_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-509"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-509"><span class="linenos">509</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">composite</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-510"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-510"><span class="linenos">510</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-511"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-511"><span class="linenos">511</span></a>                <span class="sa">f</span><span class="s2">&quot;Composite type </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-512"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-512"><span class="linenos">512</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-513"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-513"><span class="linenos">513</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-514"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-514"><span class="linenos">514</span></a>        <span class="n">relation</span> <span class="o">=</span> <span class="n">composite</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_COMPOSITE_RELATION</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-515"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-515"><span class="linenos">515</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-516"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-516"><span class="linenos">516</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-517"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-517"><span class="linenos">517</span></a>                <span class="sa">f</span><span class="s2">&quot;No relation specified for composite </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-518"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-518"><span class="linenos">518</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-519"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-519"><span class="linenos">519</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-520"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-520"><span class="linenos">520</span></a>        <span class="n">relation_name</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">RELATION_NAME</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-521"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-521"><span class="linenos">521</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation_name</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-522"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-522"><span class="linenos">522</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-523"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-523"><span class="linenos">523</span></a>                <span class="sa">f</span><span class="s2">&quot;No relation name specified for composite </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-524"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-524"><span class="linenos">524</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-525"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-525"><span class="linenos">525</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_type_relation-526"><a href="#STIXtoTypeDBMapper.get_composite_type_relation-526"><span class="linenos">526</span></a>        <span class="k">return</span> <span class="n">relation_name</span>
</span></pre></div>


            <div class="docstring"><p>Returns the name of the helper relation for the composite 
type.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>composite_type</strong>:  The name of the composite type</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MappingException</strong>:  If the composite type does not exist
or no relation is specified</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The name of the helper relation of the composite type</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_composite_relation_roles" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_composite_relation_roles-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_composite_relation_roles</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">composite_type</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_composite_relation_roles-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_composite_relation_roles"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-528"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-528"><span class="linenos">528</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-529"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-529"><span class="linenos">529</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_composite_relation_roles</span><span class="p">(</span><span class="n">composite_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-530"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-530"><span class="linenos">530</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the names of the roles of the helper relation of a </span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-531"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-531"><span class="linenos">531</span></a><span class="sd">        composite type, i.e. the name of the object&#39;s role and the name</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-532"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-532"><span class="linenos">532</span></a><span class="sd">        of the values&#39; role.</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-533"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-533"><span class="linenos">533</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-534"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-534"><span class="linenos">534</span></a><span class="sd">        :param composite_type: The name of the composite value type </span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-535"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-535"><span class="linenos">535</span></a><span class="sd">        :type composite_type: str</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-536"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-536"><span class="linenos">536</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-537"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-537"><span class="linenos">537</span></a><span class="sd">        :raises MappingException: If the composite type does not exist</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-538"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-538"><span class="linenos">538</span></a><span class="sd">            or its definition is incomplete</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-539"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-539"><span class="linenos">539</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-540"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-540"><span class="linenos">540</span></a><span class="sd">        :return: The name of the object&#39;s and values&#39; role</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-541"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-541"><span class="linenos">541</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-542"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-542"><span class="linenos">542</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-543"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-543"><span class="linenos">543</span></a>        <span class="n">composite</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">composites_mapping</span> \
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-544"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-544"><span class="linenos">544</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">composite_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-545"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-545"><span class="linenos">545</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">composite</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-546"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-546"><span class="linenos">546</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-547"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-547"><span class="linenos">547</span></a>                <span class="sa">f</span><span class="s2">&quot;Composite type </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-548"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-548"><span class="linenos">548</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-549"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-549"><span class="linenos">549</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-550"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-550"><span class="linenos">550</span></a>        <span class="n">relation</span> <span class="o">=</span> <span class="n">composite</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_COMPOSITE_RELATION</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-551"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-551"><span class="linenos">551</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-552"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-552"><span class="linenos">552</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-553"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-553"><span class="linenos">553</span></a>                <span class="sa">f</span><span class="s2">&quot;No relation specified for composite </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-554"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-554"><span class="linenos">554</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-555"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-555"><span class="linenos">555</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-556"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-556"><span class="linenos">556</span></a>        <span class="n">object_role</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-557"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-557"><span class="linenos">557</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_COMPOSITE_RELATION_OBJECT_ROLE</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-558"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-558"><span class="linenos">558</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-559"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-559"><span class="linenos">559</span></a>        <span class="n">value_role</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-560"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-560"><span class="linenos">560</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_COMPOSITE_RELATION_VALUE_ROLE</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-561"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-561"><span class="linenos">561</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-562"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-562"><span class="linenos">562</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">object_role</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">value_role</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-563"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-563"><span class="linenos">563</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-564"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-564"><span class="linenos">564</span></a>                <span class="sa">f</span><span class="s2">&quot;No object or value role defined for helper relation of &quot;</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-565"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-565"><span class="linenos">565</span></a>                <span class="sa">f</span><span class="s2">&quot;composite type </span><span class="si">{</span><span class="n">composite_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-566"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-566"><span class="linenos">566</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-567"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-567"><span class="linenos">567</span></a>
</span><span id="STIXtoTypeDBMapper.get_composite_relation_roles-568"><a href="#STIXtoTypeDBMapper.get_composite_relation_roles-568"><span class="linenos">568</span></a>        <span class="k">return</span> <span class="n">object_role</span><span class="p">,</span> <span class="n">value_role</span>
</span></pre></div>


            <div class="docstring"><p>Returns the names of the roles of the helper relation of a 
composite type, i.e. the name of the object's role and the name
of the values' role.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>composite_type</strong>:  The name of the composite value type </li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MappingException</strong>:  If the composite type does not exist
or its definition is incomplete</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The name of the object's and values' role</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_sro_role" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_sro_role-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_sro_role</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">relation_name</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">attribute</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_sro_role-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_sro_role"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_sro_role-570"><a href="#STIXtoTypeDBMapper.get_sro_role-570"><span class="linenos">570</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-571"><a href="#STIXtoTypeDBMapper.get_sro_role-571"><span class="linenos">571</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sro_role</span><span class="p">(</span><span class="n">relation_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">attribute</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-572"><a href="#STIXtoTypeDBMapper.get_sro_role-572"><span class="linenos">572</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of the role for an SRO attribute.</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-573"><a href="#STIXtoTypeDBMapper.get_sro_role-573"><span class="linenos">573</span></a>
</span><span id="STIXtoTypeDBMapper.get_sro_role-574"><a href="#STIXtoTypeDBMapper.get_sro_role-574"><span class="linenos">574</span></a><span class="sd">        :param relation_name: The name of the SRO</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-575"><a href="#STIXtoTypeDBMapper.get_sro_role-575"><span class="linenos">575</span></a><span class="sd">        :type relation_name: str</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-576"><a href="#STIXtoTypeDBMapper.get_sro_role-576"><span class="linenos">576</span></a><span class="sd">        :param role: The name of the attribute </span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-577"><a href="#STIXtoTypeDBMapper.get_sro_role-577"><span class="linenos">577</span></a><span class="sd">        :type role: str</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-578"><a href="#STIXtoTypeDBMapper.get_sro_role-578"><span class="linenos">578</span></a>
</span><span id="STIXtoTypeDBMapper.get_sro_role-579"><a href="#STIXtoTypeDBMapper.get_sro_role-579"><span class="linenos">579</span></a><span class="sd">        :raises MappingException: If the relation is not defined or the </span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-580"><a href="#STIXtoTypeDBMapper.get_sro_role-580"><span class="linenos">580</span></a><span class="sd">            attribute is not implemented as a roleplayer</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-581"><a href="#STIXtoTypeDBMapper.get_sro_role-581"><span class="linenos">581</span></a>
</span><span id="STIXtoTypeDBMapper.get_sro_role-582"><a href="#STIXtoTypeDBMapper.get_sro_role-582"><span class="linenos">582</span></a><span class="sd">        :return: The name of the role and TypeDB object type that </span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-583"><a href="#STIXtoTypeDBMapper.get_sro_role-583"><span class="linenos">583</span></a><span class="sd">            plays the role</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-584"><a href="#STIXtoTypeDBMapper.get_sro_role-584"><span class="linenos">584</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-585"><a href="#STIXtoTypeDBMapper.get_sro_role-585"><span class="linenos">585</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-586"><a href="#STIXtoTypeDBMapper.get_sro_role-586"><span class="linenos">586</span></a>        <span class="n">relation</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">sros_role_info</span> \
</span><span id="STIXtoTypeDBMapper.get_sro_role-587"><a href="#STIXtoTypeDBMapper.get_sro_role-587"><span class="linenos">587</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">relation_name</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-588"><a href="#STIXtoTypeDBMapper.get_sro_role-588"><span class="linenos">588</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-589"><a href="#STIXtoTypeDBMapper.get_sro_role-589"><span class="linenos">589</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-590"><a href="#STIXtoTypeDBMapper.get_sro_role-590"><span class="linenos">590</span></a>                <span class="sa">f</span><span class="s2">&quot;Relation </span><span class="si">{</span><span class="n">relation_name</span><span class="si">}</span><span class="s2"> is not defined&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-591"><a href="#STIXtoTypeDBMapper.get_sro_role-591"><span class="linenos">591</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-592"><a href="#STIXtoTypeDBMapper.get_sro_role-592"><span class="linenos">592</span></a>
</span><span id="STIXtoTypeDBMapper.get_sro_role-593"><a href="#STIXtoTypeDBMapper.get_sro_role-593"><span class="linenos">593</span></a>        <span class="n">role_name</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-594"><a href="#STIXtoTypeDBMapper.get_sro_role-594"><span class="linenos">594</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">role_name</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-595"><a href="#STIXtoTypeDBMapper.get_sro_role-595"><span class="linenos">595</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-596"><a href="#STIXtoTypeDBMapper.get_sro_role-596"><span class="linenos">596</span></a>                <span class="sa">f</span><span class="s2">&quot;Role information for role </span><span class="si">{</span><span class="n">attribute</span><span class="si">}</span><span class="s2"> missing for relation </span><span class="si">{</span><span class="n">relation_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-597"><a href="#STIXtoTypeDBMapper.get_sro_role-597"><span class="linenos">597</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_sro_role-598"><a href="#STIXtoTypeDBMapper.get_sro_role-598"><span class="linenos">598</span></a>
</span><span id="STIXtoTypeDBMapper.get_sro_role-599"><a href="#STIXtoTypeDBMapper.get_sro_role-599"><span class="linenos">599</span></a>        <span class="k">return</span> <span class="n">role_name</span>
</span></pre></div>


            <div class="docstring"><p>Returns the name of the role for an SRO attribute.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>relation_name</strong>:  The name of the SRO</li>
<li><strong>role</strong>:  The name of the attribute </li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MappingException</strong>:  If the relation is not defined or the 
attribute is not implemented as a roleplayer</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The name of the role and TypeDB object type that 
      plays the role</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_embedded_relation_roles" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_embedded_relation_roles-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_embedded_relation_roles</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">attribute_name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_embedded_relation_roles-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_embedded_relation_roles"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-601"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-601"><span class="linenos">601</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-602"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-602"><span class="linenos">602</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_embedded_relation_roles</span><span class="p">(</span><span class="n">attribute_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-603"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-603"><span class="linenos">603</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the object&#39;s and value&#39;s role using the name of the</span>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-604"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-604"><span class="linenos">604</span></a><span class="sd">        attribute specified for the TypeDB translation of a STIX </span>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-605"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-605"><span class="linenos">605</span></a><span class="sd">        property.</span>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-606"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-606"><span class="linenos">606</span></a>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-607"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-607"><span class="linenos">607</span></a><span class="sd">        :param attribute_name: The specified attribute name for the</span>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-608"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-608"><span class="linenos">608</span></a><span class="sd">            TypeDB translation</span>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-609"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-609"><span class="linenos">609</span></a><span class="sd">        :type attribute_name: str</span>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-610"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-610"><span class="linenos">610</span></a>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-611"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-611"><span class="linenos">611</span></a><span class="sd">        :raises MappingException: If the attribute name does not </span>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-612"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-612"><span class="linenos">612</span></a><span class="sd">            fulfill the required format</span>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-613"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-613"><span class="linenos">613</span></a>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-614"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-614"><span class="linenos">614</span></a><span class="sd">        :return: The name of the object&#39;s and value&#39;s role</span>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-615"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-615"><span class="linenos">615</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-616"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-616"><span class="linenos">616</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-617"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-617"><span class="linenos">617</span></a>        <span class="n">roles</span> <span class="o">=</span> <span class="n">attribute_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ROLE_SEPARATION</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-618"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-618"><span class="linenos">618</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">roles</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-619"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-619"><span class="linenos">619</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-620"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-620"><span class="linenos">620</span></a>                <span class="sa">f</span><span class="s2">&quot;Roles are not properly specified: </span><span class="si">{</span><span class="n">attribute_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-621"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-621"><span class="linenos">621</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-622"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-622"><span class="linenos">622</span></a>
</span><span id="STIXtoTypeDBMapper.get_embedded_relation_roles-623"><a href="#STIXtoTypeDBMapper.get_embedded_relation_roles-623"><span class="linenos">623</span></a>        <span class="k">return</span> <span class="n">roles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">roles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Returns the object's and value's role using the name of the
attribute specified for the TypeDB translation of a STIX 
property.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>attribute_name</strong>:  The specified attribute name for the
TypeDB translation</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MappingException</strong>:  If the attribute name does not 
fulfill the required format</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The name of the object's and value's role</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_key_value_pair_key_translation" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_key_value_pair_key_translation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">pair_type</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">key</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_key_value_pair_key_translation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-625"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-625"><span class="linenos">625</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-626"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-626"><span class="linenos">626</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_key_value_pair_key_translation</span><span class="p">(</span><span class="n">pair_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-627"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-627"><span class="linenos">627</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the entity type of the key. Returns None if the key</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-628"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-628"><span class="linenos">628</span></a><span class="sd">        is not defined.</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-629"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-629"><span class="linenos">629</span></a>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-630"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-630"><span class="linenos">630</span></a><span class="sd">        :param pair_type: The name of the Pair Type</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-631"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-631"><span class="linenos">631</span></a><span class="sd">        :type pair_type: str</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-632"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-632"><span class="linenos">632</span></a><span class="sd">        :param key: The name of the key</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-633"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-633"><span class="linenos">633</span></a><span class="sd">        :type key: str</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-634"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-634"><span class="linenos">634</span></a>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-635"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-635"><span class="linenos">635</span></a><span class="sd">        :raises MappingException: If the Mapping is invalid or </span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-636"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-636"><span class="linenos">636</span></a><span class="sd">            incomplete or the pair type does not exist</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-637"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-637"><span class="linenos">637</span></a>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-638"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-638"><span class="linenos">638</span></a><span class="sd">        :return: The name of the TypeDB Entity</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-639"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-639"><span class="linenos">639</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-640"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-640"><span class="linenos">640</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-641"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-641"><span class="linenos">641</span></a>        <span class="n">pair_type</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span> \
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-642"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-642"><span class="linenos">642</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pair_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-643"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-643"><span class="linenos">643</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">pair_type</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-644"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-644"><span class="linenos">644</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-645"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-645"><span class="linenos">645</span></a>                <span class="sa">f</span><span class="s2">&quot;Pair type </span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-646"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-646"><span class="linenos">646</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-647"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-647"><span class="linenos">647</span></a>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-648"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-648"><span class="linenos">648</span></a>        <span class="n">keys</span> <span class="o">=</span> <span class="n">pair_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIRS_KEYS</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-649"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-649"><span class="linenos">649</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">keys</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-650"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-650"><span class="linenos">650</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-651"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-651"><span class="linenos">651</span></a>                <span class="sa">f</span><span class="s2">&quot;No keys defined for pair type </span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-652"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-652"><span class="linenos">652</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-653"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-653"><span class="linenos">653</span></a>        <span class="n">key</span> <span class="o">=</span> <span class="n">keys</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-654"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-654"><span class="linenos">654</span></a>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_key_translation-655"><a href="#STIXtoTypeDBMapper.get_key_value_pair_key_translation-655"><span class="linenos">655</span></a>        <span class="k">return</span> <span class="n">key</span>
</span></pre></div>


            <div class="docstring"><p>Returns the entity type of the key. Returns None if the key
is not defined.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>pair_type</strong>:  The name of the Pair Type</li>
<li><strong>key</strong>:  The name of the key</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MappingException</strong>:  If the Mapping is invalid or 
incomplete or the pair type does not exist</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The name of the TypeDB Entity</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_key_value_pair_custom" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_key_value_pair_custom-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_key_value_pair_custom</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_key_value_pair_custom-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_key_value_pair_custom"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-657"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-657"><span class="linenos">657</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-658"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-658"><span class="linenos">658</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_key_value_pair_custom</span><span class="p">(</span><span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-659"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-659"><span class="linenos">659</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of the custom entity and the attribute </span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-660"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-660"><span class="linenos">660</span></a><span class="sd">        name for the key.</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-661"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-661"><span class="linenos">661</span></a>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-662"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-662"><span class="linenos">662</span></a><span class="sd">        :param pair_type: The name of the pair type</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-663"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-663"><span class="linenos">663</span></a><span class="sd">        :type pair_type: str</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-664"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-664"><span class="linenos">664</span></a>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-665"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-665"><span class="linenos">665</span></a><span class="sd">        :raises MappingException: If the Mapping is invalid or incomplete</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-666"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-666"><span class="linenos">666</span></a><span class="sd">            or the pair type does not exist</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-667"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-667"><span class="linenos">667</span></a>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-668"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-668"><span class="linenos">668</span></a><span class="sd">        :return: The name of the entity and key attribute</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-669"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-669"><span class="linenos">669</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-670"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-670"><span class="linenos">670</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-671"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-671"><span class="linenos">671</span></a>        <span class="n">pair_type</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span> \
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-672"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-672"><span class="linenos">672</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-673"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-673"><span class="linenos">673</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">pair_type</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-674"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-674"><span class="linenos">674</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-675"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-675"><span class="linenos">675</span></a>                <span class="sa">f</span><span class="s2">&quot;A mapping for the key-value type &#39;</span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2">&#39; is not defined&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-676"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-676"><span class="linenos">676</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-677"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-677"><span class="linenos">677</span></a>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-678"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-678"><span class="linenos">678</span></a>        <span class="n">mapping</span> <span class="o">=</span> <span class="n">pair_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIR_CUSTOM</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-679"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-679"><span class="linenos">679</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">mapping</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-680"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-680"><span class="linenos">680</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-681"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-681"><span class="linenos">681</span></a>                <span class="sa">f</span><span class="s2">&quot;Custom keys are not supported in the STIX key-value type &#39;</span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-682"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-682"><span class="linenos">682</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Valid keys: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">pair_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIRS_KEYS</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-683"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-683"><span class="linenos">683</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-684"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-684"><span class="linenos">684</span></a>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-685"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-685"><span class="linenos">685</span></a>        <span class="n">entity</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIR_CUSTOM_ENTITY</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-686"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-686"><span class="linenos">686</span></a>        <span class="n">attribute</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIR_CUSTOM_ATTRIBUTE</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-687"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-687"><span class="linenos">687</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">entity</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">attribute</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-688"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-688"><span class="linenos">688</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-689"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-689"><span class="linenos">689</span></a>                <span class="sa">f</span><span class="s2">&quot;No entity type or attribute name specified for custom keys &quot;</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-690"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-690"><span class="linenos">690</span></a>                <span class="sa">f</span><span class="s2">&quot;in key-value type &#39;</span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-691"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-691"><span class="linenos">691</span></a>
</span><span id="STIXtoTypeDBMapper.get_key_value_pair_custom-692"><a href="#STIXtoTypeDBMapper.get_key_value_pair_custom-692"><span class="linenos">692</span></a>        <span class="k">return</span> <span class="n">entity</span><span class="p">,</span> <span class="n">attribute</span>
</span></pre></div>


            <div class="docstring"><p>Returns the name of the custom entity and the attribute 
name for the key.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>pair_type</strong>:  The name of the pair type</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MappingException</strong>:  If the Mapping is invalid or incomplete
or the pair type does not exist</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The name of the entity and key attribute</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_pairs_value_and_type" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_pairs_value_and_type-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_pairs_value_and_type</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">pair_type</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_pairs_value_and_type-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_pairs_value_and_type"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-694"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-694"><span class="linenos">694</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-695"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-695"><span class="linenos">695</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_pairs_value_and_type</span><span class="p">(</span><span class="n">pair_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-696"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-696"><span class="linenos">696</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the attribute name and value type of the pair type.</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-697"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-697"><span class="linenos">697</span></a>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-698"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-698"><span class="linenos">698</span></a><span class="sd">        :param pair_type: The name of the pair type</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-699"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-699"><span class="linenos">699</span></a><span class="sd">        :type pair_type: str</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-700"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-700"><span class="linenos">700</span></a>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-701"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-701"><span class="linenos">701</span></a><span class="sd">        :raises MappingException: If the Mapping is invalid or incomplete</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-702"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-702"><span class="linenos">702</span></a><span class="sd">            or the pair type does not exist</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-703"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-703"><span class="linenos">703</span></a>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-704"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-704"><span class="linenos">704</span></a><span class="sd">        :return: The attribute name and value type for the values</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-705"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-705"><span class="linenos">705</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-706"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-706"><span class="linenos">706</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-707"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-707"><span class="linenos">707</span></a>        <span class="n">pair_type</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span> \
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-708"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-708"><span class="linenos">708</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pair_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-709"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-709"><span class="linenos">709</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">pair_type</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-710"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-710"><span class="linenos">710</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-711"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-711"><span class="linenos">711</span></a>                <span class="sa">f</span><span class="s2">&quot;Pair Type </span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-712"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-712"><span class="linenos">712</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-713"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-713"><span class="linenos">713</span></a>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-714"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-714"><span class="linenos">714</span></a>        <span class="n">attribute_name</span> <span class="o">=</span> <span class="n">pair_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIRS_ATTRIBUTE_NAME</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-715"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-715"><span class="linenos">715</span></a>        <span class="n">value_type</span> <span class="o">=</span> <span class="n">pair_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIRS_VALUE_TYPE</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-716"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-716"><span class="linenos">716</span></a>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-717"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-717"><span class="linenos">717</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attribute_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">value_type</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-718"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-718"><span class="linenos">718</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-719"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-719"><span class="linenos">719</span></a>                <span class="sa">f</span><span class="s2">&quot;Attribute name or value type not specified for pair type </span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-720"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-720"><span class="linenos">720</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-721"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-721"><span class="linenos">721</span></a>
</span><span id="STIXtoTypeDBMapper.get_pairs_value_and_type-722"><a href="#STIXtoTypeDBMapper.get_pairs_value_and_type-722"><span class="linenos">722</span></a>        <span class="k">return</span> <span class="n">attribute_name</span><span class="p">,</span> <span class="n">value_type</span>
</span></pre></div>


            <div class="docstring"><p>Returns the attribute name and value type of the pair type.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>pair_type</strong>:  The name of the pair type</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MappingException</strong>:  If the Mapping is invalid or incomplete
or the pair type does not exist</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The attribute name and value type for the values</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_pair_relation" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_pair_relation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_pair_relation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">pair_type</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_pair_relation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_pair_relation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_pair_relation-724"><a href="#STIXtoTypeDBMapper.get_pair_relation-724"><span class="linenos">724</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-725"><a href="#STIXtoTypeDBMapper.get_pair_relation-725"><span class="linenos">725</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_pair_relation</span><span class="p">(</span><span class="n">pair_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-726"><a href="#STIXtoTypeDBMapper.get_pair_relation-726"><span class="linenos">726</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the relation name of the helper relation for the </span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-727"><a href="#STIXtoTypeDBMapper.get_pair_relation-727"><span class="linenos">727</span></a><span class="sd">        pair type and the roles for the object and pair item.</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-728"><a href="#STIXtoTypeDBMapper.get_pair_relation-728"><span class="linenos">728</span></a>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-729"><a href="#STIXtoTypeDBMapper.get_pair_relation-729"><span class="linenos">729</span></a><span class="sd">        :param pair_type: The name of the pair type</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-730"><a href="#STIXtoTypeDBMapper.get_pair_relation-730"><span class="linenos">730</span></a><span class="sd">        :type pair_type: str</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-731"><a href="#STIXtoTypeDBMapper.get_pair_relation-731"><span class="linenos">731</span></a>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-732"><a href="#STIXtoTypeDBMapper.get_pair_relation-732"><span class="linenos">732</span></a><span class="sd">        :raises MappingException: If the pair type does not exist or </span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-733"><a href="#STIXtoTypeDBMapper.get_pair_relation-733"><span class="linenos">733</span></a><span class="sd">            the mapping is invalid/ incomplete</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-734"><a href="#STIXtoTypeDBMapper.get_pair_relation-734"><span class="linenos">734</span></a>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-735"><a href="#STIXtoTypeDBMapper.get_pair_relation-735"><span class="linenos">735</span></a><span class="sd">        :return: The name of the relation, object role and item role</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-736"><a href="#STIXtoTypeDBMapper.get_pair_relation-736"><span class="linenos">736</span></a><span class="sd">        :rtype: tuple[str, str, str]</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-737"><a href="#STIXtoTypeDBMapper.get_pair_relation-737"><span class="linenos">737</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-738"><a href="#STIXtoTypeDBMapper.get_pair_relation-738"><span class="linenos">738</span></a>        <span class="n">pair_type</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">key_value_pairs</span> \
</span><span id="STIXtoTypeDBMapper.get_pair_relation-739"><a href="#STIXtoTypeDBMapper.get_pair_relation-739"><span class="linenos">739</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pair_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-740"><a href="#STIXtoTypeDBMapper.get_pair_relation-740"><span class="linenos">740</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">pair_type</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-741"><a href="#STIXtoTypeDBMapper.get_pair_relation-741"><span class="linenos">741</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-742"><a href="#STIXtoTypeDBMapper.get_pair_relation-742"><span class="linenos">742</span></a>                <span class="sa">f</span><span class="s2">&quot;Pair Type </span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-743"><a href="#STIXtoTypeDBMapper.get_pair_relation-743"><span class="linenos">743</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-744"><a href="#STIXtoTypeDBMapper.get_pair_relation-744"><span class="linenos">744</span></a>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-745"><a href="#STIXtoTypeDBMapper.get_pair_relation-745"><span class="linenos">745</span></a>        <span class="n">relation</span> <span class="o">=</span> <span class="n">pair_type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_PAIRS_RELATION</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-746"><a href="#STIXtoTypeDBMapper.get_pair_relation-746"><span class="linenos">746</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-747"><a href="#STIXtoTypeDBMapper.get_pair_relation-747"><span class="linenos">747</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-748"><a href="#STIXtoTypeDBMapper.get_pair_relation-748"><span class="linenos">748</span></a>                <span class="sa">f</span><span class="s2">&quot;Relation is not specified for pair type </span><span class="si">{</span><span class="n">pair_type</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-749"><a href="#STIXtoTypeDBMapper.get_pair_relation-749"><span class="linenos">749</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-750"><a href="#STIXtoTypeDBMapper.get_pair_relation-750"><span class="linenos">750</span></a>        <span class="n">relation_name</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">RELATION_NAME</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-751"><a href="#STIXtoTypeDBMapper.get_pair_relation-751"><span class="linenos">751</span></a>        <span class="n">item_role</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ROLE_ITEM</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-752"><a href="#STIXtoTypeDBMapper.get_pair_relation-752"><span class="linenos">752</span></a>        <span class="n">object_role</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ROLE_OBJECT</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-753"><a href="#STIXtoTypeDBMapper.get_pair_relation-753"><span class="linenos">753</span></a>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-754"><a href="#STIXtoTypeDBMapper.get_pair_relation-754"><span class="linenos">754</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">item_role</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">object_role</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-755"><a href="#STIXtoTypeDBMapper.get_pair_relation-755"><span class="linenos">755</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span><span class="s2">&quot;Relation info is not fully specified&quot;</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-756"><a href="#STIXtoTypeDBMapper.get_pair_relation-756"><span class="linenos">756</span></a>
</span><span id="STIXtoTypeDBMapper.get_pair_relation-757"><a href="#STIXtoTypeDBMapper.get_pair_relation-757"><span class="linenos">757</span></a>        <span class="k">return</span> <span class="n">relation_name</span><span class="p">,</span> <span class="n">object_role</span><span class="p">,</span> <span class="n">item_role</span>
</span></pre></div>


            <div class="docstring"><p>Returns the relation name of the helper relation for the 
pair type and the roles for the object and pair item.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>pair_type</strong>:  The name of the pair type</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MappingException</strong>:  If the pair type does not exist or 
the mapping is invalid/ incomplete</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The name of the relation, object role and item role</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_dictionary_item_data" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_dictionary_item_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_dictionary_item_data</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">value_type</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_dictionary_item_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_dictionary_item_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-759"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-759"><span class="linenos">759</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-760"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-760"><span class="linenos">760</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_dictionary_item_data</span><span class="p">(</span><span class="n">value_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-761"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-761"><span class="linenos">761</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of the item entity, the name of the key </span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-762"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-762"><span class="linenos">762</span></a><span class="sd">        attribute name of the value attribute.</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-763"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-763"><span class="linenos">763</span></a>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-764"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-764"><span class="linenos">764</span></a><span class="sd">        :param value_type: The type of the value of the item</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-765"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-765"><span class="linenos">765</span></a><span class="sd">        :type value_type: str</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-766"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-766"><span class="linenos">766</span></a>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-767"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-767"><span class="linenos">767</span></a><span class="sd">        :raises MappingException: If the mapping is invalid/incomplete</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-768"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-768"><span class="linenos">768</span></a>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-769"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-769"><span class="linenos">769</span></a><span class="sd">        :return: The name of the item entity, key attribute and value </span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-770"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-770"><span class="linenos">770</span></a><span class="sd">            attribute</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-771"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-771"><span class="linenos">771</span></a><span class="sd">        :rtype: tuple[str, str, str]</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-772"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-772"><span class="linenos">772</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-773"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-773"><span class="linenos">773</span></a>        <span class="n">abstract</span><span class="p">,</span> <span class="n">specific</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">split_type</span><span class="p">(</span><span class="n">value_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-774"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-774"><span class="linenos">774</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">specific</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-775"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-775"><span class="linenos">775</span></a>            <span class="n">value_type</span> <span class="o">=</span> <span class="n">abstract</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-776"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-776"><span class="linenos">776</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-777"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-777"><span class="linenos">777</span></a>            <span class="n">value_type</span> <span class="o">=</span> <span class="n">specific</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-778"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-778"><span class="linenos">778</span></a>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-779"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-779"><span class="linenos">779</span></a>        <span class="n">dict_data</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">dictionary_data</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-780"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-780"><span class="linenos">780</span></a>        <span class="n">key_name</span> <span class="o">=</span> <span class="n">dict_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DICTIONARY_KEY</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-781"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-781"><span class="linenos">781</span></a>        <span class="n">items_data</span> <span class="o">=</span> <span class="n">dict_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DICTIONARY_SUBITEMS</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-782"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-782"><span class="linenos">782</span></a>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-783"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-783"><span class="linenos">783</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">key_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">items_data</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-784"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-784"><span class="linenos">784</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-785"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-785"><span class="linenos">785</span></a>                <span class="s2">&quot;Dictionary data incomplete&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-786"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-786"><span class="linenos">786</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-787"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-787"><span class="linenos">787</span></a>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-788"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-788"><span class="linenos">788</span></a>        <span class="n">item_data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">items_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">value_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-789"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-789"><span class="linenos">789</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">item_data</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-790"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-790"><span class="linenos">790</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-791"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-791"><span class="linenos">791</span></a>                <span class="sa">f</span><span class="s2">&quot;Value type &#39;</span><span class="si">{</span><span class="n">value_type</span><span class="si">}</span><span class="s2">&#39; not supported in items of STIX properties &quot;</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-792"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-792"><span class="linenos">792</span></a>                <span class="s2">&quot;of type &#39;dictionary&#39; (e.g. exif_tags, additional_header_fields). &quot;</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-793"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-793"><span class="linenos">793</span></a>                <span class="sa">f</span><span class="s2">&quot;Valid types: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">items_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-794"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-794"><span class="linenos">794</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-795"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-795"><span class="linenos">795</span></a>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-796"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-796"><span class="linenos">796</span></a>        <span class="n">item_name</span> <span class="o">=</span> <span class="n">item_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-797"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-797"><span class="linenos">797</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DICTIONARY_ITEM_ENTITY</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-798"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-798"><span class="linenos">798</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-799"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-799"><span class="linenos">799</span></a>        <span class="n">attr_name</span> <span class="o">=</span> <span class="n">item_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-800"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-800"><span class="linenos">800</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DICTIONARY_VALUE_ATTRIBUTE</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-801"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-801"><span class="linenos">801</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-802"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-802"><span class="linenos">802</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">item_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">attr_name</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-803"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-803"><span class="linenos">803</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-804"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-804"><span class="linenos">804</span></a>                <span class="s2">&quot;No item entity name of value attribute given for dictionary&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-805"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-805"><span class="linenos">805</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_item_data-806"><a href="#STIXtoTypeDBMapper.get_dictionary_item_data-806"><span class="linenos">806</span></a>        <span class="k">return</span> <span class="n">item_name</span><span class="p">,</span> <span class="n">key_name</span><span class="p">,</span> <span class="n">attr_name</span>
</span></pre></div>


            <div class="docstring"><p>Returns the name of the item entity, the name of the key 
attribute name of the value attribute.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>value_type</strong>:  The type of the value of the item</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MappingException</strong>:  If the mapping is invalid/incomplete</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The name of the item entity, key attribute and value 
      attribute</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_dictionary_relation_data" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_dictionary_relation_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_dictionary_relation_data</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_dictionary_relation_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_dictionary_relation_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-808"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-808"><span class="linenos">808</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-809"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-809"><span class="linenos">809</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_dictionary_relation_data</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-810"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-810"><span class="linenos">810</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of the relation and roles used for building </span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-811"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-811"><span class="linenos">811</span></a><span class="sd">        the dictionary, i.e. connecting the object to the items.</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-812"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-812"><span class="linenos">812</span></a>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-813"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-813"><span class="linenos">813</span></a><span class="sd">        :raises MappingException: If there is no relation specified</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-814"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-814"><span class="linenos">814</span></a>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-815"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-815"><span class="linenos">815</span></a><span class="sd">        :return: The name of the relation, role of the item and role</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-816"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-816"><span class="linenos">816</span></a><span class="sd">            of the object</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-817"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-817"><span class="linenos">817</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-818"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-818"><span class="linenos">818</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-819"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-819"><span class="linenos">819</span></a>        <span class="n">dict_data</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">dictionary_data</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-820"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-820"><span class="linenos">820</span></a>        <span class="n">relation</span> <span class="o">=</span> <span class="n">dict_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DICTIONARY_RELATION</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-821"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-821"><span class="linenos">821</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">relation</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-822"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-822"><span class="linenos">822</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-823"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-823"><span class="linenos">823</span></a>                <span class="s2">&quot;No relation specified for dictionaries&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-824"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-824"><span class="linenos">824</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-825"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-825"><span class="linenos">825</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">RELATION_NAME</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-826"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-826"><span class="linenos">826</span></a>        <span class="n">item_role</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ROLE_ITEM</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-827"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-827"><span class="linenos">827</span></a>        <span class="n">object_role</span> <span class="o">=</span> <span class="n">relation</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ROLE_OBJECT</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-828"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-828"><span class="linenos">828</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">item_role</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">object_role</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-829"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-829"><span class="linenos">829</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-830"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-830"><span class="linenos">830</span></a>                <span class="s2">&quot;Dictionary Data incomplete, relation name or roles missing&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-831"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-831"><span class="linenos">831</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_relation_data-832"><a href="#STIXtoTypeDBMapper.get_dictionary_relation_data-832"><span class="linenos">832</span></a>        <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">item_role</span><span class="p">,</span> <span class="n">object_role</span>
</span></pre></div>


            <div class="docstring"><p>Returns the name of the relation and roles used for building 
the dictionary, i.e. connecting the object to the items.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MappingException</strong>:  If there is no relation specified</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The name of the relation, role of the item and role
      of the object</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_dictionary_property_attribute" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_dictionary_property_attribute-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_dictionary_property_attribute</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_dictionary_property_attribute-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_dictionary_property_attribute"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-834"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-834"><span class="linenos">834</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-835"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-835"><span class="linenos">835</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_dictionary_property_attribute</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-836"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-836"><span class="linenos">836</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Gives the name of the attribute used for the name of the </span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-837"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-837"><span class="linenos">837</span></a><span class="sd">        STIX property that is implemented as a dictionary.</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-838"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-838"><span class="linenos">838</span></a>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-839"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-839"><span class="linenos">839</span></a><span class="sd">        :raises MappingException: If the mapping is invalid or </span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-840"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-840"><span class="linenos">840</span></a><span class="sd">            incomplete</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-841"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-841"><span class="linenos">841</span></a>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-842"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-842"><span class="linenos">842</span></a><span class="sd">        :return: The name of the attribute for the name of the STIX </span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-843"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-843"><span class="linenos">843</span></a><span class="sd">            property</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-844"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-844"><span class="linenos">844</span></a><span class="sd">        :rtype: str</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-845"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-845"><span class="linenos">845</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-846"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-846"><span class="linenos">846</span></a>        <span class="n">dict_data</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">dictionary_data</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-847"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-847"><span class="linenos">847</span></a>        <span class="n">attribute_name</span> <span class="o">=</span> <span class="n">dict_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-848"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-848"><span class="linenos">848</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_DICTIONARY_ATTRIBUTE_NAME</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-849"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-849"><span class="linenos">849</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-850"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-850"><span class="linenos">850</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attribute_name</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-851"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-851"><span class="linenos">851</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-852"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-852"><span class="linenos">852</span></a>                <span class="s2">&quot;No attribute specified for name of the property&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-853"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-853"><span class="linenos">853</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_dictionary_property_attribute-854"><a href="#STIXtoTypeDBMapper.get_dictionary_property_attribute-854"><span class="linenos">854</span></a>        <span class="k">return</span> <span class="n">attribute_name</span>
</span></pre></div>


            <div class="docstring"><p>Gives the name of the attribute used for the name of the 
STIX property that is implemented as a dictionary.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MappingException</strong>:  If the mapping is invalid or 
incomplete</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The name of the attribute for the name of the STIX 
      property</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.get_extension_attribute_info" class="classattr">
                                        <input id="STIXtoTypeDBMapper.get_extension_attribute_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_extension_attribute_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">stix_object</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">stix_extension</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">stix_name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.get_extension_attribute_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.get_extension_attribute_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-856"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-856"><span class="linenos">856</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-857"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-857"><span class="linenos">857</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_extension_attribute_info</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-858"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-858"><span class="linenos">858</span></a>        <span class="n">stix_object</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-859"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-859"><span class="linenos">859</span></a>        <span class="n">stix_extension</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-860"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-860"><span class="linenos">860</span></a>        <span class="n">stix_name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-861"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-861"><span class="linenos">861</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-862"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-862"><span class="linenos">862</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the attribute info of an extension.</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-863"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-863"><span class="linenos">863</span></a>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-864"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-864"><span class="linenos">864</span></a><span class="sd">        :param stix_object: The name of the STIX type, e.g. malware</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-865"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-865"><span class="linenos">865</span></a><span class="sd">        :type stix_object: str</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-866"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-866"><span class="linenos">866</span></a><span class="sd">        :param stix_extension: The name of the extension</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-867"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-867"><span class="linenos">867</span></a><span class="sd">        :type stix_extension: str</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-868"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-868"><span class="linenos">868</span></a><span class="sd">        :param stix_name: The name of the attribute</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-869"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-869"><span class="linenos">869</span></a><span class="sd">        :type stix_name: str</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-870"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-870"><span class="linenos">870</span></a>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-871"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-871"><span class="linenos">871</span></a><span class="sd">        :raises MappingException: If the stix type or extension is not </span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-872"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-872"><span class="linenos">872</span></a><span class="sd">            defined in the mapping</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-873"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-873"><span class="linenos">873</span></a>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-874"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-874"><span class="linenos">874</span></a><span class="sd">        :return: The name and type of the attribute in TypeDB,</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-875"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-875"><span class="linenos">875</span></a><span class="sd">            (None, None) if it a custom attribute</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-876"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-876"><span class="linenos">876</span></a><span class="sd">        :rtype: tuple[str, str]</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-877"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-877"><span class="linenos">877</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-878"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-878"><span class="linenos">878</span></a>        <span class="n">object_extensions</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span> \
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-879"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-879"><span class="linenos">879</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_object</span><span class="p">)</span> \
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-880"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-880"><span class="linenos">880</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_EXTENSIONS</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-881"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-881"><span class="linenos">881</span></a>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-882"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-882"><span class="linenos">882</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">object_extensions</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-883"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-883"><span class="linenos">883</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-884"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-884"><span class="linenos">884</span></a>                <span class="sa">f</span><span class="s2">&quot;No extension specified for type </span><span class="si">{</span><span class="n">stix_object</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-885"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-885"><span class="linenos">885</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-886"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-886"><span class="linenos">886</span></a>        <span class="n">extension</span> <span class="o">=</span> <span class="n">object_extensions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_extension</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-887"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-887"><span class="linenos">887</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">extension</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-888"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-888"><span class="linenos">888</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-889"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-889"><span class="linenos">889</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stix_extension</span><span class="si">}</span><span class="s2"> is not a predefined extension for type </span><span class="si">{</span><span class="n">stix_object</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-890"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-890"><span class="linenos">890</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-891"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-891"><span class="linenos">891</span></a>        <span class="n">attributes</span> <span class="o">=</span> <span class="n">extension</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTES</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-892"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-892"><span class="linenos">892</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attributes</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-893"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-893"><span class="linenos">893</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-894"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-894"><span class="linenos">894</span></a>                <span class="sa">f</span><span class="s2">&quot;No attributes defined for extension </span><span class="si">{</span><span class="n">stix_extension</span><span class="si">}</span><span class="s2"> of stix type </span><span class="si">{</span><span class="n">stix_object</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-895"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-895"><span class="linenos">895</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-896"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-896"><span class="linenos">896</span></a>        <span class="n">attribute_data</span> <span class="o">=</span> <span class="n">attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_name</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-897"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-897"><span class="linenos">897</span></a>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-898"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-898"><span class="linenos">898</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">attribute_data</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-899"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-899"><span class="linenos">899</span></a>            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-900"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-900"><span class="linenos">900</span></a>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-901"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-901"><span class="linenos">901</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">attribute_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_NAME</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-902"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-902"><span class="linenos">902</span></a>        <span class="n">value_type</span> <span class="o">=</span> <span class="n">attribute_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-903"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-903"><span class="linenos">903</span></a>            <span class="n">constants</span><span class="o">.</span><span class="n">MAPPING_ATTRIBUTE_TYPEDB_VALUE_TYPE</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-904"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-904"><span class="linenos">904</span></a>        <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-905"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-905"><span class="linenos">905</span></a>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-906"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-906"><span class="linenos">906</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">value_type</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-907"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-907"><span class="linenos">907</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-908"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-908"><span class="linenos">908</span></a>                <span class="sa">f</span><span class="s2">&quot;No name or no value type specified for attribute </span><span class="si">{</span><span class="n">stix_name</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-909"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-909"><span class="linenos">909</span></a>                <span class="sa">f</span><span class="s2">&quot;of extension </span><span class="si">{</span><span class="n">stix_extension</span><span class="si">}</span><span class="s2"> of stix type </span><span class="si">{</span><span class="n">stix_object</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-910"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-910"><span class="linenos">910</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-911"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-911"><span class="linenos">911</span></a>
</span><span id="STIXtoTypeDBMapper.get_extension_attribute_info-912"><a href="#STIXtoTypeDBMapper.get_extension_attribute_info-912"><span class="linenos">912</span></a>        <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">value_type</span>
</span></pre></div>


            <div class="docstring"><p>Returns the attribute info of an extension.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>stix_object</strong>:  The name of the STIX type, e.g. malware</li>
<li><strong>stix_extension</strong>:  The name of the extension</li>
<li><strong>stix_name</strong>:  The name of the attribute</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MappingException</strong>:  If the stix type or extension is not 
defined in the mapping</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The name and type of the attribute in TypeDB,
      (None, None) if it a custom attribute</p>
</blockquote>
</div>


                            </div>
                            <div id="STIXtoTypeDBMapper.is_defined_extension" class="classattr">
                                        <input id="STIXtoTypeDBMapper.is_defined_extension-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">is_defined_extension</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">stix_type</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">extension_name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="STIXtoTypeDBMapper.is_defined_extension-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#STIXtoTypeDBMapper.is_defined_extension"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="STIXtoTypeDBMapper.is_defined_extension-914"><a href="#STIXtoTypeDBMapper.is_defined_extension-914"><span class="linenos">914</span></a>    <span class="nd">@staticmethod</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-915"><a href="#STIXtoTypeDBMapper.is_defined_extension-915"><span class="linenos">915</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_defined_extension</span><span class="p">(</span><span class="n">stix_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">extension_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-916"><a href="#STIXtoTypeDBMapper.is_defined_extension-916"><span class="linenos">916</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;States whether an extension name is defined according to</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-917"><a href="#STIXtoTypeDBMapper.is_defined_extension-917"><span class="linenos">917</span></a><span class="sd">        STIX 2.1 or not, that means it is a custom extension.</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-918"><a href="#STIXtoTypeDBMapper.is_defined_extension-918"><span class="linenos">918</span></a>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-919"><a href="#STIXtoTypeDBMapper.is_defined_extension-919"><span class="linenos">919</span></a><span class="sd">        :param stix_type: The type of the STIX object</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-920"><a href="#STIXtoTypeDBMapper.is_defined_extension-920"><span class="linenos">920</span></a><span class="sd">        :type stix_type: str</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-921"><a href="#STIXtoTypeDBMapper.is_defined_extension-921"><span class="linenos">921</span></a><span class="sd">        :param extension_name: The name of the extension</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-922"><a href="#STIXtoTypeDBMapper.is_defined_extension-922"><span class="linenos">922</span></a><span class="sd">        :type extension_name: str</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-923"><a href="#STIXtoTypeDBMapper.is_defined_extension-923"><span class="linenos">923</span></a>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-924"><a href="#STIXtoTypeDBMapper.is_defined_extension-924"><span class="linenos">924</span></a><span class="sd">        :raises MappingException: If the stix type is not defined</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-925"><a href="#STIXtoTypeDBMapper.is_defined_extension-925"><span class="linenos">925</span></a>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-926"><a href="#STIXtoTypeDBMapper.is_defined_extension-926"><span class="linenos">926</span></a><span class="sd">        :return: Whether the extension is a predefined extension</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-927"><a href="#STIXtoTypeDBMapper.is_defined_extension-927"><span class="linenos">927</span></a><span class="sd">        :rtype: bool</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-928"><a href="#STIXtoTypeDBMapper.is_defined_extension-928"><span class="linenos">928</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-929"><a href="#STIXtoTypeDBMapper.is_defined_extension-929"><span class="linenos">929</span></a>        <span class="n">stix_object_data</span> <span class="o">=</span> <span class="n">STIXtoTypeDBMapper</span><span class="o">.</span><span class="n">stix_objects</span> \
</span><span id="STIXtoTypeDBMapper.is_defined_extension-930"><a href="#STIXtoTypeDBMapper.is_defined_extension-930"><span class="linenos">930</span></a>            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stix_type</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-931"><a href="#STIXtoTypeDBMapper.is_defined_extension-931"><span class="linenos">931</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">stix_object_data</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-932"><a href="#STIXtoTypeDBMapper.is_defined_extension-932"><span class="linenos">932</span></a>            <span class="k">raise</span> <span class="n">MappingException</span><span class="p">(</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-933"><a href="#STIXtoTypeDBMapper.is_defined_extension-933"><span class="linenos">933</span></a>                <span class="sa">f</span><span class="s2">&quot;Stix type </span><span class="si">{</span><span class="n">stix_type</span><span class="si">}</span><span class="s2"> is not defined&quot;</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-934"><a href="#STIXtoTypeDBMapper.is_defined_extension-934"><span class="linenos">934</span></a>            <span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-935"><a href="#STIXtoTypeDBMapper.is_defined_extension-935"><span class="linenos">935</span></a>        <span class="n">extensions</span> <span class="o">=</span> <span class="n">stix_object_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">OBJECTS_EXTENSIONS</span><span class="p">)</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-936"><a href="#STIXtoTypeDBMapper.is_defined_extension-936"><span class="linenos">936</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">extensions</span><span class="p">:</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-937"><a href="#STIXtoTypeDBMapper.is_defined_extension-937"><span class="linenos">937</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-938"><a href="#STIXtoTypeDBMapper.is_defined_extension-938"><span class="linenos">938</span></a>
</span><span id="STIXtoTypeDBMapper.is_defined_extension-939"><a href="#STIXtoTypeDBMapper.is_defined_extension-939"><span class="linenos">939</span></a>        <span class="k">return</span> <span class="n">extension_name</span> <span class="ow">in</span> <span class="n">extensions</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>States whether an extension name is defined according to
STIX 2.1 or not, that means it is a custom extension.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>stix_type</strong>:  The type of the STIX object</li>
<li><strong>extension_name</strong>:  The name of the extension</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>MappingException</strong>:  If the stix type is not defined</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Whether the extension is a predefined extension</p>
</blockquote>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>